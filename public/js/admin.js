/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
/******/ (() => { // webpackBootstrap
/******/ 	var __webpack_modules__ = ({

/***/ "./resources/js/admin.js":
/*!*******************************!*\
  !*** ./resources/js/admin.js ***!
  \*******************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var trumbowyg__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! trumbowyg */ \"./node_modules/trumbowyg/dist/trumbowyg.js\");\n/* harmony import */ var trumbowyg__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(trumbowyg__WEBPACK_IMPORTED_MODULE_0__);\n\n$('.trumbowyg-form').trumbowyg({\n  svgPath: '/js/ui/icons.svg'\n}); // Toggle the side navigation\n\n$('#sidenavToggler').click(function (e) {\n  e.preventDefault();\n  $('body').toggleClass('sidenav-toggled');\n}); // Configure tooltips for collapsed side navigation\n\n$('.navbar-sidenav [data-toggle=\"tooltip\"]').tooltip({\n  template: '<div class=\"tooltip navbar-sidenav-tooltip\" role=\"tooltip\"><div class=\"arrow\"></div><div class=\"tooltip-inner\"></div></div>'\n});//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9yZXNvdXJjZXMvanMvYWRtaW4uanM/MDcyMiJdLCJuYW1lcyI6WyIkIiwidHJ1bWJvd3lnIiwic3ZnUGF0aCIsImNsaWNrIiwiZSIsInByZXZlbnREZWZhdWx0IiwidG9nZ2xlQ2xhc3MiLCJ0b29sdGlwIiwidGVtcGxhdGUiXSwibWFwcGluZ3MiOiI7OztBQUFBO0FBRUFBLENBQUMsQ0FBQyxpQkFBRCxDQUFELENBQXFCQyxTQUFyQixDQUErQjtBQUM3QkMsU0FBTyxFQUFFO0FBRG9CLENBQS9CLEUsQ0FJQTs7QUFDQUYsQ0FBQyxDQUFDLGlCQUFELENBQUQsQ0FBcUJHLEtBQXJCLENBQTJCLFVBQVVDLENBQVYsRUFBYTtBQUN0Q0EsR0FBQyxDQUFDQyxjQUFGO0FBQ0FMLEdBQUMsQ0FBQyxNQUFELENBQUQsQ0FBVU0sV0FBVixDQUFzQixpQkFBdEI7QUFDRCxDQUhELEUsQ0FLQTs7QUFDQU4sQ0FBQyxDQUFDLHlDQUFELENBQUQsQ0FBNkNPLE9BQTdDLENBQXFEO0FBQ25EQyxVQUFRLEVBQUU7QUFEeUMsQ0FBckQiLCJmaWxlIjoiLi9yZXNvdXJjZXMvanMvYWRtaW4uanMuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgJ3RydW1ib3d5ZydcblxuJCgnLnRydW1ib3d5Zy1mb3JtJykudHJ1bWJvd3lnKHtcbiAgc3ZnUGF0aDogJy9qcy91aS9pY29ucy5zdmcnXG59KVxuXG4vLyBUb2dnbGUgdGhlIHNpZGUgbmF2aWdhdGlvblxuJCgnI3NpZGVuYXZUb2dnbGVyJykuY2xpY2soZnVuY3Rpb24gKGUpIHtcbiAgZS5wcmV2ZW50RGVmYXVsdCgpXG4gICQoJ2JvZHknKS50b2dnbGVDbGFzcygnc2lkZW5hdi10b2dnbGVkJylcbn0pXG5cbi8vIENvbmZpZ3VyZSB0b29sdGlwcyBmb3IgY29sbGFwc2VkIHNpZGUgbmF2aWdhdGlvblxuJCgnLm5hdmJhci1zaWRlbmF2IFtkYXRhLXRvZ2dsZT1cInRvb2x0aXBcIl0nKS50b29sdGlwKHtcbiAgdGVtcGxhdGU6ICc8ZGl2IGNsYXNzPVwidG9vbHRpcCBuYXZiYXItc2lkZW5hdi10b29sdGlwXCIgcm9sZT1cInRvb2x0aXBcIj48ZGl2IGNsYXNzPVwiYXJyb3dcIj48L2Rpdj48ZGl2IGNsYXNzPVwidG9vbHRpcC1pbm5lclwiPjwvZGl2PjwvZGl2Pidcbn0pXG4iXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./resources/js/admin.js\n");

/***/ }),

/***/ "./node_modules/trumbowyg/dist/trumbowyg.js":
/*!**************************************************!*\
  !*** ./node_modules/trumbowyg/dist/trumbowyg.js ***!
  \**************************************************/
/***/ (() => {

eval("/**\n * Trumbowyg v2.23.0 - A lightweight WYSIWYG editor\n * Trumbowyg core file\n * ------------------------\n * @link http://alex-d.github.io/Trumbowyg\n * @license MIT\n * @author Alexandre Demode (Alex-D)\n *         Twitter : @AlexandreDemode\n *         Website : alex-d.fr\n */\n\njQuery.trumbowyg = {\n    langs: {\n        en: {\n            viewHTML: 'View HTML',\n\n            undo: 'Undo',\n            redo: 'Redo',\n\n            formatting: 'Formatting',\n            p: 'Paragraph',\n            blockquote: 'Quote',\n            code: 'Code',\n            header: 'Header',\n\n            bold: 'Bold',\n            italic: 'Italic',\n            strikethrough: 'Strikethrough',\n            underline: 'Underline',\n\n            strong: 'Strong',\n            em: 'Emphasis',\n            del: 'Deleted',\n\n            superscript: 'Superscript',\n            subscript: 'Subscript',\n\n            unorderedList: 'Unordered list',\n            orderedList: 'Ordered list',\n\n            insertImage: 'Insert Image',\n            link: 'Link',\n            createLink: 'Insert link',\n            unlink: 'Remove link',\n\n            justifyLeft: 'Align Left',\n            justifyCenter: 'Align Center',\n            justifyRight: 'Align Right',\n            justifyFull: 'Align Justify',\n\n            horizontalRule: 'Insert horizontal rule',\n            removeformat: 'Remove format',\n\n            fullscreen: 'Fullscreen',\n\n            close: 'Close',\n\n            submit: 'Confirm',\n            reset: 'Cancel',\n\n            required: 'Required',\n            description: 'Description',\n            title: 'Title',\n            text: 'Text',\n            target: 'Target',\n            width: 'Width'\n        }\n    },\n\n    // Plugins\n    plugins: {},\n\n    // SVG Path globally\n    svgPath: null,\n    svgAbsoluteUseHref: false,\n\n    hideButtonTexts: null\n};\n\n// Makes default options read-only\nObject.defineProperty(jQuery.trumbowyg, 'defaultOptions', {\n    value: {\n        lang: 'en',\n\n        fixedBtnPane: false,\n        fixedFullWidth: false,\n        autogrow: false,\n        autogrowOnEnter: false,\n        imageWidthModalEdit: false,\n        hideButtonTexts: null,\n\n        prefix: 'trumbowyg-',\n        tagClasses: {},\n        semantic: true,\n        semanticKeepAttributes: false,\n        resetCss: false,\n        removeformatPasted: false,\n        tabToIndent: false,\n        tagsToRemove: [],\n        tagsToKeep: ['hr', 'img', 'embed', 'iframe', 'input'],\n        btns: [\n            ['viewHTML'],\n            ['undo', 'redo'], // Only supported in Blink browsers\n            ['formatting'],\n            ['strong', 'em', 'del'],\n            ['superscript', 'subscript'],\n            ['link'],\n            ['insertImage'],\n            ['justifyLeft', 'justifyCenter', 'justifyRight', 'justifyFull'],\n            ['unorderedList', 'orderedList'],\n            ['horizontalRule'],\n            ['removeformat'],\n            ['fullscreen']\n        ],\n        // For custom button definitions\n        btnsDef: {},\n        changeActiveDropdownIcon: false,\n\n        inlineElementsSelector: 'a,abbr,acronym,b,caption,cite,code,col,dfn,dir,dt,dd,em,font,hr,i,kbd,li,q,span,strikeout,strong,sub,sup,u',\n\n        pasteHandlers: [],\n\n        // imgDblClickHandler: default is defined in constructor\n\n        plugins: {},\n\n        urlProtocol: false,\n        minimalLinks: false,\n        defaultLinkTarget: undefined,\n\n        svgPath: null\n    },\n    writable: false,\n    enumerable: true,\n    configurable: false\n});\n\n(function (navigator, window, document, $) {\n    'use strict';\n\n    var CONFIRM_EVENT = 'tbwconfirm',\n        CANCEL_EVENT = 'tbwcancel';\n\n    $.fn.trumbowyg = function (options, params) {\n        var trumbowygDataName = 'trumbowyg';\n        if (options === Object(options) || !options) {\n            return this.each(function () {\n                if (!$(this).data(trumbowygDataName)) {\n                    $(this).data(trumbowygDataName, new Trumbowyg(this, options));\n                }\n            });\n        }\n        if (this.length === 1) {\n            try {\n                var t = $(this).data(trumbowygDataName);\n                switch (options) {\n                    // Exec command\n                    case 'execCmd':\n                        return t.execCmd(params.cmd, params.param, params.forceCss, params.skipTrumbowyg);\n\n                    // Modal box\n                    case 'openModal':\n                        return t.openModal(params.title, params.content);\n                    case 'closeModal':\n                        return t.closeModal();\n                    case 'openModalInsert':\n                        return t.openModalInsert(params.title, params.fields, params.callback);\n\n                    // Range\n                    case 'saveRange':\n                        return t.saveRange();\n                    case 'getRange':\n                        return t.range;\n                    case 'getRangeText':\n                        return t.getRangeText();\n                    case 'restoreRange':\n                        return t.restoreRange();\n\n                    // Enable/disable\n                    case 'enable':\n                        return t.setDisabled(false);\n                    case 'disable':\n                        return t.setDisabled(true);\n\n                    // Toggle\n                    case 'toggle':\n                        return t.toggle();\n\n                    // Destroy\n                    case 'destroy':\n                        return t.destroy();\n\n                    // Empty\n                    case 'empty':\n                        return t.empty();\n\n                    // HTML\n                    case 'html':\n                        return t.html(params);\n                }\n            } catch (c) {\n            }\n        }\n\n        return false;\n    };\n\n    // @param: editorElem is the DOM element\n    var Trumbowyg = function (editorElem, options) {\n        var t = this,\n            trumbowygIconsId = 'trumbowyg-icons',\n            $trumbowyg = $.trumbowyg;\n\n        // Get the document of the element. It use to makes the plugin\n        // compatible on iframes.\n        t.doc = editorElem.ownerDocument || document;\n\n        // jQuery object of the editor\n        t.$ta = $(editorElem); // $ta : Textarea\n        t.$c = $(editorElem); // $c : creator\n\n        options = options || {};\n\n        // Localization management\n        if (options.lang != null || $trumbowyg.langs[options.lang] != null) {\n            t.lang = $.extend(true, {}, $trumbowyg.langs.en, $trumbowyg.langs[options.lang]);\n        } else {\n            t.lang = $trumbowyg.langs.en;\n        }\n\n        t.hideButtonTexts = $trumbowyg.hideButtonTexts != null ? $trumbowyg.hideButtonTexts : options.hideButtonTexts;\n\n        // SVG path\n        var svgPathOption = $trumbowyg.svgPath != null ? $trumbowyg.svgPath : options.svgPath;\n        t.hasSvg = svgPathOption !== false;\n\n        if (svgPathOption !== false && ($trumbowyg.svgAbsoluteUseHref || $('#' + trumbowygIconsId, t.doc).length === 0)) {\n            if (svgPathOption == null) {\n                // Hack to get svgPathOption based on trumbowyg.js path\n                var $scriptElements = $('script[src]');\n                $scriptElements.each(function (i, scriptElement) {\n                    var source = scriptElement.src;\n                    var matches = source.match('trumbowyg(\\.min)?\\.js');\n                    if (matches != null) {\n                        svgPathOption = source.substring(0, source.indexOf(matches[0])) + 'ui/icons.svg';\n                    }\n                });\n            }\n\n            // Do not merge with previous if block: svgPathOption can be redefined in it.\n            // Here we are checking that we find a match\n            if (svgPathOption == null) {\n                console.warn('You must define svgPath: https://goo.gl/CfTY9U'); // jshint ignore:line\n            } else if (!$trumbowyg.svgAbsoluteUseHref) {\n                var div = t.doc.createElement('div');\n                div.id = trumbowygIconsId;\n                t.doc.body.insertBefore(div, t.doc.body.childNodes[0]);\n                $.ajax({\n                    async: true,\n                    type: 'GET',\n                    contentType: 'application/x-www-form-urlencoded; charset=UTF-8',\n                    dataType: 'xml',\n                    crossDomain: true,\n                    url: svgPathOption,\n                    data: null,\n                    beforeSend: null,\n                    complete: null,\n                    success: function (data) {\n                        div.innerHTML = new XMLSerializer().serializeToString(data.documentElement);\n                    }\n                });\n            }\n        }\n\n        var baseHref = !!t.doc.querySelector('base') ? window.location.href.split(/[?#]/)[0] : '';\n        t.svgPath = $trumbowyg.svgAbsoluteUseHref ? svgPathOption : baseHref;\n\n\n        /**\n         * When the button is associated to a empty object\n         * fn and title attributes are defined from the button key value\n         *\n         * For example\n         *      foo: {}\n         * is equivalent to :\n         *      foo: {\n         *          fn: 'foo',\n         *          title: this.lang.foo\n         *      }\n         */\n        var h = t.lang.header, // Header translation\n            isBlinkFunction = function () {\n                return (window.chrome || (window.Intl && Intl.v8BreakIterator)) && 'CSS' in window;\n            };\n        t.btnsDef = {\n            viewHTML: {\n                fn: 'toggle',\n                class: 'trumbowyg-not-disable',\n            },\n\n            undo: {\n                isSupported: isBlinkFunction,\n                key: 'Z'\n            },\n            redo: {\n                isSupported: isBlinkFunction,\n                key: 'Y'\n            },\n\n            p: {\n                fn: 'formatBlock'\n            },\n            blockquote: {\n                fn: 'formatBlock'\n            },\n            h1: {\n                fn: 'formatBlock',\n                title: h + ' 1'\n            },\n            h2: {\n                fn: 'formatBlock',\n                title: h + ' 2'\n            },\n            h3: {\n                fn: 'formatBlock',\n                title: h + ' 3'\n            },\n            h4: {\n                fn: 'formatBlock',\n                title: h + ' 4'\n            },\n            h5: {\n                fn: 'formatBlock',\n                title: h + ' 5'\n            },\n            h6: {\n                fn: 'formatBlock',\n                title: h + ' 6'\n            },\n            subscript: {\n                tag: 'sub'\n            },\n            superscript: {\n                tag: 'sup'\n            },\n\n            bold: {\n                key: 'B',\n                tag: 'b'\n            },\n            italic: {\n                key: 'I',\n                tag: 'i'\n            },\n            underline: {\n                tag: 'u'\n            },\n            strikethrough: {\n                tag: 'strike'\n            },\n\n            strong: {\n                fn: 'bold',\n                key: 'B'\n            },\n            em: {\n                fn: 'italic',\n                key: 'I'\n            },\n            del: {\n                fn: 'strikethrough'\n            },\n\n            createLink: {\n                key: 'K',\n                tag: 'a'\n            },\n            unlink: {},\n\n            insertImage: {},\n\n            justifyLeft: {\n                tag: 'left',\n                forceCss: true\n            },\n            justifyCenter: {\n                tag: 'center',\n                forceCss: true\n            },\n            justifyRight: {\n                tag: 'right',\n                forceCss: true\n            },\n            justifyFull: {\n                tag: 'justify',\n                forceCss: true\n            },\n\n            unorderedList: {\n                fn: 'insertUnorderedList',\n                tag: 'ul'\n            },\n            orderedList: {\n                fn: 'insertOrderedList',\n                tag: 'ol'\n            },\n\n            horizontalRule: {\n                fn: 'insertHorizontalRule'\n            },\n\n            removeformat: {},\n\n            fullscreen: {\n                class: 'trumbowyg-not-disable'\n            },\n            close: {\n                fn: 'destroy',\n                class: 'trumbowyg-not-disable'\n            },\n\n            // Dropdowns\n            formatting: {\n                dropdown: ['p', 'blockquote', 'h1', 'h2', 'h3', 'h4'],\n                ico: 'p'\n            },\n            link: {\n                dropdown: ['createLink', 'unlink']\n            }\n        };\n\n        // Default Options\n        t.o = $.extend(true, {}, $trumbowyg.defaultOptions, options);\n        if (!t.o.hasOwnProperty('imgDblClickHandler')) {\n            t.o.imgDblClickHandler = t.getDefaultImgDblClickHandler();\n        }\n\n        t.urlPrefix = t.setupUrlPrefix();\n\n        t.disabled = t.o.disabled || (editorElem.nodeName === 'TEXTAREA' && editorElem.disabled);\n\n        if (options.btns) {\n            t.o.btns = options.btns;\n        } else if (!t.o.semantic) {\n            t.o.btns[3] = ['bold', 'italic', 'underline', 'strikethrough'];\n        }\n\n        $.each(t.o.btnsDef, function (btnName, btnDef) {\n            t.addBtnDef(btnName, btnDef);\n        });\n\n        // put this here in the event it would be merged in with options\n        t.eventNamespace = 'trumbowyg-event';\n\n        // Keyboard shortcuts are load in this array\n        t.keys = [];\n\n        // Tag to button dynamically hydrated\n        t.tagToButton = {};\n        t.tagHandlers = [];\n\n        // Admit multiple paste handlers\n        t.pasteHandlers = [].concat(t.o.pasteHandlers);\n\n        // Check if browser is IE\n        t.isIE = navigator.userAgent.indexOf('MSIE') !== -1 || navigator.appVersion.indexOf('Trident/') !== -1;\n\n        // Check if we are on macOs\n        t.isMac = navigator.platform.toUpperCase().indexOf('MAC') !== -1;\n\n        t.init();\n    };\n\n    Trumbowyg.prototype = {\n        DEFAULT_SEMANTIC_MAP: {\n            'b': 'strong',\n            'i': 'em',\n            's': 'del',\n            'strike': 'del',\n            'div': 'p'\n        },\n\n        init: function () {\n            var t = this;\n            t.height = t.$ta.height();\n\n            t.initPlugins();\n\n            try {\n                // Disable image resize, try-catch for old IE\n                t.doc.execCommand('enableObjectResizing', false, false);\n                t.doc.execCommand('defaultParagraphSeparator', false, 'p');\n            } catch (e) {\n            }\n\n            t.buildEditor();\n            t.buildBtnPane();\n\n            t.fixedBtnPaneEvents();\n\n            t.buildOverlay();\n\n            setTimeout(function () {\n                if (t.disabled) {\n                    t.setDisabled(true);\n                }\n                t.$c.trigger('tbwinit');\n            });\n        },\n\n        addBtnDef: function (btnName, btnDef) {\n            this.btnsDef[btnName] = $.extend(btnDef, this.btnsDef[btnName] || {});\n        },\n\n        setupUrlPrefix: function () {\n            var protocol = this.o.urlProtocol;\n            if (!protocol) {\n                return;\n            }\n\n            if (typeof (protocol) !== 'string') {\n                return 'https://';\n            }\n            return protocol.replace('://', '') + '://';\n        },\n\n        buildEditor: function () {\n            var t = this,\n                prefix = t.o.prefix,\n                html = '';\n\n            t.$box = $('<div/>', {\n                class: prefix + 'box ' + prefix + 'editor-visible ' + prefix + t.o.lang + ' trumbowyg'\n            });\n\n            // $ta = Textarea\n            // $ed = Editor\n            t.isTextarea = t.$ta.is('textarea');\n            if (t.isTextarea) {\n                html = t.$ta.val();\n                t.$ed = $('<div/>');\n                t.$box\n                    .insertAfter(t.$ta)\n                    .append(t.$ed, t.$ta);\n            } else {\n                t.$ed = t.$ta;\n                html = t.$ed.html();\n\n                t.$ta = $('<textarea/>', {\n                    name: t.$ta.attr('id'),\n                    height: t.height\n                }).val(html);\n\n                t.$box\n                    .insertAfter(t.$ed)\n                    .append(t.$ta, t.$ed);\n                t.syncCode();\n            }\n\n            t.$ta\n                .addClass(prefix + 'textarea')\n                .attr('tabindex', -1)\n            ;\n\n            t.$ed\n                .addClass(prefix + 'editor')\n                .attr({\n                    contenteditable: true,\n                    dir: t.lang._dir || 'ltr'\n                })\n                .html(html)\n            ;\n\n            if (t.o.tabindex) {\n                t.$ed.attr('tabindex', t.o.tabindex);\n            }\n\n            if (t.$c.is('[placeholder]')) {\n                t.$ed.attr('placeholder', t.$c.attr('placeholder'));\n            }\n\n            if (t.$c.is('[spellcheck]')) {\n                t.$ed.attr('spellcheck', t.$c.attr('spellcheck'));\n            }\n\n            if (t.o.resetCss) {\n                t.$ed.addClass(prefix + 'reset-css');\n            }\n\n            if (!t.o.autogrow) {\n                t.$ta.add(t.$ed).css({\n                    height: t.height\n                });\n            }\n\n            t.semanticCode();\n\n            if (t.o.autogrowOnEnter) {\n                t.$ed.addClass(prefix + 'autogrow-on-enter');\n            }\n\n            var ctrl = false,\n                composition = false,\n                debounceButtonPaneStatus;\n\n            t.$ed\n                .on('dblclick', 'img', t.o.imgDblClickHandler)\n                .on('keydown', function (e) {\n                    // append flags to differentiate Chrome spans\n                    var keyCode = e.which;\n                    if (keyCode === 8 || keyCode === 13 || keyCode === 46) {\n                        t.toggleSpan(true);\n                    }\n                    if ((e.ctrlKey || e.metaKey) && !e.altKey) {\n                        ctrl = true;\n                        var key = t.keys[String.fromCharCode(e.which).toUpperCase()];\n\n                        try {\n                            t.execCmd(key.fn, key.param);\n                            return false;\n                        } catch (c) {\n                        }\n                    } else {\n                        if (t.o.tabToIndent && e.key === 'Tab') {\n                            try {\n                                if (e.shiftKey) {\n                                    t.execCmd('outdent', true, null);\n                                } else {\n                                    t.execCmd('indent', true, null);\n                                }\n                                return false;\n                            } catch (c) {\n                            }\n                        }\n                    }\n                })\n                .on('compositionstart compositionupdate', function () {\n                    composition = true;\n                })\n                .on('keyup compositionend', function (e) {\n                    if (e.type === 'compositionend') {\n                        composition = false;\n                    } else if (composition) {\n                        return;\n                    }\n\n                    var keyCode = e.which;\n\n                    if (keyCode >= 37 && keyCode <= 40) {\n                        return;\n                    }\n\n                    // remove Chrome generated span tags\n                    if (keyCode === 8 || keyCode === 13 || keyCode === 46) {\n                        t.toggleSpan();\n                    }\n\n                    if ((e.ctrlKey || e.metaKey) && (keyCode === 89 || keyCode === 90)) {\n                        t.semanticCode(false, true);\n                        t.$c.trigger('tbwchange');\n                    } else if (!ctrl && keyCode !== 17) {\n                        var compositionEndIE = t.isIE ? e.type === 'compositionend' : true;\n                        t.semanticCode(false, compositionEndIE && keyCode === 13);\n                        t.$c.trigger('tbwchange');\n                    } else if (typeof e.which === 'undefined') {\n                        t.semanticCode(false, false, true);\n                    }\n\n                    setTimeout(function () {\n                        ctrl = false;\n                    }, 50);\n                })\n                .on('mouseup keydown keyup', function (e) {\n                    if ((!e.ctrlKey && !e.metaKey) || e.altKey) {\n                        setTimeout(function () { // \"hold on\" to the ctrl key for 50ms\n                            ctrl = false;\n                        }, 50);\n                    }\n                    clearTimeout(debounceButtonPaneStatus);\n                    debounceButtonPaneStatus = setTimeout(function () {\n                        t.updateButtonPaneStatus();\n                    }, 50);\n                })\n                .on('focus blur', function (e) {\n                    if (e.type === 'blur') {\n                        t.clearButtonPaneStatus();\n                    }\n                    t.$c.trigger('tbw' + e.type);\n                    if (t.o.autogrowOnEnter) {\n                        if (t.autogrowOnEnterDontClose) {\n                            return;\n                        }\n                        if (e.type === 'focus') {\n                            t.autogrowOnEnterWasFocused = true;\n                            t.autogrowEditorOnEnter();\n                        } else if (!t.o.autogrow) {\n                            t.$ed.css({height: t.$ed.css('min-height')});\n                            t.$c.trigger('tbwresize');\n                        }\n                    }\n                })\n                .on('keyup focus', function () {\n                  if (!t.$ta.val().match(/<.*>/) && !t.$ed.html().match(/<.*>/)) {\n                        setTimeout(function () {\n                            var block = t.isIE ? '<p>' : 'p';\n                            t.doc.execCommand('formatBlock', false, block);\n                            t.syncCode();\n                        }, 0);\n                    }\n                })\n                .on('cut drop', function () {\n                    setTimeout(function () {\n                        t.semanticCode(false, true);\n                        t.$c.trigger('tbwchange');\n                    }, 0);\n                })\n                .on('paste', function (e) {\n                    if (t.o.removeformatPasted) {\n                        e.preventDefault();\n\n                        if (window.getSelection && window.getSelection().deleteFromDocument) {\n                            window.getSelection().deleteFromDocument();\n                        }\n\n                        try {\n                            // IE\n                            var text = window.clipboardData.getData('Text');\n\n                            try {\n                                // <= IE10\n                                t.doc.selection.createRange().pasteHTML(text);\n                            } catch (c) {\n                                // IE 11\n                                t.doc.getSelection().getRangeAt(0).insertNode(t.doc.createTextNode(text));\n                            }\n                            t.$c.trigger('tbwchange', e);\n                        } catch (d) {\n                            // Not IE\n                            t.execCmd('insertText', (e.originalEvent || e).clipboardData.getData('text/plain'));\n                        }\n                    }\n\n                    // Call pasteHandlers\n                    $.each(t.pasteHandlers, function (i, pasteHandler) {\n                        pasteHandler(e);\n                    });\n\n                    setTimeout(function () {\n                        t.semanticCode(false, true);\n                        t.$c.trigger('tbwpaste', e);\n                        t.$c.trigger('tbwchange');\n                    }, 0);\n                });\n\n            t.$ta\n                .on('keyup', function () {\n                    t.$c.trigger('tbwchange');\n                })\n                .on('paste', function () {\n                    setTimeout(function () {\n                        t.$c.trigger('tbwchange');\n                    }, 0);\n                });\n\n            $(t.doc.body).on('keydown.' + t.eventNamespace, function (e) {\n                if (e.which === 27 && $('.' + prefix + 'modal-box').length >= 1) {\n                    t.closeModal();\n                    return false;\n                }\n            });\n        },\n\n        //autogrow when entering logic\n        autogrowEditorOnEnter: function () {\n            var t = this;\n            t.$ed.removeClass('autogrow-on-enter');\n            var oldHeight = t.$ed[0].clientHeight;\n            t.$ed.height('auto');\n            var totalHeight = t.$ed[0].scrollHeight;\n            t.$ed.addClass('autogrow-on-enter');\n            if (oldHeight !== totalHeight) {\n                t.$ed.height(oldHeight);\n                setTimeout(function () {\n                    t.$ed.css({height: totalHeight});\n                    t.$c.trigger('tbwresize');\n                }, 0);\n            }\n        },\n\n\n        // Build button pane, use o.btns option\n        buildBtnPane: function () {\n            var t = this,\n                prefix = t.o.prefix;\n\n            var $btnPane = t.$btnPane = $('<div/>', {\n                class: prefix + 'button-pane'\n            });\n\n            $.each(t.o.btns, function (i, btnGrp) {\n                if (!$.isArray(btnGrp)) {\n                    btnGrp = [btnGrp];\n                }\n\n                var $btnGroup = $('<div/>', {\n                    class: prefix + 'button-group ' + ((btnGrp.indexOf('fullscreen') >= 0) ? prefix + 'right' : '')\n                });\n                $.each(btnGrp, function (i, btn) {\n                    try { // Prevent buildBtn error\n                        if (t.isSupportedBtn(btn)) { // It's a supported button\n                            $btnGroup.append(t.buildBtn(btn));\n                        }\n                    } catch (c) {\n                    }\n                });\n\n                if ($btnGroup.html().trim().length > 0) {\n                    $btnPane.append($btnGroup);\n                }\n            });\n\n            t.$box.prepend($btnPane);\n        },\n\n\n        // Build a button and his action\n        buildBtn: function (btnName) { // btnName is name of the button\n            var t = this,\n                prefix = t.o.prefix,\n                btn = t.btnsDef[btnName],\n                isDropdown = btn.dropdown,\n                hasIcon = btn.hasIcon != null ? btn.hasIcon : true,\n                textDef = t.lang[btnName] || btnName,\n\n                $btn = $('<button/>', {\n                    type: 'button',\n                    class: prefix + btnName + '-button ' + (btn.class || '') + (!hasIcon ? ' ' + prefix + 'textual-button' : ''),\n                    html: t.hasSvg && hasIcon ?\n                        '<svg><use xlink:href=\"' + t.svgPath + '#' + prefix + (btn.ico || btnName).replace(/([A-Z]+)/g, '-$1').toLowerCase() + '\"/></svg>' :\n                        t.hideButtonTexts ? '' : (btn.text || btn.title || t.lang[btnName] || btnName),\n                    title: (btn.title || btn.text || textDef) + (btn.key ? ' (' + (t.isMac ? 'Cmd' : 'Ctrl') + ' + ' + btn.key + ')' : ''),\n                    tabindex: -1,\n                    mousedown: function () {\n                        if (!isDropdown || $('.' + btnName + '-' + prefix + 'dropdown', t.$box).is(':hidden')) {\n                            $('body', t.doc).trigger('mousedown');\n                        }\n\n                        if ((t.$btnPane.hasClass(prefix + 'disable') || t.$box.hasClass(prefix + 'disabled')) &&\n                            !$(this).hasClass(prefix + 'active') &&\n                            !$(this).hasClass(prefix + 'not-disable')) {\n                            return false;\n                        }\n\n                        t.execCmd((isDropdown ? 'dropdown' : false) || btn.fn || btnName, btn.param || btnName, btn.forceCss);\n\n                        return false;\n                    }\n                });\n\n            if (isDropdown) {\n                $btn.addClass(prefix + 'open-dropdown');\n                var dropdownPrefix = prefix + 'dropdown',\n                    dropdownOptions = { // the dropdown\n                        class: dropdownPrefix + '-' + btnName + ' ' + dropdownPrefix + ' ' + prefix + 'fixed-top ' + (btn.dropdownClass || '')\n                    };\n                dropdownOptions['data-' + dropdownPrefix] = btnName;\n                var $dropdown = $('<div/>', dropdownOptions);\n                $.each(isDropdown, function (i, def) {\n                    if (t.btnsDef[def] && t.isSupportedBtn(def)) {\n                        $dropdown.append(t.buildSubBtn(def));\n                    }\n                });\n                t.$box.append($dropdown.hide());\n            } else if (btn.key) {\n                t.keys[btn.key] = {\n                    fn: btn.fn || btnName,\n                    param: btn.param || btnName\n                };\n            }\n\n            if (!isDropdown) {\n                t.tagToButton[(btn.tag || btnName).toLowerCase()] = btnName;\n            }\n\n            return $btn;\n        },\n        // Build a button for dropdown menu\n        // @param n : name of the subbutton\n        buildSubBtn: function (btnName) {\n            var t = this,\n                prefix = t.o.prefix,\n                btn = t.btnsDef[btnName],\n                hasIcon = btn.hasIcon != null ? btn.hasIcon : true;\n\n            if (btn.key) {\n                t.keys[btn.key] = {\n                    fn: btn.fn || btnName,\n                    param: btn.param || btnName\n                };\n            }\n\n            t.tagToButton[(btn.tag || btnName).toLowerCase()] = btnName;\n\n            return $('<button/>', {\n                type: 'button',\n                class: prefix + btnName + '-dropdown-button ' + (btn.class || '') + (btn.ico ? ' ' + prefix + btn.ico + '-button' : ''),\n                html: t.hasSvg && hasIcon ?\n                    '<svg><use xlink:href=\"' + t.svgPath + '#' + prefix + (btn.ico || btnName).replace(/([A-Z]+)/g, '-$1').toLowerCase() + '\"/></svg>' + (btn.text || btn.title || t.lang[btnName] || btnName) :\n                    (btn.text || btn.title || t.lang[btnName] || btnName),\n                title: (btn.key ? '(' + (t.isMac ? 'Cmd' : 'Ctrl') + ' + ' + btn.key + ')' : null),\n                style: btn.style || null,\n                mousedown: function () {\n                    $('body', t.doc).trigger('mousedown');\n\n                    t.execCmd(btn.fn || btnName, btn.param || btnName, btn.forceCss);\n\n                    return false;\n                }\n            });\n        },\n        // Check if button is supported\n        isSupportedBtn: function (btnName) {\n            try {\n                return this.btnsDef[btnName].isSupported();\n            } catch (e) {\n            }\n            return true;\n        },\n\n        // Build overlay for modal box\n        buildOverlay: function () {\n            var t = this;\n            t.$overlay = $('<div/>', {\n                class: t.o.prefix + 'overlay'\n            }).appendTo(t.$box);\n            return t.$overlay;\n        },\n        showOverlay: function () {\n            var t = this;\n            $(window).trigger('scroll');\n            t.$overlay.fadeIn(200);\n            t.$box.addClass(t.o.prefix + 'box-blur');\n        },\n        hideOverlay: function () {\n            var t = this;\n            t.$overlay.fadeOut(50);\n            t.$box.removeClass(t.o.prefix + 'box-blur');\n        },\n\n        // Management of fixed button pane\n        fixedBtnPaneEvents: function () {\n            var t = this,\n                fixedFullWidth = t.o.fixedFullWidth,\n                $box = t.$box;\n\n            if (!t.o.fixedBtnPane) {\n                return;\n            }\n\n            t.isFixed = false;\n\n            $(window)\n                .on('scroll.' + t.eventNamespace + ' resize.' + t.eventNamespace, function () {\n                    if (!$box) {\n                        return;\n                    }\n\n                    t.syncCode();\n\n                    var scrollTop = $(window).scrollTop(),\n                        offset = $box.offset().top + 1,\n                        $buttonPane = t.$btnPane,\n                        buttonPaneOuterHeight = $buttonPane.outerHeight() - 2;\n\n                    if ((scrollTop - offset > 0) && ((scrollTop - offset - t.height) < 0)) {\n                        if (!t.isFixed) {\n                            t.isFixed = true;\n                            $buttonPane.css({\n                                position: 'fixed',\n                                top: 0,\n                                left: fixedFullWidth ? 0 : 'auto',\n                                zIndex: 7\n                            });\n                            t.$box.css({paddingTop: $buttonPane.height()});\n                        }\n                        $buttonPane.css({\n                            width: fixedFullWidth ? '100%' : (($box.width() - 1))\n                        });\n\n                        $('.' + t.o.prefix + 'fixed-top', $box).css({\n                            position: fixedFullWidth ? 'fixed' : 'absolute',\n                            top: fixedFullWidth ? buttonPaneOuterHeight : buttonPaneOuterHeight + (scrollTop - offset),\n                            zIndex: 15\n                        });\n                    } else if (t.isFixed) {\n                        t.isFixed = false;\n                        $buttonPane.removeAttr('style');\n                        t.$box.css({paddingTop: 0});\n                        $('.' + t.o.prefix + 'fixed-top', $box).css({\n                            position: 'absolute',\n                            top: buttonPaneOuterHeight\n                        });\n                    }\n                });\n        },\n\n        // Disable editor\n        setDisabled: function (disable) {\n            var t = this,\n                prefix = t.o.prefix;\n\n            t.disabled = disable;\n\n            if (disable) {\n                t.$ta.attr('disabled', true);\n            } else {\n                t.$ta.removeAttr('disabled');\n            }\n            t.$box.toggleClass(prefix + 'disabled', disable);\n            t.$ed.attr('contenteditable', !disable);\n        },\n\n        // Destroy the editor\n        destroy: function () {\n            var t = this,\n                prefix = t.o.prefix;\n\n            if (t.isTextarea) {\n                t.$box.after(\n                    t.$ta\n                        .css({height: ''})\n                        .val(t.html())\n                        .removeClass(prefix + 'textarea')\n                        .show()\n                );\n            } else {\n                t.$box.after(\n                    t.$ed\n                        .css({height: ''})\n                        .removeClass(prefix + 'editor')\n                        .removeAttr('contenteditable')\n                        .removeAttr('dir')\n                        .html(t.html())\n                        .show()\n                );\n            }\n\n            t.$ed.off('dblclick', 'img');\n\n            t.destroyPlugins();\n\n            t.$box.remove();\n            t.$c.removeData('trumbowyg');\n            $('body').removeClass(prefix + 'body-fullscreen');\n            t.$c.trigger('tbwclose');\n            $(window).off('scroll.' + t.eventNamespace + ' resize.' + t.eventNamespace);\n            $(t.doc.body).off('keydown.' + t.eventNamespace);\n        },\n\n\n        // Empty the editor\n        empty: function () {\n            this.$ta.val('');\n            this.syncCode(true);\n        },\n\n\n        // Function call when click on viewHTML button\n        toggle: function () {\n            var t = this,\n                prefix = t.o.prefix;\n\n            if (t.o.autogrowOnEnter) {\n                t.autogrowOnEnterDontClose = !t.$box.hasClass(prefix + 'editor-hidden');\n            }\n\n            t.semanticCode(false, true);\n            t.$c.trigger('tbwchange');\n\n            setTimeout(function () {\n                t.doc.activeElement.blur();\n                t.$box.toggleClass(prefix + 'editor-hidden ' + prefix + 'editor-visible');\n                t.$btnPane.toggleClass(prefix + 'disable');\n                $('.' + prefix + 'viewHTML-button', t.$btnPane).toggleClass(prefix + 'active');\n                if (t.$box.hasClass(prefix + 'editor-visible')) {\n                    t.$ta.attr('tabindex', -1);\n                } else {\n                    t.$ta.removeAttr('tabindex');\n                }\n\n                if (t.o.autogrowOnEnter && !t.autogrowOnEnterDontClose) {\n                    t.autogrowEditorOnEnter();\n                }\n            }, 0);\n        },\n\n        // Remove or add flags to span tags to remove Chrome generated spans\n        toggleSpan: function (addFlag) {\n            var t = this;\n            t.$ed.find('span').each(function () {\n                if (addFlag === true) {\n                    $(this).attr('data-tbw-flag', true);\n                } else {\n                    if ($(this).attr('data-tbw-flag')) {\n                        $(this).removeAttr('data-tbw-flag');\n                    } else {\n                        $(this).contents().unwrap();\n                    }\n                }\n            });\n        },\n\n        // Open dropdown when click on a button which open that\n        dropdown: function (name) {\n            var t = this,\n                $body = $('body', t.doc),\n                prefix = t.o.prefix,\n                $dropdown = $('[data-' + prefix + 'dropdown=' + name + ']', t.$box),\n                $btn = $('.' + prefix + name + '-button', t.$btnPane),\n                show = $dropdown.is(':hidden');\n\n            $body.trigger('mousedown');\n\n            if (show) {\n                var btnOffsetLeft = $btn.offset().left;\n                $btn.addClass(prefix + 'active');\n\n                $dropdown.css({\n                    position: 'absolute',\n                    top: $btn.offset().top - t.$btnPane.offset().top + $btn.outerHeight(),\n                    left: (t.o.fixedFullWidth && t.isFixed) ? btnOffsetLeft : (btnOffsetLeft - t.$btnPane.offset().left)\n                }).show();\n\n                $(window).trigger('scroll');\n\n                $body.on('mousedown.' + t.eventNamespace, function (e) {\n                    if (!$dropdown.is(e.target)) {\n                        $('.' + prefix + 'dropdown', t.$box).hide();\n                        $('.' + prefix + 'active', t.$btnPane).removeClass(prefix + 'active');\n                        $body.off('mousedown.' + t.eventNamespace);\n                    }\n                });\n            }\n        },\n\n\n        // HTML Code management\n        html: function (html) {\n            var t = this;\n\n            if (html != null) {\n                t.$ta.val(html);\n                t.syncCode(true);\n                t.$c.trigger('tbwchange');\n                return t;\n            }\n\n            return t.$ta.val();\n        },\n        syncTextarea: function () {\n            var t = this;\n            t.$ta.val(t.$ed.text().trim().length > 0 || t.$ed.find(t.o.tagsToKeep.join(',')).length > 0 ? t.$ed.html() : '');\n        },\n        syncCode: function (force) {\n            var t = this;\n            if (!force && t.$ed.is(':visible')) {\n                t.syncTextarea();\n            } else {\n                // wrap the content in a div it's easier to get the inner html\n                var html = $('<div>').html(t.$ta.val());\n                // scrub the html before loading into the doc\n                var safe = $('<div>').append(html);\n                $(t.o.tagsToRemove.join(','), safe).remove();\n                t.$ed.html(safe.contents().html());\n            }\n\n            if (t.o.autogrow) {\n                t.height = t.$ed.height();\n                if (t.height !== t.$ta.css('height')) {\n                    t.$ta.css({height: t.height});\n                    t.$c.trigger('tbwresize');\n                }\n            }\n            if (t.o.autogrowOnEnter) {\n                t.$ed.height('auto');\n                var totalHeight = t.autogrowOnEnterWasFocused ? t.$ed[0].scrollHeight : t.$ed.css('min-height');\n                if (totalHeight !== t.$ta.css('height')) {\n                    t.$ed.css({height: totalHeight});\n                    t.$c.trigger('tbwresize');\n                }\n            }\n        },\n\n        // Analyse and update to semantic code\n        // @param force : force to sync code from textarea\n        // @param full  : wrap text nodes in <p>\n        // @param keepRange  : leave selection range as it is\n        semanticCode: function (force, full, keepRange) {\n            var t = this;\n            t.saveRange();\n            t.syncCode(force);\n\n            var restoreRange = true;\n            if (t.range && t.range.collapsed) {\n                restoreRange = false;\n            }\n\n            if (t.o.semantic) {\n                t.semanticTag('b', t.o.semanticKeepAttributes);\n                t.semanticTag('i', t.o.semanticKeepAttributes);\n                t.semanticTag('s', t.o.semanticKeepAttributes);\n                t.semanticTag('strike', t.o.semanticKeepAttributes);\n\n                if (full) {\n                    var inlineElementsSelector = t.o.inlineElementsSelector,\n                        blockElementsSelector = ':not(' + inlineElementsSelector + ')';\n\n                    // Wrap text nodes in span for easier processing\n                    t.$ed.contents().filter(function () {\n                        return this.nodeType === 3 && this.nodeValue.trim().length > 0;\n                    }).wrap('<span data-tbw/>');\n\n                    // Wrap groups of inline elements in paragraphs (recursive)\n                    var wrapInlinesInParagraphsFrom = function ($from) {\n                        if ($from.length !== 0) {\n                            var $finalParagraph = $from.nextUntil(blockElementsSelector).addBack().wrapAll('<p/>').parent(),\n                                $nextElement = $finalParagraph.nextAll(inlineElementsSelector).first();\n                            $finalParagraph.next('br').remove();\n                            wrapInlinesInParagraphsFrom($nextElement);\n                        }\n                    };\n                    wrapInlinesInParagraphsFrom(t.$ed.children(inlineElementsSelector).first());\n\n                    t.semanticTag('div', true);\n\n                    // Get rid of temporary span's\n                    $('[data-tbw]', t.$ed).contents().unwrap();\n\n                    // Remove empty <p>\n                    t.$ed.find('p:empty').remove();\n                }\n\n                if (!keepRange && restoreRange) {\n                    t.restoreRange();\n                }\n\n                t.syncTextarea();\n            }\n        },\n\n        semanticTag: function (oldTag, copyAttributes, revert) {\n            var newTag, t = this;\n            var tmpTag = oldTag;\n\n            if (this.o.semantic != null && typeof this.o.semantic === 'object' && this.o.semantic.hasOwnProperty(oldTag)) {\n                newTag = this.o.semantic[oldTag];\n            } else if (this.o.semantic === true && this.DEFAULT_SEMANTIC_MAP.hasOwnProperty(oldTag)) {\n                newTag = this.DEFAULT_SEMANTIC_MAP[oldTag];\n            } else {\n                return;\n            }\n\n            if(revert) {\n                oldTag = newTag;\n                newTag = tmpTag;\n            }\n\n            $(oldTag, this.$ed).each(function () {\n                var resetRange = false;\n                var $oldTag = $(this);\n                if ($oldTag.contents().length === 0) {\n                    return false;\n                }\n\n                if(t.range.startContainer.parentNode && t.range.startContainer.parentNode === this) {\n                    resetRange = true;\n                }\n                var $newTag = $('<' + newTag + '/>');\n                $newTag.insertBefore($oldTag);\n                if (copyAttributes) {\n                    $.each($oldTag.prop('attributes'), function () {\n                        $newTag.attr(this.name, this.value);\n                    });\n                }\n                $newTag.html($oldTag.html());\n                $oldTag.remove();\n                if(resetRange === true) {\n                    t.range.selectNodeContents($newTag.get(0));\n                    t.range.collapse(false);\n                }\n            });\n        },\n\n        // Function call when user click on \"Insert Link\"\n        createLink: function () {\n            var t = this,\n                documentSelection = t.doc.getSelection(),\n                selectedRange = documentSelection.getRangeAt(0),\n                node = documentSelection.focusNode,\n                text = new XMLSerializer().serializeToString(selectedRange.cloneContents()) || selectedRange + '',\n                url,\n                title,\n                target;\n\n            while (['A', 'DIV'].indexOf(node.nodeName) < 0) {\n                node = node.parentNode;\n            }\n\n            if (node && node.nodeName === 'A') {\n                var $a = $(node);\n                text = $a.text();\n                url = $a.attr('href');\n                if (!t.o.minimalLinks) {\n                    title = $a.attr('title');\n                    target = $a.attr('target') || t.o.defaultLinkTarget;\n                }\n                var range = t.doc.createRange();\n                range.selectNode(node);\n                documentSelection.removeAllRanges();\n                documentSelection.addRange(range);\n            }\n\n            t.saveRange();\n\n            var options = {\n                url: {\n                    label: t.lang.linkUrl || 'URL',\n                    required: true,\n                    value: url\n                },\n                text: {\n                    label: t.lang.text,\n                    value: text\n                }\n            };\n            if (!t.o.minimalLinks) {\n                $.extend(options, {\n                    title: {\n                        label: t.lang.title,\n                        value: title\n                    },\n                    target: {\n                        label: t.lang.target,\n                        value: target\n                    }\n                });\n            }\n\n            t.openModalInsert(t.lang.createLink, options, function (v) { // v is value\n                var url = t.prependUrlPrefix(v.url);\n                if (!url.length) {\n                    return false;\n                }\n\n                var link = $(['<a href=\"', url, '\">', v.text || v.url, '</a>'].join(''));\n\n                if (v.title) {\n                    link.attr('title', v.title);\n                }\n                if (v.target || t.o.defaultLinkTarget) {\n                    link.attr('target', v.target || t.o.defaultLinkTarget);\n                }\n                t.range.deleteContents();\n                t.range.insertNode(link[0]);\n                t.syncCode();\n                t.$c.trigger('tbwchange');\n                return true;\n            });\n        },\n        prependUrlPrefix: function (url) {\n            var t = this;\n            if (!t.urlPrefix) {\n                return url;\n            }\n\n            var VALID_LINK_PREFIX = /^([a-z][-+.a-z0-9]*:|\\/|#)/i;\n            if (VALID_LINK_PREFIX.test(url)) {\n                return url;\n            }\n\n            var SIMPLE_EMAIL_REGEX = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\n            if (SIMPLE_EMAIL_REGEX.test(url)) {\n                return 'mailto:' + url;\n            }\n\n            return t.urlPrefix + url;\n        },\n        unlink: function () {\n            var t = this,\n                documentSelection = t.doc.getSelection(),\n                node = documentSelection.focusNode;\n\n            if (documentSelection.isCollapsed) {\n                while (['A', 'DIV'].indexOf(node.nodeName) < 0) {\n                    node = node.parentNode;\n                }\n\n                if (node && node.nodeName === 'A') {\n                    var range = t.doc.createRange();\n                    range.selectNode(node);\n                    documentSelection.removeAllRanges();\n                    documentSelection.addRange(range);\n                }\n            }\n            t.execCmd('unlink', undefined, undefined, true);\n        },\n        insertImage: function () {\n            var t = this;\n            t.saveRange();\n\n            var options = {\n                url: {\n                    label: 'URL',\n                    required: true\n                },\n                alt: {\n                    label: t.lang.description,\n                    value: t.getRangeText()\n                }\n            };\n\n            if (t.o.imageWidthModalEdit) {\n                options.width = {};\n            }\n\n            t.openModalInsert(t.lang.insertImage, options, function (v) { // v are values\n                t.execCmd('insertImage', v.url, false, true);\n                var $img = $('img[src=\"' + v.url + '\"]:not([alt])', t.$box);\n                $img.attr('alt', v.alt);\n\n                if (t.o.imageWidthModalEdit) {\n                    $img.attr({\n                        width: v.width\n                    });\n                }\n\n                t.syncCode();\n                t.$c.trigger('tbwchange');\n\n                return true;\n            });\n        },\n        fullscreen: function () {\n            var t = this,\n                prefix = t.o.prefix,\n                fullscreenCssClass = prefix + 'fullscreen',\n                fullscreenPlaceholderClass = fullscreenCssClass + '-placeholder',\n                isFullscreen,\n                editorHeight = t.$box.outerHeight();\n\n            t.$box.toggleClass(fullscreenCssClass);\n            isFullscreen = t.$box.hasClass(fullscreenCssClass);\n\n            if (isFullscreen) {\n                t.$box.before(\n                    $('<div/>', {\n                        class: fullscreenPlaceholderClass\n                    }).css({\n                        height: editorHeight\n                    })\n                );\n            } else {\n                $('.' + fullscreenPlaceholderClass).remove();\n            }\n\n            $('body').toggleClass(prefix + 'body-fullscreen', isFullscreen);\n            $(window).trigger('scroll');\n            t.$c.trigger('tbw' + (isFullscreen ? 'open' : 'close') + 'fullscreen');\n        },\n\n\n        /*\n         * Call method of trumbowyg if exist\n         * else try to call anonymous function\n         * and finally native execCommand\n         */\n        execCmd: function (cmd, param, forceCss, skipTrumbowyg) {\n            var t = this;\n            skipTrumbowyg = !!skipTrumbowyg || '';\n\n            if (cmd !== 'dropdown') {\n                t.$ed.focus();\n            }\n\n            if(cmd === 'strikethrough' && t.o.semantic) {\n                t.semanticTag('strike', t.o.semanticKeepAttributes, true); // browsers cannot undo e.g. <del> as they expect <strike>\n            }\n\n            try {\n                t.doc.execCommand('styleWithCSS', false, forceCss || false);\n            } catch (c) {\n            }\n\n            try {\n                t[cmd + skipTrumbowyg](param);\n            } catch (c) {\n                try {\n                    cmd(param);\n                } catch (e2) {\n                    if (cmd === 'insertHorizontalRule') {\n                        param = undefined;\n                    } else if (cmd === 'formatBlock' && t.isIE) {\n                        param = '<' + param + '>';\n                    }\n\n                    t.doc.execCommand(cmd, false, param);\n\n                    t.syncCode();\n                    t.semanticCode(false, true);\n                    try {\n                        var listId = window.getSelection().focusNode;\n                        if(!$(window.getSelection().focusNode.parentNode).hasClass('trumbowyg-editor')){\n                            listId = window.getSelection().focusNode.parentNode;\n                        }\n                        var classes = t.o.tagClasses[param];\n                        if (classes) {\n                            $(listId).addClass(classes);\n                        }\n                    } catch (e) {\n\n                    }\n\n                }\n\n                if (cmd !== 'dropdown') {\n                    t.updateButtonPaneStatus();\n                    t.$c.trigger('tbwchange');\n                }\n            }\n        },\n\n\n        // Open a modal box\n        openModal: function (title, content, buildForm) {\n            var t = this,\n                prefix = t.o.prefix;\n\n            buildForm = buildForm !== false;\n\n            // No open a modal box when exist other modal box\n            if ($('.' + prefix + 'modal-box', t.$box).length > 0) {\n                return false;\n            }\n            if (t.o.autogrowOnEnter) {\n                t.autogrowOnEnterDontClose = true;\n            }\n\n            t.saveRange();\n            t.showOverlay();\n\n            // Disable all btnPane btns\n            t.$btnPane.addClass(prefix + 'disable');\n\n            // Build out of ModalBox, it's the mask for animations\n            var $modal = $('<div/>', {\n                class: prefix + 'modal ' + prefix + 'fixed-top'\n            }).css({\n                top: t.$box.offset().top + t.$btnPane.height(),\n                zIndex: 99999\n            }).appendTo($(t.doc.body));\n\n            // Click on overlay close modal by cancelling them\n            t.$overlay.one('click', function () {\n                $modal.trigger(CANCEL_EVENT);\n                return false;\n            });\n\n            // Build the form\n            var formOrContent;\n            if (buildForm) {\n                formOrContent = $('<form/>', {\n                    action: '',\n                    html: content\n                })\n                    .on('submit', function () {\n                        $modal.trigger(CONFIRM_EVENT);\n                        return false;\n                    })\n                    .on('reset', function () {\n                        $modal.trigger(CANCEL_EVENT);\n                        return false;\n                    })\n                    .on('submit reset', function () {\n                        if (t.o.autogrowOnEnter) {\n                            t.autogrowOnEnterDontClose = false;\n                        }\n                    });\n            } else {\n                formOrContent = content;\n            }\n\n\n            // Build ModalBox and animate to show them\n            var $box = $('<div/>', {\n                class: prefix + 'modal-box',\n                html: formOrContent\n            })\n                .css({\n                    top: '-' + t.$btnPane.outerHeight(),\n                    opacity: 0,\n                    paddingBottom: buildForm ? null : '5%',\n                })\n                .appendTo($modal)\n                .animate({\n                    top: 0,\n                    opacity: 1\n                }, 100);\n\n\n            // Append title\n            if (title) {\n                $('<span/>', {\n                    text: title,\n                    class: prefix + 'modal-title'\n                }).prependTo($box);\n            }\n\n            if (buildForm) {\n                // Focus in modal box\n                $('input:first', $box).focus();\n\n                // Append Confirm and Cancel buttons\n                t.buildModalBtn('submit', $box);\n                t.buildModalBtn('reset', $box);\n\n                $modal.height($box.outerHeight() + 10);\n            }\n\n            $(window).trigger('scroll');\n            t.$c.trigger('tbwmodalopen');\n\n            return $modal;\n        },\n        // @param n is name of modal\n        buildModalBtn: function (n, $modal) {\n            var t = this,\n                prefix = t.o.prefix;\n\n            return $('<button/>', {\n                class: prefix + 'modal-button ' + prefix + 'modal-' + n,\n                type: n,\n                text: t.lang[n] || n\n            }).appendTo($('form', $modal));\n        },\n        // close current modal box\n        closeModal: function () {\n            var t = this,\n                prefix = t.o.prefix;\n\n            t.$btnPane.removeClass(prefix + 'disable');\n            t.$overlay.off();\n\n            // Find the modal box\n            var $modalBox = $('.' + prefix + 'modal-box', $(t.doc.body));\n\n            $modalBox.animate({\n                top: '-' + $modalBox.height()\n            }, 100, function () {\n                $modalBox.parent().remove();\n                t.hideOverlay();\n                t.$c.trigger('tbwmodalclose');\n            });\n\n            t.restoreRange();\n        },\n        // Pre-formatted build and management modal\n        openModalInsert: function (title, fields, cmd) {\n            var t = this,\n                prefix = t.o.prefix,\n                lg = t.lang,\n                html = '';\n\n            $.each(fields, function (fieldName, field) {\n                var l = field.label || fieldName,\n                    n = field.name || fieldName,\n                    a = field.attributes || {};\n\n                var attr = Object.keys(a).map(function (prop) {\n                    return prop + '=\"' + a[prop] + '\"';\n                }).join(' ');\n\n                html += '<label><input type=\"' + (field.type || 'text') + '\" name=\"' + n + '\"' +\n                    (field.type === 'checkbox' && field.value ? ' checked=\"checked\"' : ' value=\"' + (field.value || '').replace(/\"/g, '&quot;')) +\n                    '\"' + attr + '><span class=\"' + prefix + 'input-infos\"><span>' +\n                    (lg[l] ? lg[l] : l) +\n                    '</span></span></label>';\n            });\n\n            return t.openModal(title, html)\n                .on(CONFIRM_EVENT, function () {\n                    var $form = $('form', $(this)),\n                        valid = true,\n                        values = {};\n\n                    $.each(fields, function (fieldName, field) {\n                        var n = field.name || fieldName;\n\n                        var $field = $('input[name=\"' + n + '\"]', $form),\n                            inputType = $field.attr('type');\n\n                        switch (inputType.toLowerCase()) {\n                            case 'checkbox':\n                                values[n] = $field.is(':checked');\n                                break;\n                            case 'radio':\n                                values[n] = $field.filter(':checked').val();\n                                break;\n                            default:\n                                values[n] = $.trim($field.val());\n                                break;\n                        }\n                        // Validate value\n                        if (field.required && values[n] === '') {\n                            valid = false;\n                            t.addErrorOnModalField($field, t.lang.required);\n                        } else if (field.pattern && !field.pattern.test(values[n])) {\n                            valid = false;\n                            t.addErrorOnModalField($field, field.patternError);\n                        }\n                    });\n\n                    if (valid) {\n                        t.restoreRange();\n\n                        if (cmd(values, fields)) {\n                            t.syncCode();\n                            t.$c.trigger('tbwchange');\n                            t.closeModal();\n                            $(this).off(CONFIRM_EVENT);\n                        }\n                    }\n                })\n                .one(CANCEL_EVENT, function () {\n                    $(this).off(CONFIRM_EVENT);\n                    t.closeModal();\n                });\n        },\n        addErrorOnModalField: function ($field, err) {\n            var prefix = this.o.prefix,\n                spanErrorClass = prefix + 'msg-error',\n                $label = $field.parent();\n\n            $field\n                .on('change keyup', function () {\n                    $label.removeClass(prefix + 'input-error');\n                    setTimeout(function () {\n                        $label.find('.' + spanErrorClass).remove();\n                    }, 150);\n                });\n\n            $label\n                .addClass(prefix + 'input-error')\n                .find('input+span')\n                .append(\n                    $('<span/>', {\n                        class: spanErrorClass,\n                        text: err\n                    })\n                );\n        },\n\n        getDefaultImgDblClickHandler: function () {\n            var t = this;\n\n            return function () {\n                var $img = $(this),\n                    src = $img.attr('src'),\n                    base64 = '(Base64)';\n\n                if (src.indexOf('data:image') === 0) {\n                    src = base64;\n                }\n\n                var options = {\n                    url: {\n                        label: 'URL',\n                        value: src,\n                        required: true\n                    },\n                    alt: {\n                        label: t.lang.description,\n                        value: $img.attr('alt')\n                    }\n                };\n\n                if (t.o.imageWidthModalEdit) {\n                    options.width = {\n                        value: $img.attr('width') ? $img.attr('width') : ''\n                    };\n                }\n\n                t.openModalInsert(t.lang.insertImage, options, function (v) {\n                    if (v.url !== base64) {\n                        $img.attr({\n                            src: v.url\n                        });\n                    }\n                    $img.attr({\n                        alt: v.alt\n                    });\n\n                    if (t.o.imageWidthModalEdit) {\n                        if (parseInt(v.width) > 0) {\n                            $img.attr({\n                                width: v.width\n                            });\n                        } else {\n                            $img.removeAttr('width');\n                        }\n                    }\n\n                    return true;\n                });\n                return false;\n            };\n        },\n\n        // Range management\n        saveRange: function () {\n            var t = this,\n                documentSelection = t.doc.getSelection();\n\n            t.range = null;\n\n            if (!documentSelection || !documentSelection.rangeCount) {\n                return;\n            }\n\n            var savedRange = t.range = documentSelection.getRangeAt(0),\n                range = t.doc.createRange(),\n                rangeStart;\n            range.selectNodeContents(t.$ed[0]);\n            range.setEnd(savedRange.startContainer, savedRange.startOffset);\n            rangeStart = (range + '').length;\n            t.metaRange = {\n                start: rangeStart,\n                end: rangeStart + (savedRange + '').length\n            };\n        },\n        restoreRange: function () {\n            var t = this,\n                metaRange = t.metaRange,\n                savedRange = t.range,\n                documentSelection = t.doc.getSelection(),\n                range;\n\n            if (!savedRange) {\n                return;\n            }\n\n            if (metaRange && metaRange.start !== metaRange.end) { // Algorithm from http://jsfiddle.net/WeWy7/3/\n                var charIndex = 0,\n                    nodeStack = [t.$ed[0]],\n                    node,\n                    foundStart = false,\n                    stop = false;\n\n                range = t.doc.createRange();\n\n                while (!stop && (node = nodeStack.pop())) {\n                    if (node.nodeType === 3) {\n                        var nextCharIndex = charIndex + node.length;\n                        if (!foundStart && metaRange.start >= charIndex && metaRange.start <= nextCharIndex) {\n                            range.setStart(node, metaRange.start - charIndex);\n                            foundStart = true;\n                        }\n                        if (foundStart && metaRange.end >= charIndex && metaRange.end <= nextCharIndex) {\n                            range.setEnd(node, metaRange.end - charIndex);\n                            stop = true;\n                        }\n                        charIndex = nextCharIndex;\n                    } else {\n                        var cn = node.childNodes,\n                            i = cn.length;\n\n                        while (i > 0) {\n                            i -= 1;\n                            nodeStack.push(cn[i]);\n                        }\n                    }\n                }\n            }\n\n            // Fix IE11 Error 'Could not complete the operation due to error 800a025e'.\n            // https://stackoverflow.com/questions/16160996/could-not-complete-the-operation-due-to-error-800a025e\n            try {\n                documentSelection.removeAllRanges();\n            } catch (e) {\n            }\n\n            documentSelection.addRange(range || savedRange);\n        },\n        getRangeText: function () {\n            return this.range + '';\n        },\n\n        clearButtonPaneStatus: function () {\n            var t = this,\n                prefix = t.o.prefix,\n                activeClasses = prefix + 'active-button ' + prefix + 'active',\n                originalIconClass = prefix + 'original-icon';\n\n            // Reset all buttons and dropdown state\n            $('.' + prefix + 'active-button', t.$btnPane).removeClass(activeClasses);\n            $('.' + originalIconClass, t.$btnPane).each(function () {\n                $(this).find('svg use').attr('xlink:href', $(this).data(originalIconClass));\n            });\n        },\n        updateButtonPaneStatus: function () {\n            var t = this,\n                prefix = t.o.prefix,\n                activeClasses = prefix + 'active-button ' + prefix + 'active',\n                originalIconClass = prefix + 'original-icon',\n                tags = t.getTagsRecursive(t.doc.getSelection().focusNode);\n\n            t.clearButtonPaneStatus();\n\n            $.each(tags, function (i, tag) {\n                var btnName = t.tagToButton[tag.toLowerCase()],\n                    $btn = $('.' + prefix + btnName + '-button', t.$btnPane);\n\n                if ($btn.length > 0) {\n                    $btn.addClass(activeClasses);\n                } else {\n                    try {\n                        $btn = $('.' + prefix + 'dropdown .' + prefix + btnName + '-dropdown-button', t.$box);\n                        var $btnSvgUse = $btn.find('svg use'),\n                            dropdownBtnName = $btn.parent().data(prefix + 'dropdown'),\n                            $dropdownBtn = $('.' + prefix + dropdownBtnName + '-button', t.$box),\n                            $dropdownBtnSvgUse = $dropdownBtn.find('svg use');\n\n                        // Highlight the dropdown button\n                        $dropdownBtn.addClass(activeClasses);\n\n                        // Switch dropdown icon to the active sub-icon one\n                        if (t.o.changeActiveDropdownIcon && $btnSvgUse.length > 0) {\n                            // Save original icon\n                            $dropdownBtn\n                                .addClass(originalIconClass)\n                                .data(originalIconClass, $dropdownBtnSvgUse.attr('xlink:href'));\n\n                            // Put the active sub-button's icon\n                            $dropdownBtnSvgUse\n                                .attr('xlink:href', $btnSvgUse.attr('xlink:href'));\n                        }\n                    } catch (e) {\n                    }\n                }\n            });\n        },\n        getTagsRecursive: function (element, tags) {\n            var t = this;\n            tags = tags || (element && element.tagName ? [element.tagName] : []);\n\n            if (element && element.parentNode) {\n                element = element.parentNode;\n            } else {\n                return tags;\n            }\n\n            var tag = element.tagName;\n            if (tag === 'DIV') {\n                return tags;\n            }\n            if (tag === 'P' && element.style.textAlign !== '') {\n                tags.push(element.style.textAlign);\n            }\n\n            $.each(t.tagHandlers, function (i, tagHandler) {\n                tags = tags.concat(tagHandler(element, t));\n            });\n\n            tags.push(tag);\n\n            return t.getTagsRecursive(element, tags).filter(function (tag) {\n                return tag != null;\n            });\n        },\n\n        // Plugins\n        initPlugins: function () {\n            var t = this;\n            t.loadedPlugins = [];\n            $.each($.trumbowyg.plugins, function (name, plugin) {\n                if (!plugin.shouldInit || plugin.shouldInit(t)) {\n                    plugin.init(t);\n                    if (plugin.tagHandler) {\n                        t.tagHandlers.push(plugin.tagHandler);\n                    }\n                    t.loadedPlugins.push(plugin);\n                }\n            });\n        },\n        destroyPlugins: function () {\n            var t = this;\n            $.each(this.loadedPlugins, function (i, plugin) {\n                if (plugin.destroy) {\n                    plugin.destroy(t);\n                }\n            });\n        }\n    };\n})(navigator, window, document, jQuery);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvdHJ1bWJvd3lnL2Rpc3QvdHJ1bWJvd3lnLmpzP2EwMWEiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSzs7QUFFTDtBQUNBLGVBQWU7O0FBRWY7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0Esc0JBQXNCO0FBQ3RCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUJBQW1CO0FBQ25COztBQUVBOztBQUVBOztBQUVBOztBQUVBLG1CQUFtQjs7QUFFbkI7QUFDQTtBQUNBOztBQUVBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLENBQUM7O0FBRUQ7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0EsOEJBQThCO0FBQzlCLDZCQUE2Qjs7QUFFN0I7O0FBRUE7QUFDQTtBQUNBLHNDQUFzQztBQUN0QyxTQUFTO0FBQ1Q7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsK0VBQStFO0FBQy9FLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvRUFBb0U7QUFDcEU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7O0FBRUE7QUFDQTs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7O0FBRWI7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBLGFBQWE7O0FBRWI7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBLGFBQWE7O0FBRWI7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQSxhQUFhOztBQUViO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBLGFBQWE7O0FBRWI7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiLHNCQUFzQjs7QUFFdEIsMkJBQTJCOztBQUUzQjtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQSxhQUFhOztBQUViO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQSxhQUFhOztBQUViO0FBQ0E7QUFDQSxhQUFhOztBQUViLDRCQUE0Qjs7QUFFNUI7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQSxhQUFhOztBQUViO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsK0JBQStCO0FBQy9CO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLFNBQVM7O0FBRVQ7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUzs7QUFFVDtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiLFNBQVM7O0FBRVQ7QUFDQSxnRkFBZ0Y7QUFDaEYsU0FBUzs7QUFF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QTtBQUNBLHFCQUFxQjtBQUNyQjtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiOztBQUVBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTOztBQUVUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2IsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckI7QUFDQTtBQUNBLGFBQWE7QUFDYixTQUFTO0FBQ1Q7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsYUFBYTs7QUFFYjs7QUFFQTtBQUNBO0FBQ0EsYUFBYTtBQUNiLFNBQVM7O0FBRVQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBLENBQUMiLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvdHJ1bWJvd3lnL2Rpc3QvdHJ1bWJvd3lnLmpzLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBUcnVtYm93eWcgdjIuMjMuMCAtIEEgbGlnaHR3ZWlnaHQgV1lTSVdZRyBlZGl0b3JcbiAqIFRydW1ib3d5ZyBjb3JlIGZpbGVcbiAqIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICogQGxpbmsgaHR0cDovL2FsZXgtZC5naXRodWIuaW8vVHJ1bWJvd3lnXG4gKiBAbGljZW5zZSBNSVRcbiAqIEBhdXRob3IgQWxleGFuZHJlIERlbW9kZSAoQWxleC1EKVxuICogICAgICAgICBUd2l0dGVyIDogQEFsZXhhbmRyZURlbW9kZVxuICogICAgICAgICBXZWJzaXRlIDogYWxleC1kLmZyXG4gKi9cblxualF1ZXJ5LnRydW1ib3d5ZyA9IHtcbiAgICBsYW5nczoge1xuICAgICAgICBlbjoge1xuICAgICAgICAgICAgdmlld0hUTUw6ICdWaWV3IEhUTUwnLFxuXG4gICAgICAgICAgICB1bmRvOiAnVW5kbycsXG4gICAgICAgICAgICByZWRvOiAnUmVkbycsXG5cbiAgICAgICAgICAgIGZvcm1hdHRpbmc6ICdGb3JtYXR0aW5nJyxcbiAgICAgICAgICAgIHA6ICdQYXJhZ3JhcGgnLFxuICAgICAgICAgICAgYmxvY2txdW90ZTogJ1F1b3RlJyxcbiAgICAgICAgICAgIGNvZGU6ICdDb2RlJyxcbiAgICAgICAgICAgIGhlYWRlcjogJ0hlYWRlcicsXG5cbiAgICAgICAgICAgIGJvbGQ6ICdCb2xkJyxcbiAgICAgICAgICAgIGl0YWxpYzogJ0l0YWxpYycsXG4gICAgICAgICAgICBzdHJpa2V0aHJvdWdoOiAnU3RyaWtldGhyb3VnaCcsXG4gICAgICAgICAgICB1bmRlcmxpbmU6ICdVbmRlcmxpbmUnLFxuXG4gICAgICAgICAgICBzdHJvbmc6ICdTdHJvbmcnLFxuICAgICAgICAgICAgZW06ICdFbXBoYXNpcycsXG4gICAgICAgICAgICBkZWw6ICdEZWxldGVkJyxcblxuICAgICAgICAgICAgc3VwZXJzY3JpcHQ6ICdTdXBlcnNjcmlwdCcsXG4gICAgICAgICAgICBzdWJzY3JpcHQ6ICdTdWJzY3JpcHQnLFxuXG4gICAgICAgICAgICB1bm9yZGVyZWRMaXN0OiAnVW5vcmRlcmVkIGxpc3QnLFxuICAgICAgICAgICAgb3JkZXJlZExpc3Q6ICdPcmRlcmVkIGxpc3QnLFxuXG4gICAgICAgICAgICBpbnNlcnRJbWFnZTogJ0luc2VydCBJbWFnZScsXG4gICAgICAgICAgICBsaW5rOiAnTGluaycsXG4gICAgICAgICAgICBjcmVhdGVMaW5rOiAnSW5zZXJ0IGxpbmsnLFxuICAgICAgICAgICAgdW5saW5rOiAnUmVtb3ZlIGxpbmsnLFxuXG4gICAgICAgICAgICBqdXN0aWZ5TGVmdDogJ0FsaWduIExlZnQnLFxuICAgICAgICAgICAganVzdGlmeUNlbnRlcjogJ0FsaWduIENlbnRlcicsXG4gICAgICAgICAgICBqdXN0aWZ5UmlnaHQ6ICdBbGlnbiBSaWdodCcsXG4gICAgICAgICAgICBqdXN0aWZ5RnVsbDogJ0FsaWduIEp1c3RpZnknLFxuXG4gICAgICAgICAgICBob3Jpem9udGFsUnVsZTogJ0luc2VydCBob3Jpem9udGFsIHJ1bGUnLFxuICAgICAgICAgICAgcmVtb3ZlZm9ybWF0OiAnUmVtb3ZlIGZvcm1hdCcsXG5cbiAgICAgICAgICAgIGZ1bGxzY3JlZW46ICdGdWxsc2NyZWVuJyxcblxuICAgICAgICAgICAgY2xvc2U6ICdDbG9zZScsXG5cbiAgICAgICAgICAgIHN1Ym1pdDogJ0NvbmZpcm0nLFxuICAgICAgICAgICAgcmVzZXQ6ICdDYW5jZWwnLFxuXG4gICAgICAgICAgICByZXF1aXJlZDogJ1JlcXVpcmVkJyxcbiAgICAgICAgICAgIGRlc2NyaXB0aW9uOiAnRGVzY3JpcHRpb24nLFxuICAgICAgICAgICAgdGl0bGU6ICdUaXRsZScsXG4gICAgICAgICAgICB0ZXh0OiAnVGV4dCcsXG4gICAgICAgICAgICB0YXJnZXQ6ICdUYXJnZXQnLFxuICAgICAgICAgICAgd2lkdGg6ICdXaWR0aCdcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICAvLyBQbHVnaW5zXG4gICAgcGx1Z2luczoge30sXG5cbiAgICAvLyBTVkcgUGF0aCBnbG9iYWxseVxuICAgIHN2Z1BhdGg6IG51bGwsXG4gICAgc3ZnQWJzb2x1dGVVc2VIcmVmOiBmYWxzZSxcblxuICAgIGhpZGVCdXR0b25UZXh0czogbnVsbFxufTtcblxuLy8gTWFrZXMgZGVmYXVsdCBvcHRpb25zIHJlYWQtb25seVxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGpRdWVyeS50cnVtYm93eWcsICdkZWZhdWx0T3B0aW9ucycsIHtcbiAgICB2YWx1ZToge1xuICAgICAgICBsYW5nOiAnZW4nLFxuXG4gICAgICAgIGZpeGVkQnRuUGFuZTogZmFsc2UsXG4gICAgICAgIGZpeGVkRnVsbFdpZHRoOiBmYWxzZSxcbiAgICAgICAgYXV0b2dyb3c6IGZhbHNlLFxuICAgICAgICBhdXRvZ3Jvd09uRW50ZXI6IGZhbHNlLFxuICAgICAgICBpbWFnZVdpZHRoTW9kYWxFZGl0OiBmYWxzZSxcbiAgICAgICAgaGlkZUJ1dHRvblRleHRzOiBudWxsLFxuXG4gICAgICAgIHByZWZpeDogJ3RydW1ib3d5Zy0nLFxuICAgICAgICB0YWdDbGFzc2VzOiB7fSxcbiAgICAgICAgc2VtYW50aWM6IHRydWUsXG4gICAgICAgIHNlbWFudGljS2VlcEF0dHJpYnV0ZXM6IGZhbHNlLFxuICAgICAgICByZXNldENzczogZmFsc2UsXG4gICAgICAgIHJlbW92ZWZvcm1hdFBhc3RlZDogZmFsc2UsXG4gICAgICAgIHRhYlRvSW5kZW50OiBmYWxzZSxcbiAgICAgICAgdGFnc1RvUmVtb3ZlOiBbXSxcbiAgICAgICAgdGFnc1RvS2VlcDogWydocicsICdpbWcnLCAnZW1iZWQnLCAnaWZyYW1lJywgJ2lucHV0J10sXG4gICAgICAgIGJ0bnM6IFtcbiAgICAgICAgICAgIFsndmlld0hUTUwnXSxcbiAgICAgICAgICAgIFsndW5kbycsICdyZWRvJ10sIC8vIE9ubHkgc3VwcG9ydGVkIGluIEJsaW5rIGJyb3dzZXJzXG4gICAgICAgICAgICBbJ2Zvcm1hdHRpbmcnXSxcbiAgICAgICAgICAgIFsnc3Ryb25nJywgJ2VtJywgJ2RlbCddLFxuICAgICAgICAgICAgWydzdXBlcnNjcmlwdCcsICdzdWJzY3JpcHQnXSxcbiAgICAgICAgICAgIFsnbGluayddLFxuICAgICAgICAgICAgWydpbnNlcnRJbWFnZSddLFxuICAgICAgICAgICAgWydqdXN0aWZ5TGVmdCcsICdqdXN0aWZ5Q2VudGVyJywgJ2p1c3RpZnlSaWdodCcsICdqdXN0aWZ5RnVsbCddLFxuICAgICAgICAgICAgWyd1bm9yZGVyZWRMaXN0JywgJ29yZGVyZWRMaXN0J10sXG4gICAgICAgICAgICBbJ2hvcml6b250YWxSdWxlJ10sXG4gICAgICAgICAgICBbJ3JlbW92ZWZvcm1hdCddLFxuICAgICAgICAgICAgWydmdWxsc2NyZWVuJ11cbiAgICAgICAgXSxcbiAgICAgICAgLy8gRm9yIGN1c3RvbSBidXR0b24gZGVmaW5pdGlvbnNcbiAgICAgICAgYnRuc0RlZjoge30sXG4gICAgICAgIGNoYW5nZUFjdGl2ZURyb3Bkb3duSWNvbjogZmFsc2UsXG5cbiAgICAgICAgaW5saW5lRWxlbWVudHNTZWxlY3RvcjogJ2EsYWJicixhY3JvbnltLGIsY2FwdGlvbixjaXRlLGNvZGUsY29sLGRmbixkaXIsZHQsZGQsZW0sZm9udCxocixpLGtiZCxsaSxxLHNwYW4sc3RyaWtlb3V0LHN0cm9uZyxzdWIsc3VwLHUnLFxuXG4gICAgICAgIHBhc3RlSGFuZGxlcnM6IFtdLFxuXG4gICAgICAgIC8vIGltZ0RibENsaWNrSGFuZGxlcjogZGVmYXVsdCBpcyBkZWZpbmVkIGluIGNvbnN0cnVjdG9yXG5cbiAgICAgICAgcGx1Z2luczoge30sXG5cbiAgICAgICAgdXJsUHJvdG9jb2w6IGZhbHNlLFxuICAgICAgICBtaW5pbWFsTGlua3M6IGZhbHNlLFxuICAgICAgICBkZWZhdWx0TGlua1RhcmdldDogdW5kZWZpbmVkLFxuXG4gICAgICAgIHN2Z1BhdGg6IG51bGxcbiAgICB9LFxuICAgIHdyaXRhYmxlOiBmYWxzZSxcbiAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgIGNvbmZpZ3VyYWJsZTogZmFsc2Vcbn0pO1xuXG4oZnVuY3Rpb24gKG5hdmlnYXRvciwgd2luZG93LCBkb2N1bWVudCwgJCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIHZhciBDT05GSVJNX0VWRU5UID0gJ3Rid2NvbmZpcm0nLFxuICAgICAgICBDQU5DRUxfRVZFTlQgPSAndGJ3Y2FuY2VsJztcblxuICAgICQuZm4udHJ1bWJvd3lnID0gZnVuY3Rpb24gKG9wdGlvbnMsIHBhcmFtcykge1xuICAgICAgICB2YXIgdHJ1bWJvd3lnRGF0YU5hbWUgPSAndHJ1bWJvd3lnJztcbiAgICAgICAgaWYgKG9wdGlvbnMgPT09IE9iamVjdChvcHRpb25zKSB8fCAhb3B0aW9ucykge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgaWYgKCEkKHRoaXMpLmRhdGEodHJ1bWJvd3lnRGF0YU5hbWUpKSB7XG4gICAgICAgICAgICAgICAgICAgICQodGhpcykuZGF0YSh0cnVtYm93eWdEYXRhTmFtZSwgbmV3IFRydW1ib3d5Zyh0aGlzLCBvcHRpb25zKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMubGVuZ3RoID09PSAxKSB7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIHZhciB0ID0gJCh0aGlzKS5kYXRhKHRydW1ib3d5Z0RhdGFOYW1lKTtcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKG9wdGlvbnMpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gRXhlYyBjb21tYW5kXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ2V4ZWNDbWQnOlxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHQuZXhlY0NtZChwYXJhbXMuY21kLCBwYXJhbXMucGFyYW0sIHBhcmFtcy5mb3JjZUNzcywgcGFyYW1zLnNraXBUcnVtYm93eWcpO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIE1vZGFsIGJveFxuICAgICAgICAgICAgICAgICAgICBjYXNlICdvcGVuTW9kYWwnOlxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHQub3Blbk1vZGFsKHBhcmFtcy50aXRsZSwgcGFyYW1zLmNvbnRlbnQpO1xuICAgICAgICAgICAgICAgICAgICBjYXNlICdjbG9zZU1vZGFsJzpcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0LmNsb3NlTW9kYWwoKTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnb3Blbk1vZGFsSW5zZXJ0JzpcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0Lm9wZW5Nb2RhbEluc2VydChwYXJhbXMudGl0bGUsIHBhcmFtcy5maWVsZHMsIHBhcmFtcy5jYWxsYmFjayk7XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gUmFuZ2VcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnc2F2ZVJhbmdlJzpcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0LnNhdmVSYW5nZSgpO1xuICAgICAgICAgICAgICAgICAgICBjYXNlICdnZXRSYW5nZSc6XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdC5yYW5nZTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnZ2V0UmFuZ2VUZXh0JzpcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0LmdldFJhbmdlVGV4dCgpO1xuICAgICAgICAgICAgICAgICAgICBjYXNlICdyZXN0b3JlUmFuZ2UnOlxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHQucmVzdG9yZVJhbmdlKCk7XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gRW5hYmxlL2Rpc2FibGVcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnZW5hYmxlJzpcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0LnNldERpc2FibGVkKGZhbHNlKTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnZGlzYWJsZSc6XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdC5zZXREaXNhYmxlZCh0cnVlKTtcblxuICAgICAgICAgICAgICAgICAgICAvLyBUb2dnbGVcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAndG9nZ2xlJzpcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0LnRvZ2dsZSgpO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIERlc3Ryb3lcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnZGVzdHJveSc6XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdC5kZXN0cm95KCk7XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gRW1wdHlcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnZW1wdHknOlxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHQuZW1wdHkoKTtcblxuICAgICAgICAgICAgICAgICAgICAvLyBIVE1MXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ2h0bWwnOlxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHQuaHRtbChwYXJhbXMpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gY2F0Y2ggKGMpIHtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9O1xuXG4gICAgLy8gQHBhcmFtOiBlZGl0b3JFbGVtIGlzIHRoZSBET00gZWxlbWVudFxuICAgIHZhciBUcnVtYm93eWcgPSBmdW5jdGlvbiAoZWRpdG9yRWxlbSwgb3B0aW9ucykge1xuICAgICAgICB2YXIgdCA9IHRoaXMsXG4gICAgICAgICAgICB0cnVtYm93eWdJY29uc0lkID0gJ3RydW1ib3d5Zy1pY29ucycsXG4gICAgICAgICAgICAkdHJ1bWJvd3lnID0gJC50cnVtYm93eWc7XG5cbiAgICAgICAgLy8gR2V0IHRoZSBkb2N1bWVudCBvZiB0aGUgZWxlbWVudC4gSXQgdXNlIHRvIG1ha2VzIHRoZSBwbHVnaW5cbiAgICAgICAgLy8gY29tcGF0aWJsZSBvbiBpZnJhbWVzLlxuICAgICAgICB0LmRvYyA9IGVkaXRvckVsZW0ub3duZXJEb2N1bWVudCB8fCBkb2N1bWVudDtcblxuICAgICAgICAvLyBqUXVlcnkgb2JqZWN0IG9mIHRoZSBlZGl0b3JcbiAgICAgICAgdC4kdGEgPSAkKGVkaXRvckVsZW0pOyAvLyAkdGEgOiBUZXh0YXJlYVxuICAgICAgICB0LiRjID0gJChlZGl0b3JFbGVtKTsgLy8gJGMgOiBjcmVhdG9yXG5cbiAgICAgICAgb3B0aW9ucyA9IG9wdGlvbnMgfHwge307XG5cbiAgICAgICAgLy8gTG9jYWxpemF0aW9uIG1hbmFnZW1lbnRcbiAgICAgICAgaWYgKG9wdGlvbnMubGFuZyAhPSBudWxsIHx8ICR0cnVtYm93eWcubGFuZ3Nbb3B0aW9ucy5sYW5nXSAhPSBudWxsKSB7XG4gICAgICAgICAgICB0LmxhbmcgPSAkLmV4dGVuZCh0cnVlLCB7fSwgJHRydW1ib3d5Zy5sYW5ncy5lbiwgJHRydW1ib3d5Zy5sYW5nc1tvcHRpb25zLmxhbmddKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHQubGFuZyA9ICR0cnVtYm93eWcubGFuZ3MuZW47XG4gICAgICAgIH1cblxuICAgICAgICB0LmhpZGVCdXR0b25UZXh0cyA9ICR0cnVtYm93eWcuaGlkZUJ1dHRvblRleHRzICE9IG51bGwgPyAkdHJ1bWJvd3lnLmhpZGVCdXR0b25UZXh0cyA6IG9wdGlvbnMuaGlkZUJ1dHRvblRleHRzO1xuXG4gICAgICAgIC8vIFNWRyBwYXRoXG4gICAgICAgIHZhciBzdmdQYXRoT3B0aW9uID0gJHRydW1ib3d5Zy5zdmdQYXRoICE9IG51bGwgPyAkdHJ1bWJvd3lnLnN2Z1BhdGggOiBvcHRpb25zLnN2Z1BhdGg7XG4gICAgICAgIHQuaGFzU3ZnID0gc3ZnUGF0aE9wdGlvbiAhPT0gZmFsc2U7XG5cbiAgICAgICAgaWYgKHN2Z1BhdGhPcHRpb24gIT09IGZhbHNlICYmICgkdHJ1bWJvd3lnLnN2Z0Fic29sdXRlVXNlSHJlZiB8fCAkKCcjJyArIHRydW1ib3d5Z0ljb25zSWQsIHQuZG9jKS5sZW5ndGggPT09IDApKSB7XG4gICAgICAgICAgICBpZiAoc3ZnUGF0aE9wdGlvbiA9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgLy8gSGFjayB0byBnZXQgc3ZnUGF0aE9wdGlvbiBiYXNlZCBvbiB0cnVtYm93eWcuanMgcGF0aFxuICAgICAgICAgICAgICAgIHZhciAkc2NyaXB0RWxlbWVudHMgPSAkKCdzY3JpcHRbc3JjXScpO1xuICAgICAgICAgICAgICAgICRzY3JpcHRFbGVtZW50cy5lYWNoKGZ1bmN0aW9uIChpLCBzY3JpcHRFbGVtZW50KSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBzb3VyY2UgPSBzY3JpcHRFbGVtZW50LnNyYztcbiAgICAgICAgICAgICAgICAgICAgdmFyIG1hdGNoZXMgPSBzb3VyY2UubWF0Y2goJ3RydW1ib3d5ZyhcXC5taW4pP1xcLmpzJyk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChtYXRjaGVzICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN2Z1BhdGhPcHRpb24gPSBzb3VyY2Uuc3Vic3RyaW5nKDAsIHNvdXJjZS5pbmRleE9mKG1hdGNoZXNbMF0pKSArICd1aS9pY29ucy5zdmcnO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIERvIG5vdCBtZXJnZSB3aXRoIHByZXZpb3VzIGlmIGJsb2NrOiBzdmdQYXRoT3B0aW9uIGNhbiBiZSByZWRlZmluZWQgaW4gaXQuXG4gICAgICAgICAgICAvLyBIZXJlIHdlIGFyZSBjaGVja2luZyB0aGF0IHdlIGZpbmQgYSBtYXRjaFxuICAgICAgICAgICAgaWYgKHN2Z1BhdGhPcHRpb24gPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUud2FybignWW91IG11c3QgZGVmaW5lIHN2Z1BhdGg6IGh0dHBzOi8vZ29vLmdsL0NmVFk5VScpOyAvLyBqc2hpbnQgaWdub3JlOmxpbmVcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoISR0cnVtYm93eWcuc3ZnQWJzb2x1dGVVc2VIcmVmKSB7XG4gICAgICAgICAgICAgICAgdmFyIGRpdiA9IHQuZG9jLmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgICAgICAgICAgIGRpdi5pZCA9IHRydW1ib3d5Z0ljb25zSWQ7XG4gICAgICAgICAgICAgICAgdC5kb2MuYm9keS5pbnNlcnRCZWZvcmUoZGl2LCB0LmRvYy5ib2R5LmNoaWxkTm9kZXNbMF0pO1xuICAgICAgICAgICAgICAgICQuYWpheCh7XG4gICAgICAgICAgICAgICAgICAgIGFzeW5jOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICB0eXBlOiAnR0VUJyxcbiAgICAgICAgICAgICAgICAgICAgY29udGVudFR5cGU6ICdhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQ7IGNoYXJzZXQ9VVRGLTgnLFxuICAgICAgICAgICAgICAgICAgICBkYXRhVHlwZTogJ3htbCcsXG4gICAgICAgICAgICAgICAgICAgIGNyb3NzRG9tYWluOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICB1cmw6IHN2Z1BhdGhPcHRpb24sXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IG51bGwsXG4gICAgICAgICAgICAgICAgICAgIGJlZm9yZVNlbmQ6IG51bGwsXG4gICAgICAgICAgICAgICAgICAgIGNvbXBsZXRlOiBudWxsLFxuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZGl2LmlubmVySFRNTCA9IG5ldyBYTUxTZXJpYWxpemVyKCkuc2VyaWFsaXplVG9TdHJpbmcoZGF0YS5kb2N1bWVudEVsZW1lbnQpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICB2YXIgYmFzZUhyZWYgPSAhIXQuZG9jLnF1ZXJ5U2VsZWN0b3IoJ2Jhc2UnKSA/IHdpbmRvdy5sb2NhdGlvbi5ocmVmLnNwbGl0KC9bPyNdLylbMF0gOiAnJztcbiAgICAgICAgdC5zdmdQYXRoID0gJHRydW1ib3d5Zy5zdmdBYnNvbHV0ZVVzZUhyZWYgPyBzdmdQYXRoT3B0aW9uIDogYmFzZUhyZWY7XG5cblxuICAgICAgICAvKipcbiAgICAgICAgICogV2hlbiB0aGUgYnV0dG9uIGlzIGFzc29jaWF0ZWQgdG8gYSBlbXB0eSBvYmplY3RcbiAgICAgICAgICogZm4gYW5kIHRpdGxlIGF0dHJpYnV0ZXMgYXJlIGRlZmluZWQgZnJvbSB0aGUgYnV0dG9uIGtleSB2YWx1ZVxuICAgICAgICAgKlxuICAgICAgICAgKiBGb3IgZXhhbXBsZVxuICAgICAgICAgKiAgICAgIGZvbzoge31cbiAgICAgICAgICogaXMgZXF1aXZhbGVudCB0byA6XG4gICAgICAgICAqICAgICAgZm9vOiB7XG4gICAgICAgICAqICAgICAgICAgIGZuOiAnZm9vJyxcbiAgICAgICAgICogICAgICAgICAgdGl0bGU6IHRoaXMubGFuZy5mb29cbiAgICAgICAgICogICAgICB9XG4gICAgICAgICAqL1xuICAgICAgICB2YXIgaCA9IHQubGFuZy5oZWFkZXIsIC8vIEhlYWRlciB0cmFuc2xhdGlvblxuICAgICAgICAgICAgaXNCbGlua0Z1bmN0aW9uID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHJldHVybiAod2luZG93LmNocm9tZSB8fCAod2luZG93LkludGwgJiYgSW50bC52OEJyZWFrSXRlcmF0b3IpKSAmJiAnQ1NTJyBpbiB3aW5kb3c7XG4gICAgICAgICAgICB9O1xuICAgICAgICB0LmJ0bnNEZWYgPSB7XG4gICAgICAgICAgICB2aWV3SFRNTDoge1xuICAgICAgICAgICAgICAgIGZuOiAndG9nZ2xlJyxcbiAgICAgICAgICAgICAgICBjbGFzczogJ3RydW1ib3d5Zy1ub3QtZGlzYWJsZScsXG4gICAgICAgICAgICB9LFxuXG4gICAgICAgICAgICB1bmRvOiB7XG4gICAgICAgICAgICAgICAgaXNTdXBwb3J0ZWQ6IGlzQmxpbmtGdW5jdGlvbixcbiAgICAgICAgICAgICAgICBrZXk6ICdaJ1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHJlZG86IHtcbiAgICAgICAgICAgICAgICBpc1N1cHBvcnRlZDogaXNCbGlua0Z1bmN0aW9uLFxuICAgICAgICAgICAgICAgIGtleTogJ1knXG4gICAgICAgICAgICB9LFxuXG4gICAgICAgICAgICBwOiB7XG4gICAgICAgICAgICAgICAgZm46ICdmb3JtYXRCbG9jaydcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBibG9ja3F1b3RlOiB7XG4gICAgICAgICAgICAgICAgZm46ICdmb3JtYXRCbG9jaydcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBoMToge1xuICAgICAgICAgICAgICAgIGZuOiAnZm9ybWF0QmxvY2snLFxuICAgICAgICAgICAgICAgIHRpdGxlOiBoICsgJyAxJ1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGgyOiB7XG4gICAgICAgICAgICAgICAgZm46ICdmb3JtYXRCbG9jaycsXG4gICAgICAgICAgICAgICAgdGl0bGU6IGggKyAnIDInXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgaDM6IHtcbiAgICAgICAgICAgICAgICBmbjogJ2Zvcm1hdEJsb2NrJyxcbiAgICAgICAgICAgICAgICB0aXRsZTogaCArICcgMydcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBoNDoge1xuICAgICAgICAgICAgICAgIGZuOiAnZm9ybWF0QmxvY2snLFxuICAgICAgICAgICAgICAgIHRpdGxlOiBoICsgJyA0J1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGg1OiB7XG4gICAgICAgICAgICAgICAgZm46ICdmb3JtYXRCbG9jaycsXG4gICAgICAgICAgICAgICAgdGl0bGU6IGggKyAnIDUnXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgaDY6IHtcbiAgICAgICAgICAgICAgICBmbjogJ2Zvcm1hdEJsb2NrJyxcbiAgICAgICAgICAgICAgICB0aXRsZTogaCArICcgNidcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBzdWJzY3JpcHQ6IHtcbiAgICAgICAgICAgICAgICB0YWc6ICdzdWInXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgc3VwZXJzY3JpcHQ6IHtcbiAgICAgICAgICAgICAgICB0YWc6ICdzdXAnXG4gICAgICAgICAgICB9LFxuXG4gICAgICAgICAgICBib2xkOiB7XG4gICAgICAgICAgICAgICAga2V5OiAnQicsXG4gICAgICAgICAgICAgICAgdGFnOiAnYidcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBpdGFsaWM6IHtcbiAgICAgICAgICAgICAgICBrZXk6ICdJJyxcbiAgICAgICAgICAgICAgICB0YWc6ICdpJ1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHVuZGVybGluZToge1xuICAgICAgICAgICAgICAgIHRhZzogJ3UnXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgc3RyaWtldGhyb3VnaDoge1xuICAgICAgICAgICAgICAgIHRhZzogJ3N0cmlrZSdcbiAgICAgICAgICAgIH0sXG5cbiAgICAgICAgICAgIHN0cm9uZzoge1xuICAgICAgICAgICAgICAgIGZuOiAnYm9sZCcsXG4gICAgICAgICAgICAgICAga2V5OiAnQidcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBlbToge1xuICAgICAgICAgICAgICAgIGZuOiAnaXRhbGljJyxcbiAgICAgICAgICAgICAgICBrZXk6ICdJJ1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGRlbDoge1xuICAgICAgICAgICAgICAgIGZuOiAnc3RyaWtldGhyb3VnaCdcbiAgICAgICAgICAgIH0sXG5cbiAgICAgICAgICAgIGNyZWF0ZUxpbms6IHtcbiAgICAgICAgICAgICAgICBrZXk6ICdLJyxcbiAgICAgICAgICAgICAgICB0YWc6ICdhJ1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHVubGluazoge30sXG5cbiAgICAgICAgICAgIGluc2VydEltYWdlOiB7fSxcblxuICAgICAgICAgICAganVzdGlmeUxlZnQ6IHtcbiAgICAgICAgICAgICAgICB0YWc6ICdsZWZ0JyxcbiAgICAgICAgICAgICAgICBmb3JjZUNzczogdHJ1ZVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGp1c3RpZnlDZW50ZXI6IHtcbiAgICAgICAgICAgICAgICB0YWc6ICdjZW50ZXInLFxuICAgICAgICAgICAgICAgIGZvcmNlQ3NzOiB0cnVlXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAganVzdGlmeVJpZ2h0OiB7XG4gICAgICAgICAgICAgICAgdGFnOiAncmlnaHQnLFxuICAgICAgICAgICAgICAgIGZvcmNlQ3NzOiB0cnVlXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAganVzdGlmeUZ1bGw6IHtcbiAgICAgICAgICAgICAgICB0YWc6ICdqdXN0aWZ5JyxcbiAgICAgICAgICAgICAgICBmb3JjZUNzczogdHJ1ZVxuICAgICAgICAgICAgfSxcblxuICAgICAgICAgICAgdW5vcmRlcmVkTGlzdDoge1xuICAgICAgICAgICAgICAgIGZuOiAnaW5zZXJ0VW5vcmRlcmVkTGlzdCcsXG4gICAgICAgICAgICAgICAgdGFnOiAndWwnXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgb3JkZXJlZExpc3Q6IHtcbiAgICAgICAgICAgICAgICBmbjogJ2luc2VydE9yZGVyZWRMaXN0JyxcbiAgICAgICAgICAgICAgICB0YWc6ICdvbCdcbiAgICAgICAgICAgIH0sXG5cbiAgICAgICAgICAgIGhvcml6b250YWxSdWxlOiB7XG4gICAgICAgICAgICAgICAgZm46ICdpbnNlcnRIb3Jpem9udGFsUnVsZSdcbiAgICAgICAgICAgIH0sXG5cbiAgICAgICAgICAgIHJlbW92ZWZvcm1hdDoge30sXG5cbiAgICAgICAgICAgIGZ1bGxzY3JlZW46IHtcbiAgICAgICAgICAgICAgICBjbGFzczogJ3RydW1ib3d5Zy1ub3QtZGlzYWJsZSdcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBjbG9zZToge1xuICAgICAgICAgICAgICAgIGZuOiAnZGVzdHJveScsXG4gICAgICAgICAgICAgICAgY2xhc3M6ICd0cnVtYm93eWctbm90LWRpc2FibGUnXG4gICAgICAgICAgICB9LFxuXG4gICAgICAgICAgICAvLyBEcm9wZG93bnNcbiAgICAgICAgICAgIGZvcm1hdHRpbmc6IHtcbiAgICAgICAgICAgICAgICBkcm9wZG93bjogWydwJywgJ2Jsb2NrcXVvdGUnLCAnaDEnLCAnaDInLCAnaDMnLCAnaDQnXSxcbiAgICAgICAgICAgICAgICBpY286ICdwJ1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGxpbms6IHtcbiAgICAgICAgICAgICAgICBkcm9wZG93bjogWydjcmVhdGVMaW5rJywgJ3VubGluayddXG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG5cbiAgICAgICAgLy8gRGVmYXVsdCBPcHRpb25zXG4gICAgICAgIHQubyA9ICQuZXh0ZW5kKHRydWUsIHt9LCAkdHJ1bWJvd3lnLmRlZmF1bHRPcHRpb25zLCBvcHRpb25zKTtcbiAgICAgICAgaWYgKCF0Lm8uaGFzT3duUHJvcGVydHkoJ2ltZ0RibENsaWNrSGFuZGxlcicpKSB7XG4gICAgICAgICAgICB0Lm8uaW1nRGJsQ2xpY2tIYW5kbGVyID0gdC5nZXREZWZhdWx0SW1nRGJsQ2xpY2tIYW5kbGVyKCk7XG4gICAgICAgIH1cblxuICAgICAgICB0LnVybFByZWZpeCA9IHQuc2V0dXBVcmxQcmVmaXgoKTtcblxuICAgICAgICB0LmRpc2FibGVkID0gdC5vLmRpc2FibGVkIHx8IChlZGl0b3JFbGVtLm5vZGVOYW1lID09PSAnVEVYVEFSRUEnICYmIGVkaXRvckVsZW0uZGlzYWJsZWQpO1xuXG4gICAgICAgIGlmIChvcHRpb25zLmJ0bnMpIHtcbiAgICAgICAgICAgIHQuby5idG5zID0gb3B0aW9ucy5idG5zO1xuICAgICAgICB9IGVsc2UgaWYgKCF0Lm8uc2VtYW50aWMpIHtcbiAgICAgICAgICAgIHQuby5idG5zWzNdID0gWydib2xkJywgJ2l0YWxpYycsICd1bmRlcmxpbmUnLCAnc3RyaWtldGhyb3VnaCddO1xuICAgICAgICB9XG5cbiAgICAgICAgJC5lYWNoKHQuby5idG5zRGVmLCBmdW5jdGlvbiAoYnRuTmFtZSwgYnRuRGVmKSB7XG4gICAgICAgICAgICB0LmFkZEJ0bkRlZihidG5OYW1lLCBidG5EZWYpO1xuICAgICAgICB9KTtcblxuICAgICAgICAvLyBwdXQgdGhpcyBoZXJlIGluIHRoZSBldmVudCBpdCB3b3VsZCBiZSBtZXJnZWQgaW4gd2l0aCBvcHRpb25zXG4gICAgICAgIHQuZXZlbnROYW1lc3BhY2UgPSAndHJ1bWJvd3lnLWV2ZW50JztcblxuICAgICAgICAvLyBLZXlib2FyZCBzaG9ydGN1dHMgYXJlIGxvYWQgaW4gdGhpcyBhcnJheVxuICAgICAgICB0LmtleXMgPSBbXTtcblxuICAgICAgICAvLyBUYWcgdG8gYnV0dG9uIGR5bmFtaWNhbGx5IGh5ZHJhdGVkXG4gICAgICAgIHQudGFnVG9CdXR0b24gPSB7fTtcbiAgICAgICAgdC50YWdIYW5kbGVycyA9IFtdO1xuXG4gICAgICAgIC8vIEFkbWl0IG11bHRpcGxlIHBhc3RlIGhhbmRsZXJzXG4gICAgICAgIHQucGFzdGVIYW5kbGVycyA9IFtdLmNvbmNhdCh0Lm8ucGFzdGVIYW5kbGVycyk7XG5cbiAgICAgICAgLy8gQ2hlY2sgaWYgYnJvd3NlciBpcyBJRVxuICAgICAgICB0LmlzSUUgPSBuYXZpZ2F0b3IudXNlckFnZW50LmluZGV4T2YoJ01TSUUnKSAhPT0gLTEgfHwgbmF2aWdhdG9yLmFwcFZlcnNpb24uaW5kZXhPZignVHJpZGVudC8nKSAhPT0gLTE7XG5cbiAgICAgICAgLy8gQ2hlY2sgaWYgd2UgYXJlIG9uIG1hY09zXG4gICAgICAgIHQuaXNNYWMgPSBuYXZpZ2F0b3IucGxhdGZvcm0udG9VcHBlckNhc2UoKS5pbmRleE9mKCdNQUMnKSAhPT0gLTE7XG5cbiAgICAgICAgdC5pbml0KCk7XG4gICAgfTtcblxuICAgIFRydW1ib3d5Zy5wcm90b3R5cGUgPSB7XG4gICAgICAgIERFRkFVTFRfU0VNQU5USUNfTUFQOiB7XG4gICAgICAgICAgICAnYic6ICdzdHJvbmcnLFxuICAgICAgICAgICAgJ2knOiAnZW0nLFxuICAgICAgICAgICAgJ3MnOiAnZGVsJyxcbiAgICAgICAgICAgICdzdHJpa2UnOiAnZGVsJyxcbiAgICAgICAgICAgICdkaXYnOiAncCdcbiAgICAgICAgfSxcblxuICAgICAgICBpbml0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgdCA9IHRoaXM7XG4gICAgICAgICAgICB0LmhlaWdodCA9IHQuJHRhLmhlaWdodCgpO1xuXG4gICAgICAgICAgICB0LmluaXRQbHVnaW5zKCk7XG5cbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgLy8gRGlzYWJsZSBpbWFnZSByZXNpemUsIHRyeS1jYXRjaCBmb3Igb2xkIElFXG4gICAgICAgICAgICAgICAgdC5kb2MuZXhlY0NvbW1hbmQoJ2VuYWJsZU9iamVjdFJlc2l6aW5nJywgZmFsc2UsIGZhbHNlKTtcbiAgICAgICAgICAgICAgICB0LmRvYy5leGVjQ29tbWFuZCgnZGVmYXVsdFBhcmFncmFwaFNlcGFyYXRvcicsIGZhbHNlLCAncCcpO1xuICAgICAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0LmJ1aWxkRWRpdG9yKCk7XG4gICAgICAgICAgICB0LmJ1aWxkQnRuUGFuZSgpO1xuXG4gICAgICAgICAgICB0LmZpeGVkQnRuUGFuZUV2ZW50cygpO1xuXG4gICAgICAgICAgICB0LmJ1aWxkT3ZlcmxheSgpO1xuXG4gICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBpZiAodC5kaXNhYmxlZCkge1xuICAgICAgICAgICAgICAgICAgICB0LnNldERpc2FibGVkKHRydWUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0LiRjLnRyaWdnZXIoJ3Rid2luaXQnKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9LFxuXG4gICAgICAgIGFkZEJ0bkRlZjogZnVuY3Rpb24gKGJ0bk5hbWUsIGJ0bkRlZikge1xuICAgICAgICAgICAgdGhpcy5idG5zRGVmW2J0bk5hbWVdID0gJC5leHRlbmQoYnRuRGVmLCB0aGlzLmJ0bnNEZWZbYnRuTmFtZV0gfHwge30pO1xuICAgICAgICB9LFxuXG4gICAgICAgIHNldHVwVXJsUHJlZml4OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgcHJvdG9jb2wgPSB0aGlzLm8udXJsUHJvdG9jb2w7XG4gICAgICAgICAgICBpZiAoIXByb3RvY29sKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAodHlwZW9mIChwcm90b2NvbCkgIT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuICdodHRwczovLyc7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gcHJvdG9jb2wucmVwbGFjZSgnOi8vJywgJycpICsgJzovLyc7XG4gICAgICAgIH0sXG5cbiAgICAgICAgYnVpbGRFZGl0b3I6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciB0ID0gdGhpcyxcbiAgICAgICAgICAgICAgICBwcmVmaXggPSB0Lm8ucHJlZml4LFxuICAgICAgICAgICAgICAgIGh0bWwgPSAnJztcblxuICAgICAgICAgICAgdC4kYm94ID0gJCgnPGRpdi8+Jywge1xuICAgICAgICAgICAgICAgIGNsYXNzOiBwcmVmaXggKyAnYm94ICcgKyBwcmVmaXggKyAnZWRpdG9yLXZpc2libGUgJyArIHByZWZpeCArIHQuby5sYW5nICsgJyB0cnVtYm93eWcnXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgLy8gJHRhID0gVGV4dGFyZWFcbiAgICAgICAgICAgIC8vICRlZCA9IEVkaXRvclxuICAgICAgICAgICAgdC5pc1RleHRhcmVhID0gdC4kdGEuaXMoJ3RleHRhcmVhJyk7XG4gICAgICAgICAgICBpZiAodC5pc1RleHRhcmVhKSB7XG4gICAgICAgICAgICAgICAgaHRtbCA9IHQuJHRhLnZhbCgpO1xuICAgICAgICAgICAgICAgIHQuJGVkID0gJCgnPGRpdi8+Jyk7XG4gICAgICAgICAgICAgICAgdC4kYm94XG4gICAgICAgICAgICAgICAgICAgIC5pbnNlcnRBZnRlcih0LiR0YSlcbiAgICAgICAgICAgICAgICAgICAgLmFwcGVuZCh0LiRlZCwgdC4kdGEpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0LiRlZCA9IHQuJHRhO1xuICAgICAgICAgICAgICAgIGh0bWwgPSB0LiRlZC5odG1sKCk7XG5cbiAgICAgICAgICAgICAgICB0LiR0YSA9ICQoJzx0ZXh0YXJlYS8+Jywge1xuICAgICAgICAgICAgICAgICAgICBuYW1lOiB0LiR0YS5hdHRyKCdpZCcpLFxuICAgICAgICAgICAgICAgICAgICBoZWlnaHQ6IHQuaGVpZ2h0XG4gICAgICAgICAgICAgICAgfSkudmFsKGh0bWwpO1xuXG4gICAgICAgICAgICAgICAgdC4kYm94XG4gICAgICAgICAgICAgICAgICAgIC5pbnNlcnRBZnRlcih0LiRlZClcbiAgICAgICAgICAgICAgICAgICAgLmFwcGVuZCh0LiR0YSwgdC4kZWQpO1xuICAgICAgICAgICAgICAgIHQuc3luY0NvZGUoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdC4kdGFcbiAgICAgICAgICAgICAgICAuYWRkQ2xhc3MocHJlZml4ICsgJ3RleHRhcmVhJylcbiAgICAgICAgICAgICAgICAuYXR0cigndGFiaW5kZXgnLCAtMSlcbiAgICAgICAgICAgIDtcblxuICAgICAgICAgICAgdC4kZWRcbiAgICAgICAgICAgICAgICAuYWRkQ2xhc3MocHJlZml4ICsgJ2VkaXRvcicpXG4gICAgICAgICAgICAgICAgLmF0dHIoe1xuICAgICAgICAgICAgICAgICAgICBjb250ZW50ZWRpdGFibGU6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIGRpcjogdC5sYW5nLl9kaXIgfHwgJ2x0cidcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIC5odG1sKGh0bWwpXG4gICAgICAgICAgICA7XG5cbiAgICAgICAgICAgIGlmICh0Lm8udGFiaW5kZXgpIHtcbiAgICAgICAgICAgICAgICB0LiRlZC5hdHRyKCd0YWJpbmRleCcsIHQuby50YWJpbmRleCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmICh0LiRjLmlzKCdbcGxhY2Vob2xkZXJdJykpIHtcbiAgICAgICAgICAgICAgICB0LiRlZC5hdHRyKCdwbGFjZWhvbGRlcicsIHQuJGMuYXR0cigncGxhY2Vob2xkZXInKSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmICh0LiRjLmlzKCdbc3BlbGxjaGVja10nKSkge1xuICAgICAgICAgICAgICAgIHQuJGVkLmF0dHIoJ3NwZWxsY2hlY2snLCB0LiRjLmF0dHIoJ3NwZWxsY2hlY2snKSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmICh0Lm8ucmVzZXRDc3MpIHtcbiAgICAgICAgICAgICAgICB0LiRlZC5hZGRDbGFzcyhwcmVmaXggKyAncmVzZXQtY3NzJyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmICghdC5vLmF1dG9ncm93KSB7XG4gICAgICAgICAgICAgICAgdC4kdGEuYWRkKHQuJGVkKS5jc3Moe1xuICAgICAgICAgICAgICAgICAgICBoZWlnaHQ6IHQuaGVpZ2h0XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHQuc2VtYW50aWNDb2RlKCk7XG5cbiAgICAgICAgICAgIGlmICh0Lm8uYXV0b2dyb3dPbkVudGVyKSB7XG4gICAgICAgICAgICAgICAgdC4kZWQuYWRkQ2xhc3MocHJlZml4ICsgJ2F1dG9ncm93LW9uLWVudGVyJyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciBjdHJsID0gZmFsc2UsXG4gICAgICAgICAgICAgICAgY29tcG9zaXRpb24gPSBmYWxzZSxcbiAgICAgICAgICAgICAgICBkZWJvdW5jZUJ1dHRvblBhbmVTdGF0dXM7XG5cbiAgICAgICAgICAgIHQuJGVkXG4gICAgICAgICAgICAgICAgLm9uKCdkYmxjbGljaycsICdpbWcnLCB0Lm8uaW1nRGJsQ2xpY2tIYW5kbGVyKVxuICAgICAgICAgICAgICAgIC5vbigna2V5ZG93bicsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIGFwcGVuZCBmbGFncyB0byBkaWZmZXJlbnRpYXRlIENocm9tZSBzcGFuc1xuICAgICAgICAgICAgICAgICAgICB2YXIga2V5Q29kZSA9IGUud2hpY2g7XG4gICAgICAgICAgICAgICAgICAgIGlmIChrZXlDb2RlID09PSA4IHx8IGtleUNvZGUgPT09IDEzIHx8IGtleUNvZGUgPT09IDQ2KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0LnRvZ2dsZVNwYW4odHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKChlLmN0cmxLZXkgfHwgZS5tZXRhS2V5KSAmJiAhZS5hbHRLZXkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGN0cmwgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGtleSA9IHQua2V5c1tTdHJpbmcuZnJvbUNoYXJDb2RlKGUud2hpY2gpLnRvVXBwZXJDYXNlKCldO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQuZXhlY0NtZChrZXkuZm4sIGtleS5wYXJhbSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoYykge1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHQuby50YWJUb0luZGVudCAmJiBlLmtleSA9PT0gJ1RhYicpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZS5zaGlmdEtleSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdC5leGVjQ21kKCdvdXRkZW50JywgdHJ1ZSwgbnVsbCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0LmV4ZWNDbWQoJ2luZGVudCcsIHRydWUsIG51bGwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChjKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAub24oJ2NvbXBvc2l0aW9uc3RhcnQgY29tcG9zaXRpb251cGRhdGUnLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbXBvc2l0aW9uID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIC5vbigna2V5dXAgY29tcG9zaXRpb25lbmQnLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoZS50eXBlID09PSAnY29tcG9zaXRpb25lbmQnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb21wb3NpdGlvbiA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGNvbXBvc2l0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICB2YXIga2V5Q29kZSA9IGUud2hpY2g7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKGtleUNvZGUgPj0gMzcgJiYga2V5Q29kZSA8PSA0MCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gcmVtb3ZlIENocm9tZSBnZW5lcmF0ZWQgc3BhbiB0YWdzXG4gICAgICAgICAgICAgICAgICAgIGlmIChrZXlDb2RlID09PSA4IHx8IGtleUNvZGUgPT09IDEzIHx8IGtleUNvZGUgPT09IDQ2KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0LnRvZ2dsZVNwYW4oKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIGlmICgoZS5jdHJsS2V5IHx8IGUubWV0YUtleSkgJiYgKGtleUNvZGUgPT09IDg5IHx8IGtleUNvZGUgPT09IDkwKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdC5zZW1hbnRpY0NvZGUoZmFsc2UsIHRydWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdC4kYy50cmlnZ2VyKCd0YndjaGFuZ2UnKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICghY3RybCAmJiBrZXlDb2RlICE9PSAxNykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNvbXBvc2l0aW9uRW5kSUUgPSB0LmlzSUUgPyBlLnR5cGUgPT09ICdjb21wb3NpdGlvbmVuZCcgOiB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgdC5zZW1hbnRpY0NvZGUoZmFsc2UsIGNvbXBvc2l0aW9uRW5kSUUgJiYga2V5Q29kZSA9PT0gMTMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdC4kYy50cmlnZ2VyKCd0YndjaGFuZ2UnKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0eXBlb2YgZS53aGljaCA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHQuc2VtYW50aWNDb2RlKGZhbHNlLCBmYWxzZSwgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGN0cmwgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgfSwgNTApO1xuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgLm9uKCdtb3VzZXVwIGtleWRvd24ga2V5dXAnLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoKCFlLmN0cmxLZXkgJiYgIWUubWV0YUtleSkgfHwgZS5hbHRLZXkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgeyAvLyBcImhvbGQgb25cIiB0byB0aGUgY3RybCBrZXkgZm9yIDUwbXNcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdHJsID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICB9LCA1MCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgY2xlYXJUaW1lb3V0KGRlYm91bmNlQnV0dG9uUGFuZVN0YXR1cyk7XG4gICAgICAgICAgICAgICAgICAgIGRlYm91bmNlQnV0dG9uUGFuZVN0YXR1cyA9IHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdC51cGRhdGVCdXR0b25QYW5lU3RhdHVzKCk7XG4gICAgICAgICAgICAgICAgICAgIH0sIDUwKTtcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIC5vbignZm9jdXMgYmx1cicsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChlLnR5cGUgPT09ICdibHVyJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdC5jbGVhckJ1dHRvblBhbmVTdGF0dXMoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB0LiRjLnRyaWdnZXIoJ3RidycgKyBlLnR5cGUpO1xuICAgICAgICAgICAgICAgICAgICBpZiAodC5vLmF1dG9ncm93T25FbnRlcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHQuYXV0b2dyb3dPbkVudGVyRG9udENsb3NlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGUudHlwZSA9PT0gJ2ZvY3VzJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQuYXV0b2dyb3dPbkVudGVyV2FzRm9jdXNlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdC5hdXRvZ3Jvd0VkaXRvck9uRW50ZXIoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoIXQuby5hdXRvZ3Jvdykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQuJGVkLmNzcyh7aGVpZ2h0OiB0LiRlZC5jc3MoJ21pbi1oZWlnaHQnKX0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQuJGMudHJpZ2dlcigndGJ3cmVzaXplJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIC5vbigna2V5dXAgZm9jdXMnLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICBpZiAoIXQuJHRhLnZhbCgpLm1hdGNoKC88Lio+LykgJiYgIXQuJGVkLmh0bWwoKS5tYXRjaCgvPC4qPi8pKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYmxvY2sgPSB0LmlzSUUgPyAnPHA+JyA6ICdwJztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0LmRvYy5leGVjQ29tbWFuZCgnZm9ybWF0QmxvY2snLCBmYWxzZSwgYmxvY2spO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQuc3luY0NvZGUoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sIDApO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAub24oJ2N1dCBkcm9wJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHQuc2VtYW50aWNDb2RlKGZhbHNlLCB0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHQuJGMudHJpZ2dlcigndGJ3Y2hhbmdlJyk7XG4gICAgICAgICAgICAgICAgICAgIH0sIDApO1xuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgLm9uKCdwYXN0ZScsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0Lm8ucmVtb3ZlZm9ybWF0UGFzdGVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh3aW5kb3cuZ2V0U2VsZWN0aW9uICYmIHdpbmRvdy5nZXRTZWxlY3Rpb24oKS5kZWxldGVGcm9tRG9jdW1lbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cuZ2V0U2VsZWN0aW9uKCkuZGVsZXRlRnJvbURvY3VtZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gSUVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGV4dCA9IHdpbmRvdy5jbGlwYm9hcmREYXRhLmdldERhdGEoJ1RleHQnKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIDw9IElFMTBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdC5kb2Muc2VsZWN0aW9uLmNyZWF0ZVJhbmdlKCkucGFzdGVIVE1MKHRleHQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gSUUgMTFcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdC5kb2MuZ2V0U2VsZWN0aW9uKCkuZ2V0UmFuZ2VBdCgwKS5pbnNlcnROb2RlKHQuZG9jLmNyZWF0ZVRleHROb2RlKHRleHQpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdC4kYy50cmlnZ2VyKCd0YndjaGFuZ2UnLCBlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBOb3QgSUVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0LmV4ZWNDbWQoJ2luc2VydFRleHQnLCAoZS5vcmlnaW5hbEV2ZW50IHx8IGUpLmNsaXBib2FyZERhdGEuZ2V0RGF0YSgndGV4dC9wbGFpbicpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIC8vIENhbGwgcGFzdGVIYW5kbGVyc1xuICAgICAgICAgICAgICAgICAgICAkLmVhY2godC5wYXN0ZUhhbmRsZXJzLCBmdW5jdGlvbiAoaSwgcGFzdGVIYW5kbGVyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwYXN0ZUhhbmRsZXIoZSk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdC5zZW1hbnRpY0NvZGUoZmFsc2UsIHRydWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdC4kYy50cmlnZ2VyKCd0YndwYXN0ZScsIGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdC4kYy50cmlnZ2VyKCd0YndjaGFuZ2UnKTtcbiAgICAgICAgICAgICAgICAgICAgfSwgMCk7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIHQuJHRhXG4gICAgICAgICAgICAgICAgLm9uKCdrZXl1cCcsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgdC4kYy50cmlnZ2VyKCd0YndjaGFuZ2UnKTtcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIC5vbigncGFzdGUnLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdC4kYy50cmlnZ2VyKCd0YndjaGFuZ2UnKTtcbiAgICAgICAgICAgICAgICAgICAgfSwgMCk7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICQodC5kb2MuYm9keSkub24oJ2tleWRvd24uJyArIHQuZXZlbnROYW1lc3BhY2UsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICAgICAgaWYgKGUud2hpY2ggPT09IDI3ICYmICQoJy4nICsgcHJlZml4ICsgJ21vZGFsLWJveCcpLmxlbmd0aCA+PSAxKSB7XG4gICAgICAgICAgICAgICAgICAgIHQuY2xvc2VNb2RhbCgpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLy9hdXRvZ3JvdyB3aGVuIGVudGVyaW5nIGxvZ2ljXG4gICAgICAgIGF1dG9ncm93RWRpdG9yT25FbnRlcjogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIHQgPSB0aGlzO1xuICAgICAgICAgICAgdC4kZWQucmVtb3ZlQ2xhc3MoJ2F1dG9ncm93LW9uLWVudGVyJyk7XG4gICAgICAgICAgICB2YXIgb2xkSGVpZ2h0ID0gdC4kZWRbMF0uY2xpZW50SGVpZ2h0O1xuICAgICAgICAgICAgdC4kZWQuaGVpZ2h0KCdhdXRvJyk7XG4gICAgICAgICAgICB2YXIgdG90YWxIZWlnaHQgPSB0LiRlZFswXS5zY3JvbGxIZWlnaHQ7XG4gICAgICAgICAgICB0LiRlZC5hZGRDbGFzcygnYXV0b2dyb3ctb24tZW50ZXInKTtcbiAgICAgICAgICAgIGlmIChvbGRIZWlnaHQgIT09IHRvdGFsSGVpZ2h0KSB7XG4gICAgICAgICAgICAgICAgdC4kZWQuaGVpZ2h0KG9sZEhlaWdodCk7XG4gICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIHQuJGVkLmNzcyh7aGVpZ2h0OiB0b3RhbEhlaWdodH0pO1xuICAgICAgICAgICAgICAgICAgICB0LiRjLnRyaWdnZXIoJ3Rid3Jlc2l6ZScpO1xuICAgICAgICAgICAgICAgIH0sIDApO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuXG5cbiAgICAgICAgLy8gQnVpbGQgYnV0dG9uIHBhbmUsIHVzZSBvLmJ0bnMgb3B0aW9uXG4gICAgICAgIGJ1aWxkQnRuUGFuZTogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIHQgPSB0aGlzLFxuICAgICAgICAgICAgICAgIHByZWZpeCA9IHQuby5wcmVmaXg7XG5cbiAgICAgICAgICAgIHZhciAkYnRuUGFuZSA9IHQuJGJ0blBhbmUgPSAkKCc8ZGl2Lz4nLCB7XG4gICAgICAgICAgICAgICAgY2xhc3M6IHByZWZpeCArICdidXR0b24tcGFuZSdcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAkLmVhY2godC5vLmJ0bnMsIGZ1bmN0aW9uIChpLCBidG5HcnApIHtcbiAgICAgICAgICAgICAgICBpZiAoISQuaXNBcnJheShidG5HcnApKSB7XG4gICAgICAgICAgICAgICAgICAgIGJ0bkdycCA9IFtidG5HcnBdO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHZhciAkYnRuR3JvdXAgPSAkKCc8ZGl2Lz4nLCB7XG4gICAgICAgICAgICAgICAgICAgIGNsYXNzOiBwcmVmaXggKyAnYnV0dG9uLWdyb3VwICcgKyAoKGJ0bkdycC5pbmRleE9mKCdmdWxsc2NyZWVuJykgPj0gMCkgPyBwcmVmaXggKyAncmlnaHQnIDogJycpXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgJC5lYWNoKGJ0bkdycCwgZnVuY3Rpb24gKGksIGJ0bikge1xuICAgICAgICAgICAgICAgICAgICB0cnkgeyAvLyBQcmV2ZW50IGJ1aWxkQnRuIGVycm9yXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodC5pc1N1cHBvcnRlZEJ0bihidG4pKSB7IC8vIEl0J3MgYSBzdXBwb3J0ZWQgYnV0dG9uXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJGJ0bkdyb3VwLmFwcGVuZCh0LmJ1aWxkQnRuKGJ0bikpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChjKSB7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIGlmICgkYnRuR3JvdXAuaHRtbCgpLnRyaW0oKS5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgICRidG5QYW5lLmFwcGVuZCgkYnRuR3JvdXApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICB0LiRib3gucHJlcGVuZCgkYnRuUGFuZSk7XG4gICAgICAgIH0sXG5cblxuICAgICAgICAvLyBCdWlsZCBhIGJ1dHRvbiBhbmQgaGlzIGFjdGlvblxuICAgICAgICBidWlsZEJ0bjogZnVuY3Rpb24gKGJ0bk5hbWUpIHsgLy8gYnRuTmFtZSBpcyBuYW1lIG9mIHRoZSBidXR0b25cbiAgICAgICAgICAgIHZhciB0ID0gdGhpcyxcbiAgICAgICAgICAgICAgICBwcmVmaXggPSB0Lm8ucHJlZml4LFxuICAgICAgICAgICAgICAgIGJ0biA9IHQuYnRuc0RlZltidG5OYW1lXSxcbiAgICAgICAgICAgICAgICBpc0Ryb3Bkb3duID0gYnRuLmRyb3Bkb3duLFxuICAgICAgICAgICAgICAgIGhhc0ljb24gPSBidG4uaGFzSWNvbiAhPSBudWxsID8gYnRuLmhhc0ljb24gOiB0cnVlLFxuICAgICAgICAgICAgICAgIHRleHREZWYgPSB0LmxhbmdbYnRuTmFtZV0gfHwgYnRuTmFtZSxcblxuICAgICAgICAgICAgICAgICRidG4gPSAkKCc8YnV0dG9uLz4nLCB7XG4gICAgICAgICAgICAgICAgICAgIHR5cGU6ICdidXR0b24nLFxuICAgICAgICAgICAgICAgICAgICBjbGFzczogcHJlZml4ICsgYnRuTmFtZSArICctYnV0dG9uICcgKyAoYnRuLmNsYXNzIHx8ICcnKSArICghaGFzSWNvbiA/ICcgJyArIHByZWZpeCArICd0ZXh0dWFsLWJ1dHRvbicgOiAnJyksXG4gICAgICAgICAgICAgICAgICAgIGh0bWw6IHQuaGFzU3ZnICYmIGhhc0ljb24gP1xuICAgICAgICAgICAgICAgICAgICAgICAgJzxzdmc+PHVzZSB4bGluazpocmVmPVwiJyArIHQuc3ZnUGF0aCArICcjJyArIHByZWZpeCArIChidG4uaWNvIHx8IGJ0bk5hbWUpLnJlcGxhY2UoLyhbQS1aXSspL2csICctJDEnKS50b0xvd2VyQ2FzZSgpICsgJ1wiLz48L3N2Zz4nIDpcbiAgICAgICAgICAgICAgICAgICAgICAgIHQuaGlkZUJ1dHRvblRleHRzID8gJycgOiAoYnRuLnRleHQgfHwgYnRuLnRpdGxlIHx8IHQubGFuZ1tidG5OYW1lXSB8fCBidG5OYW1lKSxcbiAgICAgICAgICAgICAgICAgICAgdGl0bGU6IChidG4udGl0bGUgfHwgYnRuLnRleHQgfHwgdGV4dERlZikgKyAoYnRuLmtleSA/ICcgKCcgKyAodC5pc01hYyA/ICdDbWQnIDogJ0N0cmwnKSArICcgKyAnICsgYnRuLmtleSArICcpJyA6ICcnKSxcbiAgICAgICAgICAgICAgICAgICAgdGFiaW5kZXg6IC0xLFxuICAgICAgICAgICAgICAgICAgICBtb3VzZWRvd246IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghaXNEcm9wZG93biB8fCAkKCcuJyArIGJ0bk5hbWUgKyAnLScgKyBwcmVmaXggKyAnZHJvcGRvd24nLCB0LiRib3gpLmlzKCc6aGlkZGVuJykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKCdib2R5JywgdC5kb2MpLnRyaWdnZXIoJ21vdXNlZG93bicpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoKHQuJGJ0blBhbmUuaGFzQ2xhc3MocHJlZml4ICsgJ2Rpc2FibGUnKSB8fCB0LiRib3guaGFzQ2xhc3MocHJlZml4ICsgJ2Rpc2FibGVkJykpICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgISQodGhpcykuaGFzQ2xhc3MocHJlZml4ICsgJ2FjdGl2ZScpICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgISQodGhpcykuaGFzQ2xhc3MocHJlZml4ICsgJ25vdC1kaXNhYmxlJykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHQuZXhlY0NtZCgoaXNEcm9wZG93biA/ICdkcm9wZG93bicgOiBmYWxzZSkgfHwgYnRuLmZuIHx8IGJ0bk5hbWUsIGJ0bi5wYXJhbSB8fCBidG5OYW1lLCBidG4uZm9yY2VDc3MpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgaWYgKGlzRHJvcGRvd24pIHtcbiAgICAgICAgICAgICAgICAkYnRuLmFkZENsYXNzKHByZWZpeCArICdvcGVuLWRyb3Bkb3duJyk7XG4gICAgICAgICAgICAgICAgdmFyIGRyb3Bkb3duUHJlZml4ID0gcHJlZml4ICsgJ2Ryb3Bkb3duJyxcbiAgICAgICAgICAgICAgICAgICAgZHJvcGRvd25PcHRpb25zID0geyAvLyB0aGUgZHJvcGRvd25cbiAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzOiBkcm9wZG93blByZWZpeCArICctJyArIGJ0bk5hbWUgKyAnICcgKyBkcm9wZG93blByZWZpeCArICcgJyArIHByZWZpeCArICdmaXhlZC10b3AgJyArIChidG4uZHJvcGRvd25DbGFzcyB8fCAnJylcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICBkcm9wZG93bk9wdGlvbnNbJ2RhdGEtJyArIGRyb3Bkb3duUHJlZml4XSA9IGJ0bk5hbWU7XG4gICAgICAgICAgICAgICAgdmFyICRkcm9wZG93biA9ICQoJzxkaXYvPicsIGRyb3Bkb3duT3B0aW9ucyk7XG4gICAgICAgICAgICAgICAgJC5lYWNoKGlzRHJvcGRvd24sIGZ1bmN0aW9uIChpLCBkZWYpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHQuYnRuc0RlZltkZWZdICYmIHQuaXNTdXBwb3J0ZWRCdG4oZGVmKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgJGRyb3Bkb3duLmFwcGVuZCh0LmJ1aWxkU3ViQnRuKGRlZikpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgdC4kYm94LmFwcGVuZCgkZHJvcGRvd24uaGlkZSgpKTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoYnRuLmtleSkge1xuICAgICAgICAgICAgICAgIHQua2V5c1tidG4ua2V5XSA9IHtcbiAgICAgICAgICAgICAgICAgICAgZm46IGJ0bi5mbiB8fCBidG5OYW1lLFxuICAgICAgICAgICAgICAgICAgICBwYXJhbTogYnRuLnBhcmFtIHx8IGJ0bk5hbWVcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoIWlzRHJvcGRvd24pIHtcbiAgICAgICAgICAgICAgICB0LnRhZ1RvQnV0dG9uWyhidG4udGFnIHx8IGJ0bk5hbWUpLnRvTG93ZXJDYXNlKCldID0gYnRuTmFtZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuICRidG47XG4gICAgICAgIH0sXG4gICAgICAgIC8vIEJ1aWxkIGEgYnV0dG9uIGZvciBkcm9wZG93biBtZW51XG4gICAgICAgIC8vIEBwYXJhbSBuIDogbmFtZSBvZiB0aGUgc3ViYnV0dG9uXG4gICAgICAgIGJ1aWxkU3ViQnRuOiBmdW5jdGlvbiAoYnRuTmFtZSkge1xuICAgICAgICAgICAgdmFyIHQgPSB0aGlzLFxuICAgICAgICAgICAgICAgIHByZWZpeCA9IHQuby5wcmVmaXgsXG4gICAgICAgICAgICAgICAgYnRuID0gdC5idG5zRGVmW2J0bk5hbWVdLFxuICAgICAgICAgICAgICAgIGhhc0ljb24gPSBidG4uaGFzSWNvbiAhPSBudWxsID8gYnRuLmhhc0ljb24gOiB0cnVlO1xuXG4gICAgICAgICAgICBpZiAoYnRuLmtleSkge1xuICAgICAgICAgICAgICAgIHQua2V5c1tidG4ua2V5XSA9IHtcbiAgICAgICAgICAgICAgICAgICAgZm46IGJ0bi5mbiB8fCBidG5OYW1lLFxuICAgICAgICAgICAgICAgICAgICBwYXJhbTogYnRuLnBhcmFtIHx8IGJ0bk5hbWVcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0LnRhZ1RvQnV0dG9uWyhidG4udGFnIHx8IGJ0bk5hbWUpLnRvTG93ZXJDYXNlKCldID0gYnRuTmFtZTtcblxuICAgICAgICAgICAgcmV0dXJuICQoJzxidXR0b24vPicsIHtcbiAgICAgICAgICAgICAgICB0eXBlOiAnYnV0dG9uJyxcbiAgICAgICAgICAgICAgICBjbGFzczogcHJlZml4ICsgYnRuTmFtZSArICctZHJvcGRvd24tYnV0dG9uICcgKyAoYnRuLmNsYXNzIHx8ICcnKSArIChidG4uaWNvID8gJyAnICsgcHJlZml4ICsgYnRuLmljbyArICctYnV0dG9uJyA6ICcnKSxcbiAgICAgICAgICAgICAgICBodG1sOiB0Lmhhc1N2ZyAmJiBoYXNJY29uID9cbiAgICAgICAgICAgICAgICAgICAgJzxzdmc+PHVzZSB4bGluazpocmVmPVwiJyArIHQuc3ZnUGF0aCArICcjJyArIHByZWZpeCArIChidG4uaWNvIHx8IGJ0bk5hbWUpLnJlcGxhY2UoLyhbQS1aXSspL2csICctJDEnKS50b0xvd2VyQ2FzZSgpICsgJ1wiLz48L3N2Zz4nICsgKGJ0bi50ZXh0IHx8IGJ0bi50aXRsZSB8fCB0LmxhbmdbYnRuTmFtZV0gfHwgYnRuTmFtZSkgOlxuICAgICAgICAgICAgICAgICAgICAoYnRuLnRleHQgfHwgYnRuLnRpdGxlIHx8IHQubGFuZ1tidG5OYW1lXSB8fCBidG5OYW1lKSxcbiAgICAgICAgICAgICAgICB0aXRsZTogKGJ0bi5rZXkgPyAnKCcgKyAodC5pc01hYyA/ICdDbWQnIDogJ0N0cmwnKSArICcgKyAnICsgYnRuLmtleSArICcpJyA6IG51bGwpLFxuICAgICAgICAgICAgICAgIHN0eWxlOiBidG4uc3R5bGUgfHwgbnVsbCxcbiAgICAgICAgICAgICAgICBtb3VzZWRvd246IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgJCgnYm9keScsIHQuZG9jKS50cmlnZ2VyKCdtb3VzZWRvd24nKTtcblxuICAgICAgICAgICAgICAgICAgICB0LmV4ZWNDbWQoYnRuLmZuIHx8IGJ0bk5hbWUsIGJ0bi5wYXJhbSB8fCBidG5OYW1lLCBidG4uZm9yY2VDc3MpO1xuXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSxcbiAgICAgICAgLy8gQ2hlY2sgaWYgYnV0dG9uIGlzIHN1cHBvcnRlZFxuICAgICAgICBpc1N1cHBvcnRlZEJ0bjogZnVuY3Rpb24gKGJ0bk5hbWUpIHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuYnRuc0RlZltidG5OYW1lXS5pc1N1cHBvcnRlZCgpO1xuICAgICAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLy8gQnVpbGQgb3ZlcmxheSBmb3IgbW9kYWwgYm94XG4gICAgICAgIGJ1aWxkT3ZlcmxheTogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIHQgPSB0aGlzO1xuICAgICAgICAgICAgdC4kb3ZlcmxheSA9ICQoJzxkaXYvPicsIHtcbiAgICAgICAgICAgICAgICBjbGFzczogdC5vLnByZWZpeCArICdvdmVybGF5J1xuICAgICAgICAgICAgfSkuYXBwZW5kVG8odC4kYm94KTtcbiAgICAgICAgICAgIHJldHVybiB0LiRvdmVybGF5O1xuICAgICAgICB9LFxuICAgICAgICBzaG93T3ZlcmxheTogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIHQgPSB0aGlzO1xuICAgICAgICAgICAgJCh3aW5kb3cpLnRyaWdnZXIoJ3Njcm9sbCcpO1xuICAgICAgICAgICAgdC4kb3ZlcmxheS5mYWRlSW4oMjAwKTtcbiAgICAgICAgICAgIHQuJGJveC5hZGRDbGFzcyh0Lm8ucHJlZml4ICsgJ2JveC1ibHVyJyk7XG4gICAgICAgIH0sXG4gICAgICAgIGhpZGVPdmVybGF5OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgdCA9IHRoaXM7XG4gICAgICAgICAgICB0LiRvdmVybGF5LmZhZGVPdXQoNTApO1xuICAgICAgICAgICAgdC4kYm94LnJlbW92ZUNsYXNzKHQuby5wcmVmaXggKyAnYm94LWJsdXInKTtcbiAgICAgICAgfSxcblxuICAgICAgICAvLyBNYW5hZ2VtZW50IG9mIGZpeGVkIGJ1dHRvbiBwYW5lXG4gICAgICAgIGZpeGVkQnRuUGFuZUV2ZW50czogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIHQgPSB0aGlzLFxuICAgICAgICAgICAgICAgIGZpeGVkRnVsbFdpZHRoID0gdC5vLmZpeGVkRnVsbFdpZHRoLFxuICAgICAgICAgICAgICAgICRib3ggPSB0LiRib3g7XG5cbiAgICAgICAgICAgIGlmICghdC5vLmZpeGVkQnRuUGFuZSkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdC5pc0ZpeGVkID0gZmFsc2U7XG5cbiAgICAgICAgICAgICQod2luZG93KVxuICAgICAgICAgICAgICAgIC5vbignc2Nyb2xsLicgKyB0LmV2ZW50TmFtZXNwYWNlICsgJyByZXNpemUuJyArIHQuZXZlbnROYW1lc3BhY2UsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCEkYm94KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICB0LnN5bmNDb2RlKCk7XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIHNjcm9sbFRvcCA9ICQod2luZG93KS5zY3JvbGxUb3AoKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIG9mZnNldCA9ICRib3gub2Zmc2V0KCkudG9wICsgMSxcbiAgICAgICAgICAgICAgICAgICAgICAgICRidXR0b25QYW5lID0gdC4kYnRuUGFuZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGJ1dHRvblBhbmVPdXRlckhlaWdodCA9ICRidXR0b25QYW5lLm91dGVySGVpZ2h0KCkgLSAyO1xuXG4gICAgICAgICAgICAgICAgICAgIGlmICgoc2Nyb2xsVG9wIC0gb2Zmc2V0ID4gMCkgJiYgKChzY3JvbGxUb3AgLSBvZmZzZXQgLSB0LmhlaWdodCkgPCAwKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCF0LmlzRml4ZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0LmlzRml4ZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRidXR0b25QYW5lLmNzcyh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiAnZml4ZWQnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3A6IDAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxlZnQ6IGZpeGVkRnVsbFdpZHRoID8gMCA6ICdhdXRvJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgekluZGV4OiA3XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdC4kYm94LmNzcyh7cGFkZGluZ1RvcDogJGJ1dHRvblBhbmUuaGVpZ2h0KCl9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICRidXR0b25QYW5lLmNzcyh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGg6IGZpeGVkRnVsbFdpZHRoID8gJzEwMCUnIDogKCgkYm94LndpZHRoKCkgLSAxKSlcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAkKCcuJyArIHQuby5wcmVmaXggKyAnZml4ZWQtdG9wJywgJGJveCkuY3NzKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogZml4ZWRGdWxsV2lkdGggPyAnZml4ZWQnIDogJ2Fic29sdXRlJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3A6IGZpeGVkRnVsbFdpZHRoID8gYnV0dG9uUGFuZU91dGVySGVpZ2h0IDogYnV0dG9uUGFuZU91dGVySGVpZ2h0ICsgKHNjcm9sbFRvcCAtIG9mZnNldCksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgekluZGV4OiAxNVxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodC5pc0ZpeGVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0LmlzRml4ZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICRidXR0b25QYW5lLnJlbW92ZUF0dHIoJ3N0eWxlJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0LiRib3guY3NzKHtwYWRkaW5nVG9wOiAwfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAkKCcuJyArIHQuby5wcmVmaXggKyAnZml4ZWQtdG9wJywgJGJveCkuY3NzKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogJ2Fic29sdXRlJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3A6IGJ1dHRvblBhbmVPdXRlckhlaWdodFxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgfSxcblxuICAgICAgICAvLyBEaXNhYmxlIGVkaXRvclxuICAgICAgICBzZXREaXNhYmxlZDogZnVuY3Rpb24gKGRpc2FibGUpIHtcbiAgICAgICAgICAgIHZhciB0ID0gdGhpcyxcbiAgICAgICAgICAgICAgICBwcmVmaXggPSB0Lm8ucHJlZml4O1xuXG4gICAgICAgICAgICB0LmRpc2FibGVkID0gZGlzYWJsZTtcblxuICAgICAgICAgICAgaWYgKGRpc2FibGUpIHtcbiAgICAgICAgICAgICAgICB0LiR0YS5hdHRyKCdkaXNhYmxlZCcsIHRydWUpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0LiR0YS5yZW1vdmVBdHRyKCdkaXNhYmxlZCcpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdC4kYm94LnRvZ2dsZUNsYXNzKHByZWZpeCArICdkaXNhYmxlZCcsIGRpc2FibGUpO1xuICAgICAgICAgICAgdC4kZWQuYXR0cignY29udGVudGVkaXRhYmxlJywgIWRpc2FibGUpO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8vIERlc3Ryb3kgdGhlIGVkaXRvclxuICAgICAgICBkZXN0cm95OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgdCA9IHRoaXMsXG4gICAgICAgICAgICAgICAgcHJlZml4ID0gdC5vLnByZWZpeDtcblxuICAgICAgICAgICAgaWYgKHQuaXNUZXh0YXJlYSkge1xuICAgICAgICAgICAgICAgIHQuJGJveC5hZnRlcihcbiAgICAgICAgICAgICAgICAgICAgdC4kdGFcbiAgICAgICAgICAgICAgICAgICAgICAgIC5jc3Moe2hlaWdodDogJyd9KVxuICAgICAgICAgICAgICAgICAgICAgICAgLnZhbCh0Lmh0bWwoKSlcbiAgICAgICAgICAgICAgICAgICAgICAgIC5yZW1vdmVDbGFzcyhwcmVmaXggKyAndGV4dGFyZWEnKVxuICAgICAgICAgICAgICAgICAgICAgICAgLnNob3coKVxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHQuJGJveC5hZnRlcihcbiAgICAgICAgICAgICAgICAgICAgdC4kZWRcbiAgICAgICAgICAgICAgICAgICAgICAgIC5jc3Moe2hlaWdodDogJyd9KVxuICAgICAgICAgICAgICAgICAgICAgICAgLnJlbW92ZUNsYXNzKHByZWZpeCArICdlZGl0b3InKVxuICAgICAgICAgICAgICAgICAgICAgICAgLnJlbW92ZUF0dHIoJ2NvbnRlbnRlZGl0YWJsZScpXG4gICAgICAgICAgICAgICAgICAgICAgICAucmVtb3ZlQXR0cignZGlyJylcbiAgICAgICAgICAgICAgICAgICAgICAgIC5odG1sKHQuaHRtbCgpKVxuICAgICAgICAgICAgICAgICAgICAgICAgLnNob3coKVxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHQuJGVkLm9mZignZGJsY2xpY2snLCAnaW1nJyk7XG5cbiAgICAgICAgICAgIHQuZGVzdHJveVBsdWdpbnMoKTtcblxuICAgICAgICAgICAgdC4kYm94LnJlbW92ZSgpO1xuICAgICAgICAgICAgdC4kYy5yZW1vdmVEYXRhKCd0cnVtYm93eWcnKTtcbiAgICAgICAgICAgICQoJ2JvZHknKS5yZW1vdmVDbGFzcyhwcmVmaXggKyAnYm9keS1mdWxsc2NyZWVuJyk7XG4gICAgICAgICAgICB0LiRjLnRyaWdnZXIoJ3Rid2Nsb3NlJyk7XG4gICAgICAgICAgICAkKHdpbmRvdykub2ZmKCdzY3JvbGwuJyArIHQuZXZlbnROYW1lc3BhY2UgKyAnIHJlc2l6ZS4nICsgdC5ldmVudE5hbWVzcGFjZSk7XG4gICAgICAgICAgICAkKHQuZG9jLmJvZHkpLm9mZigna2V5ZG93bi4nICsgdC5ldmVudE5hbWVzcGFjZSk7XG4gICAgICAgIH0sXG5cblxuICAgICAgICAvLyBFbXB0eSB0aGUgZWRpdG9yXG4gICAgICAgIGVtcHR5OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB0aGlzLiR0YS52YWwoJycpO1xuICAgICAgICAgICAgdGhpcy5zeW5jQ29kZSh0cnVlKTtcbiAgICAgICAgfSxcblxuXG4gICAgICAgIC8vIEZ1bmN0aW9uIGNhbGwgd2hlbiBjbGljayBvbiB2aWV3SFRNTCBidXR0b25cbiAgICAgICAgdG9nZ2xlOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgdCA9IHRoaXMsXG4gICAgICAgICAgICAgICAgcHJlZml4ID0gdC5vLnByZWZpeDtcblxuICAgICAgICAgICAgaWYgKHQuby5hdXRvZ3Jvd09uRW50ZXIpIHtcbiAgICAgICAgICAgICAgICB0LmF1dG9ncm93T25FbnRlckRvbnRDbG9zZSA9ICF0LiRib3guaGFzQ2xhc3MocHJlZml4ICsgJ2VkaXRvci1oaWRkZW4nKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdC5zZW1hbnRpY0NvZGUoZmFsc2UsIHRydWUpO1xuICAgICAgICAgICAgdC4kYy50cmlnZ2VyKCd0YndjaGFuZ2UnKTtcblxuICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgdC5kb2MuYWN0aXZlRWxlbWVudC5ibHVyKCk7XG4gICAgICAgICAgICAgICAgdC4kYm94LnRvZ2dsZUNsYXNzKHByZWZpeCArICdlZGl0b3ItaGlkZGVuICcgKyBwcmVmaXggKyAnZWRpdG9yLXZpc2libGUnKTtcbiAgICAgICAgICAgICAgICB0LiRidG5QYW5lLnRvZ2dsZUNsYXNzKHByZWZpeCArICdkaXNhYmxlJyk7XG4gICAgICAgICAgICAgICAgJCgnLicgKyBwcmVmaXggKyAndmlld0hUTUwtYnV0dG9uJywgdC4kYnRuUGFuZSkudG9nZ2xlQ2xhc3MocHJlZml4ICsgJ2FjdGl2ZScpO1xuICAgICAgICAgICAgICAgIGlmICh0LiRib3guaGFzQ2xhc3MocHJlZml4ICsgJ2VkaXRvci12aXNpYmxlJykpIHtcbiAgICAgICAgICAgICAgICAgICAgdC4kdGEuYXR0cigndGFiaW5kZXgnLCAtMSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdC4kdGEucmVtb3ZlQXR0cigndGFiaW5kZXgnKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAodC5vLmF1dG9ncm93T25FbnRlciAmJiAhdC5hdXRvZ3Jvd09uRW50ZXJEb250Q2xvc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgdC5hdXRvZ3Jvd0VkaXRvck9uRW50ZXIoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCAwKTtcbiAgICAgICAgfSxcblxuICAgICAgICAvLyBSZW1vdmUgb3IgYWRkIGZsYWdzIHRvIHNwYW4gdGFncyB0byByZW1vdmUgQ2hyb21lIGdlbmVyYXRlZCBzcGFuc1xuICAgICAgICB0b2dnbGVTcGFuOiBmdW5jdGlvbiAoYWRkRmxhZykge1xuICAgICAgICAgICAgdmFyIHQgPSB0aGlzO1xuICAgICAgICAgICAgdC4kZWQuZmluZCgnc3BhbicpLmVhY2goZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGlmIChhZGRGbGFnID09PSB0cnVlKSB7XG4gICAgICAgICAgICAgICAgICAgICQodGhpcykuYXR0cignZGF0YS10YnctZmxhZycsIHRydWUpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICgkKHRoaXMpLmF0dHIoJ2RhdGEtdGJ3LWZsYWcnKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgJCh0aGlzKS5yZW1vdmVBdHRyKCdkYXRhLXRidy1mbGFnJyk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAkKHRoaXMpLmNvbnRlbnRzKCkudW53cmFwKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSxcblxuICAgICAgICAvLyBPcGVuIGRyb3Bkb3duIHdoZW4gY2xpY2sgb24gYSBidXR0b24gd2hpY2ggb3BlbiB0aGF0XG4gICAgICAgIGRyb3Bkb3duOiBmdW5jdGlvbiAobmFtZSkge1xuICAgICAgICAgICAgdmFyIHQgPSB0aGlzLFxuICAgICAgICAgICAgICAgICRib2R5ID0gJCgnYm9keScsIHQuZG9jKSxcbiAgICAgICAgICAgICAgICBwcmVmaXggPSB0Lm8ucHJlZml4LFxuICAgICAgICAgICAgICAgICRkcm9wZG93biA9ICQoJ1tkYXRhLScgKyBwcmVmaXggKyAnZHJvcGRvd249JyArIG5hbWUgKyAnXScsIHQuJGJveCksXG4gICAgICAgICAgICAgICAgJGJ0biA9ICQoJy4nICsgcHJlZml4ICsgbmFtZSArICctYnV0dG9uJywgdC4kYnRuUGFuZSksXG4gICAgICAgICAgICAgICAgc2hvdyA9ICRkcm9wZG93bi5pcygnOmhpZGRlbicpO1xuXG4gICAgICAgICAgICAkYm9keS50cmlnZ2VyKCdtb3VzZWRvd24nKTtcblxuICAgICAgICAgICAgaWYgKHNob3cpIHtcbiAgICAgICAgICAgICAgICB2YXIgYnRuT2Zmc2V0TGVmdCA9ICRidG4ub2Zmc2V0KCkubGVmdDtcbiAgICAgICAgICAgICAgICAkYnRuLmFkZENsYXNzKHByZWZpeCArICdhY3RpdmUnKTtcblxuICAgICAgICAgICAgICAgICRkcm9wZG93bi5jc3Moe1xuICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogJ2Fic29sdXRlJyxcbiAgICAgICAgICAgICAgICAgICAgdG9wOiAkYnRuLm9mZnNldCgpLnRvcCAtIHQuJGJ0blBhbmUub2Zmc2V0KCkudG9wICsgJGJ0bi5vdXRlckhlaWdodCgpLFxuICAgICAgICAgICAgICAgICAgICBsZWZ0OiAodC5vLmZpeGVkRnVsbFdpZHRoICYmIHQuaXNGaXhlZCkgPyBidG5PZmZzZXRMZWZ0IDogKGJ0bk9mZnNldExlZnQgLSB0LiRidG5QYW5lLm9mZnNldCgpLmxlZnQpXG4gICAgICAgICAgICAgICAgfSkuc2hvdygpO1xuXG4gICAgICAgICAgICAgICAgJCh3aW5kb3cpLnRyaWdnZXIoJ3Njcm9sbCcpO1xuXG4gICAgICAgICAgICAgICAgJGJvZHkub24oJ21vdXNlZG93bi4nICsgdC5ldmVudE5hbWVzcGFjZSwgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCEkZHJvcGRvd24uaXMoZS50YXJnZXQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAkKCcuJyArIHByZWZpeCArICdkcm9wZG93bicsIHQuJGJveCkuaGlkZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgJCgnLicgKyBwcmVmaXggKyAnYWN0aXZlJywgdC4kYnRuUGFuZSkucmVtb3ZlQ2xhc3MocHJlZml4ICsgJ2FjdGl2ZScpO1xuICAgICAgICAgICAgICAgICAgICAgICAgJGJvZHkub2ZmKCdtb3VzZWRvd24uJyArIHQuZXZlbnROYW1lc3BhY2UpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG5cblxuICAgICAgICAvLyBIVE1MIENvZGUgbWFuYWdlbWVudFxuICAgICAgICBodG1sOiBmdW5jdGlvbiAoaHRtbCkge1xuICAgICAgICAgICAgdmFyIHQgPSB0aGlzO1xuXG4gICAgICAgICAgICBpZiAoaHRtbCAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgdC4kdGEudmFsKGh0bWwpO1xuICAgICAgICAgICAgICAgIHQuc3luY0NvZGUodHJ1ZSk7XG4gICAgICAgICAgICAgICAgdC4kYy50cmlnZ2VyKCd0YndjaGFuZ2UnKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gdDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIHQuJHRhLnZhbCgpO1xuICAgICAgICB9LFxuICAgICAgICBzeW5jVGV4dGFyZWE6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciB0ID0gdGhpcztcbiAgICAgICAgICAgIHQuJHRhLnZhbCh0LiRlZC50ZXh0KCkudHJpbSgpLmxlbmd0aCA+IDAgfHwgdC4kZWQuZmluZCh0Lm8udGFnc1RvS2VlcC5qb2luKCcsJykpLmxlbmd0aCA+IDAgPyB0LiRlZC5odG1sKCkgOiAnJyk7XG4gICAgICAgIH0sXG4gICAgICAgIHN5bmNDb2RlOiBmdW5jdGlvbiAoZm9yY2UpIHtcbiAgICAgICAgICAgIHZhciB0ID0gdGhpcztcbiAgICAgICAgICAgIGlmICghZm9yY2UgJiYgdC4kZWQuaXMoJzp2aXNpYmxlJykpIHtcbiAgICAgICAgICAgICAgICB0LnN5bmNUZXh0YXJlYSgpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAvLyB3cmFwIHRoZSBjb250ZW50IGluIGEgZGl2IGl0J3MgZWFzaWVyIHRvIGdldCB0aGUgaW5uZXIgaHRtbFxuICAgICAgICAgICAgICAgIHZhciBodG1sID0gJCgnPGRpdj4nKS5odG1sKHQuJHRhLnZhbCgpKTtcbiAgICAgICAgICAgICAgICAvLyBzY3J1YiB0aGUgaHRtbCBiZWZvcmUgbG9hZGluZyBpbnRvIHRoZSBkb2NcbiAgICAgICAgICAgICAgICB2YXIgc2FmZSA9ICQoJzxkaXY+JykuYXBwZW5kKGh0bWwpO1xuICAgICAgICAgICAgICAgICQodC5vLnRhZ3NUb1JlbW92ZS5qb2luKCcsJyksIHNhZmUpLnJlbW92ZSgpO1xuICAgICAgICAgICAgICAgIHQuJGVkLmh0bWwoc2FmZS5jb250ZW50cygpLmh0bWwoKSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmICh0Lm8uYXV0b2dyb3cpIHtcbiAgICAgICAgICAgICAgICB0LmhlaWdodCA9IHQuJGVkLmhlaWdodCgpO1xuICAgICAgICAgICAgICAgIGlmICh0LmhlaWdodCAhPT0gdC4kdGEuY3NzKCdoZWlnaHQnKSkge1xuICAgICAgICAgICAgICAgICAgICB0LiR0YS5jc3Moe2hlaWdodDogdC5oZWlnaHR9KTtcbiAgICAgICAgICAgICAgICAgICAgdC4kYy50cmlnZ2VyKCd0YndyZXNpemUnKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodC5vLmF1dG9ncm93T25FbnRlcikge1xuICAgICAgICAgICAgICAgIHQuJGVkLmhlaWdodCgnYXV0bycpO1xuICAgICAgICAgICAgICAgIHZhciB0b3RhbEhlaWdodCA9IHQuYXV0b2dyb3dPbkVudGVyV2FzRm9jdXNlZCA/IHQuJGVkWzBdLnNjcm9sbEhlaWdodCA6IHQuJGVkLmNzcygnbWluLWhlaWdodCcpO1xuICAgICAgICAgICAgICAgIGlmICh0b3RhbEhlaWdodCAhPT0gdC4kdGEuY3NzKCdoZWlnaHQnKSkge1xuICAgICAgICAgICAgICAgICAgICB0LiRlZC5jc3Moe2hlaWdodDogdG90YWxIZWlnaHR9KTtcbiAgICAgICAgICAgICAgICAgICAgdC4kYy50cmlnZ2VyKCd0YndyZXNpemUnKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG5cbiAgICAgICAgLy8gQW5hbHlzZSBhbmQgdXBkYXRlIHRvIHNlbWFudGljIGNvZGVcbiAgICAgICAgLy8gQHBhcmFtIGZvcmNlIDogZm9yY2UgdG8gc3luYyBjb2RlIGZyb20gdGV4dGFyZWFcbiAgICAgICAgLy8gQHBhcmFtIGZ1bGwgIDogd3JhcCB0ZXh0IG5vZGVzIGluIDxwPlxuICAgICAgICAvLyBAcGFyYW0ga2VlcFJhbmdlICA6IGxlYXZlIHNlbGVjdGlvbiByYW5nZSBhcyBpdCBpc1xuICAgICAgICBzZW1hbnRpY0NvZGU6IGZ1bmN0aW9uIChmb3JjZSwgZnVsbCwga2VlcFJhbmdlKSB7XG4gICAgICAgICAgICB2YXIgdCA9IHRoaXM7XG4gICAgICAgICAgICB0LnNhdmVSYW5nZSgpO1xuICAgICAgICAgICAgdC5zeW5jQ29kZShmb3JjZSk7XG5cbiAgICAgICAgICAgIHZhciByZXN0b3JlUmFuZ2UgPSB0cnVlO1xuICAgICAgICAgICAgaWYgKHQucmFuZ2UgJiYgdC5yYW5nZS5jb2xsYXBzZWQpIHtcbiAgICAgICAgICAgICAgICByZXN0b3JlUmFuZ2UgPSBmYWxzZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKHQuby5zZW1hbnRpYykge1xuICAgICAgICAgICAgICAgIHQuc2VtYW50aWNUYWcoJ2InLCB0Lm8uc2VtYW50aWNLZWVwQXR0cmlidXRlcyk7XG4gICAgICAgICAgICAgICAgdC5zZW1hbnRpY1RhZygnaScsIHQuby5zZW1hbnRpY0tlZXBBdHRyaWJ1dGVzKTtcbiAgICAgICAgICAgICAgICB0LnNlbWFudGljVGFnKCdzJywgdC5vLnNlbWFudGljS2VlcEF0dHJpYnV0ZXMpO1xuICAgICAgICAgICAgICAgIHQuc2VtYW50aWNUYWcoJ3N0cmlrZScsIHQuby5zZW1hbnRpY0tlZXBBdHRyaWJ1dGVzKTtcblxuICAgICAgICAgICAgICAgIGlmIChmdWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBpbmxpbmVFbGVtZW50c1NlbGVjdG9yID0gdC5vLmlubGluZUVsZW1lbnRzU2VsZWN0b3IsXG4gICAgICAgICAgICAgICAgICAgICAgICBibG9ja0VsZW1lbnRzU2VsZWN0b3IgPSAnOm5vdCgnICsgaW5saW5lRWxlbWVudHNTZWxlY3RvciArICcpJztcblxuICAgICAgICAgICAgICAgICAgICAvLyBXcmFwIHRleHQgbm9kZXMgaW4gc3BhbiBmb3IgZWFzaWVyIHByb2Nlc3NpbmdcbiAgICAgICAgICAgICAgICAgICAgdC4kZWQuY29udGVudHMoKS5maWx0ZXIoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMubm9kZVR5cGUgPT09IDMgJiYgdGhpcy5ub2RlVmFsdWUudHJpbSgpLmxlbmd0aCA+IDA7XG4gICAgICAgICAgICAgICAgICAgIH0pLndyYXAoJzxzcGFuIGRhdGEtdGJ3Lz4nKTtcblxuICAgICAgICAgICAgICAgICAgICAvLyBXcmFwIGdyb3VwcyBvZiBpbmxpbmUgZWxlbWVudHMgaW4gcGFyYWdyYXBocyAocmVjdXJzaXZlKVxuICAgICAgICAgICAgICAgICAgICB2YXIgd3JhcElubGluZXNJblBhcmFncmFwaHNGcm9tID0gZnVuY3Rpb24gKCRmcm9tKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoJGZyb20ubGVuZ3RoICE9PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyICRmaW5hbFBhcmFncmFwaCA9ICRmcm9tLm5leHRVbnRpbChibG9ja0VsZW1lbnRzU2VsZWN0b3IpLmFkZEJhY2soKS53cmFwQWxsKCc8cC8+JykucGFyZW50KCksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRuZXh0RWxlbWVudCA9ICRmaW5hbFBhcmFncmFwaC5uZXh0QWxsKGlubGluZUVsZW1lbnRzU2VsZWN0b3IpLmZpcnN0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJGZpbmFsUGFyYWdyYXBoLm5leHQoJ2JyJykucmVtb3ZlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgd3JhcElubGluZXNJblBhcmFncmFwaHNGcm9tKCRuZXh0RWxlbWVudCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIHdyYXBJbmxpbmVzSW5QYXJhZ3JhcGhzRnJvbSh0LiRlZC5jaGlsZHJlbihpbmxpbmVFbGVtZW50c1NlbGVjdG9yKS5maXJzdCgpKTtcblxuICAgICAgICAgICAgICAgICAgICB0LnNlbWFudGljVGFnKCdkaXYnLCB0cnVlKTtcblxuICAgICAgICAgICAgICAgICAgICAvLyBHZXQgcmlkIG9mIHRlbXBvcmFyeSBzcGFuJ3NcbiAgICAgICAgICAgICAgICAgICAgJCgnW2RhdGEtdGJ3XScsIHQuJGVkKS5jb250ZW50cygpLnVud3JhcCgpO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIFJlbW92ZSBlbXB0eSA8cD5cbiAgICAgICAgICAgICAgICAgICAgdC4kZWQuZmluZCgncDplbXB0eScpLnJlbW92ZSgpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmICgha2VlcFJhbmdlICYmIHJlc3RvcmVSYW5nZSkge1xuICAgICAgICAgICAgICAgICAgICB0LnJlc3RvcmVSYW5nZSgpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHQuc3luY1RleHRhcmVhKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG5cbiAgICAgICAgc2VtYW50aWNUYWc6IGZ1bmN0aW9uIChvbGRUYWcsIGNvcHlBdHRyaWJ1dGVzLCByZXZlcnQpIHtcbiAgICAgICAgICAgIHZhciBuZXdUYWcsIHQgPSB0aGlzO1xuICAgICAgICAgICAgdmFyIHRtcFRhZyA9IG9sZFRhZztcblxuICAgICAgICAgICAgaWYgKHRoaXMuby5zZW1hbnRpYyAhPSBudWxsICYmIHR5cGVvZiB0aGlzLm8uc2VtYW50aWMgPT09ICdvYmplY3QnICYmIHRoaXMuby5zZW1hbnRpYy5oYXNPd25Qcm9wZXJ0eShvbGRUYWcpKSB7XG4gICAgICAgICAgICAgICAgbmV3VGFnID0gdGhpcy5vLnNlbWFudGljW29sZFRhZ107XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMuby5zZW1hbnRpYyA9PT0gdHJ1ZSAmJiB0aGlzLkRFRkFVTFRfU0VNQU5USUNfTUFQLmhhc093blByb3BlcnR5KG9sZFRhZykpIHtcbiAgICAgICAgICAgICAgICBuZXdUYWcgPSB0aGlzLkRFRkFVTFRfU0VNQU5USUNfTUFQW29sZFRhZ107XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYocmV2ZXJ0KSB7XG4gICAgICAgICAgICAgICAgb2xkVGFnID0gbmV3VGFnO1xuICAgICAgICAgICAgICAgIG5ld1RhZyA9IHRtcFRhZztcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgJChvbGRUYWcsIHRoaXMuJGVkKS5lYWNoKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICB2YXIgcmVzZXRSYW5nZSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIHZhciAkb2xkVGFnID0gJCh0aGlzKTtcbiAgICAgICAgICAgICAgICBpZiAoJG9sZFRhZy5jb250ZW50cygpLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYodC5yYW5nZS5zdGFydENvbnRhaW5lci5wYXJlbnROb2RlICYmIHQucmFuZ2Uuc3RhcnRDb250YWluZXIucGFyZW50Tm9kZSA9PT0gdGhpcykge1xuICAgICAgICAgICAgICAgICAgICByZXNldFJhbmdlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyICRuZXdUYWcgPSAkKCc8JyArIG5ld1RhZyArICcvPicpO1xuICAgICAgICAgICAgICAgICRuZXdUYWcuaW5zZXJ0QmVmb3JlKCRvbGRUYWcpO1xuICAgICAgICAgICAgICAgIGlmIChjb3B5QXR0cmlidXRlcykge1xuICAgICAgICAgICAgICAgICAgICAkLmVhY2goJG9sZFRhZy5wcm9wKCdhdHRyaWJ1dGVzJyksIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICRuZXdUYWcuYXR0cih0aGlzLm5hbWUsIHRoaXMudmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgJG5ld1RhZy5odG1sKCRvbGRUYWcuaHRtbCgpKTtcbiAgICAgICAgICAgICAgICAkb2xkVGFnLnJlbW92ZSgpO1xuICAgICAgICAgICAgICAgIGlmKHJlc2V0UmFuZ2UgPT09IHRydWUpIHtcbiAgICAgICAgICAgICAgICAgICAgdC5yYW5nZS5zZWxlY3ROb2RlQ29udGVudHMoJG5ld1RhZy5nZXQoMCkpO1xuICAgICAgICAgICAgICAgICAgICB0LnJhbmdlLmNvbGxhcHNlKGZhbHNlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSxcblxuICAgICAgICAvLyBGdW5jdGlvbiBjYWxsIHdoZW4gdXNlciBjbGljayBvbiBcIkluc2VydCBMaW5rXCJcbiAgICAgICAgY3JlYXRlTGluazogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIHQgPSB0aGlzLFxuICAgICAgICAgICAgICAgIGRvY3VtZW50U2VsZWN0aW9uID0gdC5kb2MuZ2V0U2VsZWN0aW9uKCksXG4gICAgICAgICAgICAgICAgc2VsZWN0ZWRSYW5nZSA9IGRvY3VtZW50U2VsZWN0aW9uLmdldFJhbmdlQXQoMCksXG4gICAgICAgICAgICAgICAgbm9kZSA9IGRvY3VtZW50U2VsZWN0aW9uLmZvY3VzTm9kZSxcbiAgICAgICAgICAgICAgICB0ZXh0ID0gbmV3IFhNTFNlcmlhbGl6ZXIoKS5zZXJpYWxpemVUb1N0cmluZyhzZWxlY3RlZFJhbmdlLmNsb25lQ29udGVudHMoKSkgfHwgc2VsZWN0ZWRSYW5nZSArICcnLFxuICAgICAgICAgICAgICAgIHVybCxcbiAgICAgICAgICAgICAgICB0aXRsZSxcbiAgICAgICAgICAgICAgICB0YXJnZXQ7XG5cbiAgICAgICAgICAgIHdoaWxlIChbJ0EnLCAnRElWJ10uaW5kZXhPZihub2RlLm5vZGVOYW1lKSA8IDApIHtcbiAgICAgICAgICAgICAgICBub2RlID0gbm9kZS5wYXJlbnROb2RlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAobm9kZSAmJiBub2RlLm5vZGVOYW1lID09PSAnQScpIHtcbiAgICAgICAgICAgICAgICB2YXIgJGEgPSAkKG5vZGUpO1xuICAgICAgICAgICAgICAgIHRleHQgPSAkYS50ZXh0KCk7XG4gICAgICAgICAgICAgICAgdXJsID0gJGEuYXR0cignaHJlZicpO1xuICAgICAgICAgICAgICAgIGlmICghdC5vLm1pbmltYWxMaW5rcykge1xuICAgICAgICAgICAgICAgICAgICB0aXRsZSA9ICRhLmF0dHIoJ3RpdGxlJyk7XG4gICAgICAgICAgICAgICAgICAgIHRhcmdldCA9ICRhLmF0dHIoJ3RhcmdldCcpIHx8IHQuby5kZWZhdWx0TGlua1RhcmdldDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIHJhbmdlID0gdC5kb2MuY3JlYXRlUmFuZ2UoKTtcbiAgICAgICAgICAgICAgICByYW5nZS5zZWxlY3ROb2RlKG5vZGUpO1xuICAgICAgICAgICAgICAgIGRvY3VtZW50U2VsZWN0aW9uLnJlbW92ZUFsbFJhbmdlcygpO1xuICAgICAgICAgICAgICAgIGRvY3VtZW50U2VsZWN0aW9uLmFkZFJhbmdlKHJhbmdlKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdC5zYXZlUmFuZ2UoKTtcblxuICAgICAgICAgICAgdmFyIG9wdGlvbnMgPSB7XG4gICAgICAgICAgICAgICAgdXJsOiB7XG4gICAgICAgICAgICAgICAgICAgIGxhYmVsOiB0LmxhbmcubGlua1VybCB8fCAnVVJMJyxcbiAgICAgICAgICAgICAgICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiB1cmxcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHRleHQ6IHtcbiAgICAgICAgICAgICAgICAgICAgbGFiZWw6IHQubGFuZy50ZXh0LFxuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogdGV4dFxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBpZiAoIXQuby5taW5pbWFsTGlua3MpIHtcbiAgICAgICAgICAgICAgICAkLmV4dGVuZChvcHRpb25zLCB7XG4gICAgICAgICAgICAgICAgICAgIHRpdGxlOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBsYWJlbDogdC5sYW5nLnRpdGxlLFxuICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IHRpdGxlXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHRhcmdldDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgbGFiZWw6IHQubGFuZy50YXJnZXQsXG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogdGFyZ2V0XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdC5vcGVuTW9kYWxJbnNlcnQodC5sYW5nLmNyZWF0ZUxpbmssIG9wdGlvbnMsIGZ1bmN0aW9uICh2KSB7IC8vIHYgaXMgdmFsdWVcbiAgICAgICAgICAgICAgICB2YXIgdXJsID0gdC5wcmVwZW5kVXJsUHJlZml4KHYudXJsKTtcbiAgICAgICAgICAgICAgICBpZiAoIXVybC5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHZhciBsaW5rID0gJChbJzxhIGhyZWY9XCInLCB1cmwsICdcIj4nLCB2LnRleHQgfHwgdi51cmwsICc8L2E+J10uam9pbignJykpO1xuXG4gICAgICAgICAgICAgICAgaWYgKHYudGl0bGUpIHtcbiAgICAgICAgICAgICAgICAgICAgbGluay5hdHRyKCd0aXRsZScsIHYudGl0bGUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAodi50YXJnZXQgfHwgdC5vLmRlZmF1bHRMaW5rVGFyZ2V0KSB7XG4gICAgICAgICAgICAgICAgICAgIGxpbmsuYXR0cigndGFyZ2V0Jywgdi50YXJnZXQgfHwgdC5vLmRlZmF1bHRMaW5rVGFyZ2V0KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdC5yYW5nZS5kZWxldGVDb250ZW50cygpO1xuICAgICAgICAgICAgICAgIHQucmFuZ2UuaW5zZXJ0Tm9kZShsaW5rWzBdKTtcbiAgICAgICAgICAgICAgICB0LnN5bmNDb2RlKCk7XG4gICAgICAgICAgICAgICAgdC4kYy50cmlnZ2VyKCd0YndjaGFuZ2UnKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9LFxuICAgICAgICBwcmVwZW5kVXJsUHJlZml4OiBmdW5jdGlvbiAodXJsKSB7XG4gICAgICAgICAgICB2YXIgdCA9IHRoaXM7XG4gICAgICAgICAgICBpZiAoIXQudXJsUHJlZml4KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHVybDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIFZBTElEX0xJTktfUFJFRklYID0gL14oW2Etel1bLSsuYS16MC05XSo6fFxcL3wjKS9pO1xuICAgICAgICAgICAgaWYgKFZBTElEX0xJTktfUFJFRklYLnRlc3QodXJsKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB1cmw7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciBTSU1QTEVfRU1BSUxfUkVHRVggPSAvXlteXFxzQF0rQFteXFxzQF0rXFwuW15cXHNAXSskLztcbiAgICAgICAgICAgIGlmIChTSU1QTEVfRU1BSUxfUkVHRVgudGVzdCh1cmwpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuICdtYWlsdG86JyArIHVybDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIHQudXJsUHJlZml4ICsgdXJsO1xuICAgICAgICB9LFxuICAgICAgICB1bmxpbms6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciB0ID0gdGhpcyxcbiAgICAgICAgICAgICAgICBkb2N1bWVudFNlbGVjdGlvbiA9IHQuZG9jLmdldFNlbGVjdGlvbigpLFxuICAgICAgICAgICAgICAgIG5vZGUgPSBkb2N1bWVudFNlbGVjdGlvbi5mb2N1c05vZGU7XG5cbiAgICAgICAgICAgIGlmIChkb2N1bWVudFNlbGVjdGlvbi5pc0NvbGxhcHNlZCkge1xuICAgICAgICAgICAgICAgIHdoaWxlIChbJ0EnLCAnRElWJ10uaW5kZXhPZihub2RlLm5vZGVOYW1lKSA8IDApIHtcbiAgICAgICAgICAgICAgICAgICAgbm9kZSA9IG5vZGUucGFyZW50Tm9kZTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAobm9kZSAmJiBub2RlLm5vZGVOYW1lID09PSAnQScpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJhbmdlID0gdC5kb2MuY3JlYXRlUmFuZ2UoKTtcbiAgICAgICAgICAgICAgICAgICAgcmFuZ2Uuc2VsZWN0Tm9kZShub2RlKTtcbiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnRTZWxlY3Rpb24ucmVtb3ZlQWxsUmFuZ2VzKCk7XG4gICAgICAgICAgICAgICAgICAgIGRvY3VtZW50U2VsZWN0aW9uLmFkZFJhbmdlKHJhbmdlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0LmV4ZWNDbWQoJ3VubGluaycsIHVuZGVmaW5lZCwgdW5kZWZpbmVkLCB0cnVlKTtcbiAgICAgICAgfSxcbiAgICAgICAgaW5zZXJ0SW1hZ2U6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciB0ID0gdGhpcztcbiAgICAgICAgICAgIHQuc2F2ZVJhbmdlKCk7XG5cbiAgICAgICAgICAgIHZhciBvcHRpb25zID0ge1xuICAgICAgICAgICAgICAgIHVybDoge1xuICAgICAgICAgICAgICAgICAgICBsYWJlbDogJ1VSTCcsXG4gICAgICAgICAgICAgICAgICAgIHJlcXVpcmVkOiB0cnVlXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBhbHQ6IHtcbiAgICAgICAgICAgICAgICAgICAgbGFiZWw6IHQubGFuZy5kZXNjcmlwdGlvbixcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IHQuZ2V0UmFuZ2VUZXh0KClcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICBpZiAodC5vLmltYWdlV2lkdGhNb2RhbEVkaXQpIHtcbiAgICAgICAgICAgICAgICBvcHRpb25zLndpZHRoID0ge307XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHQub3Blbk1vZGFsSW5zZXJ0KHQubGFuZy5pbnNlcnRJbWFnZSwgb3B0aW9ucywgZnVuY3Rpb24gKHYpIHsgLy8gdiBhcmUgdmFsdWVzXG4gICAgICAgICAgICAgICAgdC5leGVjQ21kKCdpbnNlcnRJbWFnZScsIHYudXJsLCBmYWxzZSwgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgdmFyICRpbWcgPSAkKCdpbWdbc3JjPVwiJyArIHYudXJsICsgJ1wiXTpub3QoW2FsdF0pJywgdC4kYm94KTtcbiAgICAgICAgICAgICAgICAkaW1nLmF0dHIoJ2FsdCcsIHYuYWx0KTtcblxuICAgICAgICAgICAgICAgIGlmICh0Lm8uaW1hZ2VXaWR0aE1vZGFsRWRpdCkge1xuICAgICAgICAgICAgICAgICAgICAkaW1nLmF0dHIoe1xuICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGg6IHYud2lkdGhcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdC5zeW5jQ29kZSgpO1xuICAgICAgICAgICAgICAgIHQuJGMudHJpZ2dlcigndGJ3Y2hhbmdlJyk7XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9LFxuICAgICAgICBmdWxsc2NyZWVuOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgdCA9IHRoaXMsXG4gICAgICAgICAgICAgICAgcHJlZml4ID0gdC5vLnByZWZpeCxcbiAgICAgICAgICAgICAgICBmdWxsc2NyZWVuQ3NzQ2xhc3MgPSBwcmVmaXggKyAnZnVsbHNjcmVlbicsXG4gICAgICAgICAgICAgICAgZnVsbHNjcmVlblBsYWNlaG9sZGVyQ2xhc3MgPSBmdWxsc2NyZWVuQ3NzQ2xhc3MgKyAnLXBsYWNlaG9sZGVyJyxcbiAgICAgICAgICAgICAgICBpc0Z1bGxzY3JlZW4sXG4gICAgICAgICAgICAgICAgZWRpdG9ySGVpZ2h0ID0gdC4kYm94Lm91dGVySGVpZ2h0KCk7XG5cbiAgICAgICAgICAgIHQuJGJveC50b2dnbGVDbGFzcyhmdWxsc2NyZWVuQ3NzQ2xhc3MpO1xuICAgICAgICAgICAgaXNGdWxsc2NyZWVuID0gdC4kYm94Lmhhc0NsYXNzKGZ1bGxzY3JlZW5Dc3NDbGFzcyk7XG5cbiAgICAgICAgICAgIGlmIChpc0Z1bGxzY3JlZW4pIHtcbiAgICAgICAgICAgICAgICB0LiRib3guYmVmb3JlKFxuICAgICAgICAgICAgICAgICAgICAkKCc8ZGl2Lz4nLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjbGFzczogZnVsbHNjcmVlblBsYWNlaG9sZGVyQ2xhc3NcbiAgICAgICAgICAgICAgICAgICAgfSkuY3NzKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGhlaWdodDogZWRpdG9ySGVpZ2h0XG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgJCgnLicgKyBmdWxsc2NyZWVuUGxhY2Vob2xkZXJDbGFzcykucmVtb3ZlKCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICQoJ2JvZHknKS50b2dnbGVDbGFzcyhwcmVmaXggKyAnYm9keS1mdWxsc2NyZWVuJywgaXNGdWxsc2NyZWVuKTtcbiAgICAgICAgICAgICQod2luZG93KS50cmlnZ2VyKCdzY3JvbGwnKTtcbiAgICAgICAgICAgIHQuJGMudHJpZ2dlcigndGJ3JyArIChpc0Z1bGxzY3JlZW4gPyAnb3BlbicgOiAnY2xvc2UnKSArICdmdWxsc2NyZWVuJyk7XG4gICAgICAgIH0sXG5cblxuICAgICAgICAvKlxuICAgICAgICAgKiBDYWxsIG1ldGhvZCBvZiB0cnVtYm93eWcgaWYgZXhpc3RcbiAgICAgICAgICogZWxzZSB0cnkgdG8gY2FsbCBhbm9ueW1vdXMgZnVuY3Rpb25cbiAgICAgICAgICogYW5kIGZpbmFsbHkgbmF0aXZlIGV4ZWNDb21tYW5kXG4gICAgICAgICAqL1xuICAgICAgICBleGVjQ21kOiBmdW5jdGlvbiAoY21kLCBwYXJhbSwgZm9yY2VDc3MsIHNraXBUcnVtYm93eWcpIHtcbiAgICAgICAgICAgIHZhciB0ID0gdGhpcztcbiAgICAgICAgICAgIHNraXBUcnVtYm93eWcgPSAhIXNraXBUcnVtYm93eWcgfHwgJyc7XG5cbiAgICAgICAgICAgIGlmIChjbWQgIT09ICdkcm9wZG93bicpIHtcbiAgICAgICAgICAgICAgICB0LiRlZC5mb2N1cygpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZihjbWQgPT09ICdzdHJpa2V0aHJvdWdoJyAmJiB0Lm8uc2VtYW50aWMpIHtcbiAgICAgICAgICAgICAgICB0LnNlbWFudGljVGFnKCdzdHJpa2UnLCB0Lm8uc2VtYW50aWNLZWVwQXR0cmlidXRlcywgdHJ1ZSk7IC8vIGJyb3dzZXJzIGNhbm5vdCB1bmRvIGUuZy4gPGRlbD4gYXMgdGhleSBleHBlY3QgPHN0cmlrZT5cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICB0LmRvYy5leGVjQ29tbWFuZCgnc3R5bGVXaXRoQ1NTJywgZmFsc2UsIGZvcmNlQ3NzIHx8IGZhbHNlKTtcbiAgICAgICAgICAgIH0gY2F0Y2ggKGMpIHtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICB0W2NtZCArIHNraXBUcnVtYm93eWddKHBhcmFtKTtcbiAgICAgICAgICAgIH0gY2F0Y2ggKGMpIHtcbiAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICBjbWQocGFyYW0pO1xuICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGUyKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChjbWQgPT09ICdpbnNlcnRIb3Jpem9udGFsUnVsZScpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhcmFtID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGNtZCA9PT0gJ2Zvcm1hdEJsb2NrJyAmJiB0LmlzSUUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhcmFtID0gJzwnICsgcGFyYW0gKyAnPic7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICB0LmRvYy5leGVjQ29tbWFuZChjbWQsIGZhbHNlLCBwYXJhbSk7XG5cbiAgICAgICAgICAgICAgICAgICAgdC5zeW5jQ29kZSgpO1xuICAgICAgICAgICAgICAgICAgICB0LnNlbWFudGljQ29kZShmYWxzZSwgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgbGlzdElkID0gd2luZG93LmdldFNlbGVjdGlvbigpLmZvY3VzTm9kZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKCEkKHdpbmRvdy5nZXRTZWxlY3Rpb24oKS5mb2N1c05vZGUucGFyZW50Tm9kZSkuaGFzQ2xhc3MoJ3RydW1ib3d5Zy1lZGl0b3InKSl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGlzdElkID0gd2luZG93LmdldFNlbGVjdGlvbigpLmZvY3VzTm9kZS5wYXJlbnROb2RlO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNsYXNzZXMgPSB0Lm8udGFnQ2xhc3Nlc1twYXJhbV07XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoY2xhc3Nlcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICQobGlzdElkKS5hZGRDbGFzcyhjbGFzc2VzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoZSkge1xuXG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmIChjbWQgIT09ICdkcm9wZG93bicpIHtcbiAgICAgICAgICAgICAgICAgICAgdC51cGRhdGVCdXR0b25QYW5lU3RhdHVzKCk7XG4gICAgICAgICAgICAgICAgICAgIHQuJGMudHJpZ2dlcigndGJ3Y2hhbmdlJyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuXG5cbiAgICAgICAgLy8gT3BlbiBhIG1vZGFsIGJveFxuICAgICAgICBvcGVuTW9kYWw6IGZ1bmN0aW9uICh0aXRsZSwgY29udGVudCwgYnVpbGRGb3JtKSB7XG4gICAgICAgICAgICB2YXIgdCA9IHRoaXMsXG4gICAgICAgICAgICAgICAgcHJlZml4ID0gdC5vLnByZWZpeDtcblxuICAgICAgICAgICAgYnVpbGRGb3JtID0gYnVpbGRGb3JtICE9PSBmYWxzZTtcblxuICAgICAgICAgICAgLy8gTm8gb3BlbiBhIG1vZGFsIGJveCB3aGVuIGV4aXN0IG90aGVyIG1vZGFsIGJveFxuICAgICAgICAgICAgaWYgKCQoJy4nICsgcHJlZml4ICsgJ21vZGFsLWJveCcsIHQuJGJveCkubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0Lm8uYXV0b2dyb3dPbkVudGVyKSB7XG4gICAgICAgICAgICAgICAgdC5hdXRvZ3Jvd09uRW50ZXJEb250Q2xvc2UgPSB0cnVlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0LnNhdmVSYW5nZSgpO1xuICAgICAgICAgICAgdC5zaG93T3ZlcmxheSgpO1xuXG4gICAgICAgICAgICAvLyBEaXNhYmxlIGFsbCBidG5QYW5lIGJ0bnNcbiAgICAgICAgICAgIHQuJGJ0blBhbmUuYWRkQ2xhc3MocHJlZml4ICsgJ2Rpc2FibGUnKTtcblxuICAgICAgICAgICAgLy8gQnVpbGQgb3V0IG9mIE1vZGFsQm94LCBpdCdzIHRoZSBtYXNrIGZvciBhbmltYXRpb25zXG4gICAgICAgICAgICB2YXIgJG1vZGFsID0gJCgnPGRpdi8+Jywge1xuICAgICAgICAgICAgICAgIGNsYXNzOiBwcmVmaXggKyAnbW9kYWwgJyArIHByZWZpeCArICdmaXhlZC10b3AnXG4gICAgICAgICAgICB9KS5jc3Moe1xuICAgICAgICAgICAgICAgIHRvcDogdC4kYm94Lm9mZnNldCgpLnRvcCArIHQuJGJ0blBhbmUuaGVpZ2h0KCksXG4gICAgICAgICAgICAgICAgekluZGV4OiA5OTk5OVxuICAgICAgICAgICAgfSkuYXBwZW5kVG8oJCh0LmRvYy5ib2R5KSk7XG5cbiAgICAgICAgICAgIC8vIENsaWNrIG9uIG92ZXJsYXkgY2xvc2UgbW9kYWwgYnkgY2FuY2VsbGluZyB0aGVtXG4gICAgICAgICAgICB0LiRvdmVybGF5Lm9uZSgnY2xpY2snLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgJG1vZGFsLnRyaWdnZXIoQ0FOQ0VMX0VWRU5UKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgLy8gQnVpbGQgdGhlIGZvcm1cbiAgICAgICAgICAgIHZhciBmb3JtT3JDb250ZW50O1xuICAgICAgICAgICAgaWYgKGJ1aWxkRm9ybSkge1xuICAgICAgICAgICAgICAgIGZvcm1PckNvbnRlbnQgPSAkKCc8Zm9ybS8+Jywge1xuICAgICAgICAgICAgICAgICAgICBhY3Rpb246ICcnLFxuICAgICAgICAgICAgICAgICAgICBodG1sOiBjb250ZW50XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgLm9uKCdzdWJtaXQnLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAkbW9kYWwudHJpZ2dlcihDT05GSVJNX0VWRU5UKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgLm9uKCdyZXNldCcsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICRtb2RhbC50cmlnZ2VyKENBTkNFTF9FVkVOVCk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIC5vbignc3VibWl0IHJlc2V0JywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHQuby5hdXRvZ3Jvd09uRW50ZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0LmF1dG9ncm93T25FbnRlckRvbnRDbG9zZSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgZm9ybU9yQ29udGVudCA9IGNvbnRlbnQ7XG4gICAgICAgICAgICB9XG5cblxuICAgICAgICAgICAgLy8gQnVpbGQgTW9kYWxCb3ggYW5kIGFuaW1hdGUgdG8gc2hvdyB0aGVtXG4gICAgICAgICAgICB2YXIgJGJveCA9ICQoJzxkaXYvPicsIHtcbiAgICAgICAgICAgICAgICBjbGFzczogcHJlZml4ICsgJ21vZGFsLWJveCcsXG4gICAgICAgICAgICAgICAgaHRtbDogZm9ybU9yQ29udGVudFxuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAuY3NzKHtcbiAgICAgICAgICAgICAgICAgICAgdG9wOiAnLScgKyB0LiRidG5QYW5lLm91dGVySGVpZ2h0KCksXG4gICAgICAgICAgICAgICAgICAgIG9wYWNpdHk6IDAsXG4gICAgICAgICAgICAgICAgICAgIHBhZGRpbmdCb3R0b206IGJ1aWxkRm9ybSA/IG51bGwgOiAnNSUnLFxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgLmFwcGVuZFRvKCRtb2RhbClcbiAgICAgICAgICAgICAgICAuYW5pbWF0ZSh7XG4gICAgICAgICAgICAgICAgICAgIHRvcDogMCxcbiAgICAgICAgICAgICAgICAgICAgb3BhY2l0eTogMVxuICAgICAgICAgICAgICAgIH0sIDEwMCk7XG5cblxuICAgICAgICAgICAgLy8gQXBwZW5kIHRpdGxlXG4gICAgICAgICAgICBpZiAodGl0bGUpIHtcbiAgICAgICAgICAgICAgICAkKCc8c3Bhbi8+Jywge1xuICAgICAgICAgICAgICAgICAgICB0ZXh0OiB0aXRsZSxcbiAgICAgICAgICAgICAgICAgICAgY2xhc3M6IHByZWZpeCArICdtb2RhbC10aXRsZSdcbiAgICAgICAgICAgICAgICB9KS5wcmVwZW5kVG8oJGJveCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChidWlsZEZvcm0pIHtcbiAgICAgICAgICAgICAgICAvLyBGb2N1cyBpbiBtb2RhbCBib3hcbiAgICAgICAgICAgICAgICAkKCdpbnB1dDpmaXJzdCcsICRib3gpLmZvY3VzKCk7XG5cbiAgICAgICAgICAgICAgICAvLyBBcHBlbmQgQ29uZmlybSBhbmQgQ2FuY2VsIGJ1dHRvbnNcbiAgICAgICAgICAgICAgICB0LmJ1aWxkTW9kYWxCdG4oJ3N1Ym1pdCcsICRib3gpO1xuICAgICAgICAgICAgICAgIHQuYnVpbGRNb2RhbEJ0bigncmVzZXQnLCAkYm94KTtcblxuICAgICAgICAgICAgICAgICRtb2RhbC5oZWlnaHQoJGJveC5vdXRlckhlaWdodCgpICsgMTApO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAkKHdpbmRvdykudHJpZ2dlcignc2Nyb2xsJyk7XG4gICAgICAgICAgICB0LiRjLnRyaWdnZXIoJ3Rid21vZGFsb3BlbicpO1xuXG4gICAgICAgICAgICByZXR1cm4gJG1vZGFsO1xuICAgICAgICB9LFxuICAgICAgICAvLyBAcGFyYW0gbiBpcyBuYW1lIG9mIG1vZGFsXG4gICAgICAgIGJ1aWxkTW9kYWxCdG46IGZ1bmN0aW9uIChuLCAkbW9kYWwpIHtcbiAgICAgICAgICAgIHZhciB0ID0gdGhpcyxcbiAgICAgICAgICAgICAgICBwcmVmaXggPSB0Lm8ucHJlZml4O1xuXG4gICAgICAgICAgICByZXR1cm4gJCgnPGJ1dHRvbi8+Jywge1xuICAgICAgICAgICAgICAgIGNsYXNzOiBwcmVmaXggKyAnbW9kYWwtYnV0dG9uICcgKyBwcmVmaXggKyAnbW9kYWwtJyArIG4sXG4gICAgICAgICAgICAgICAgdHlwZTogbixcbiAgICAgICAgICAgICAgICB0ZXh0OiB0Lmxhbmdbbl0gfHwgblxuICAgICAgICAgICAgfSkuYXBwZW5kVG8oJCgnZm9ybScsICRtb2RhbCkpO1xuICAgICAgICB9LFxuICAgICAgICAvLyBjbG9zZSBjdXJyZW50IG1vZGFsIGJveFxuICAgICAgICBjbG9zZU1vZGFsOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgdCA9IHRoaXMsXG4gICAgICAgICAgICAgICAgcHJlZml4ID0gdC5vLnByZWZpeDtcblxuICAgICAgICAgICAgdC4kYnRuUGFuZS5yZW1vdmVDbGFzcyhwcmVmaXggKyAnZGlzYWJsZScpO1xuICAgICAgICAgICAgdC4kb3ZlcmxheS5vZmYoKTtcblxuICAgICAgICAgICAgLy8gRmluZCB0aGUgbW9kYWwgYm94XG4gICAgICAgICAgICB2YXIgJG1vZGFsQm94ID0gJCgnLicgKyBwcmVmaXggKyAnbW9kYWwtYm94JywgJCh0LmRvYy5ib2R5KSk7XG5cbiAgICAgICAgICAgICRtb2RhbEJveC5hbmltYXRlKHtcbiAgICAgICAgICAgICAgICB0b3A6ICctJyArICRtb2RhbEJveC5oZWlnaHQoKVxuICAgICAgICAgICAgfSwgMTAwLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgJG1vZGFsQm94LnBhcmVudCgpLnJlbW92ZSgpO1xuICAgICAgICAgICAgICAgIHQuaGlkZU92ZXJsYXkoKTtcbiAgICAgICAgICAgICAgICB0LiRjLnRyaWdnZXIoJ3Rid21vZGFsY2xvc2UnKTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICB0LnJlc3RvcmVSYW5nZSgpO1xuICAgICAgICB9LFxuICAgICAgICAvLyBQcmUtZm9ybWF0dGVkIGJ1aWxkIGFuZCBtYW5hZ2VtZW50IG1vZGFsXG4gICAgICAgIG9wZW5Nb2RhbEluc2VydDogZnVuY3Rpb24gKHRpdGxlLCBmaWVsZHMsIGNtZCkge1xuICAgICAgICAgICAgdmFyIHQgPSB0aGlzLFxuICAgICAgICAgICAgICAgIHByZWZpeCA9IHQuby5wcmVmaXgsXG4gICAgICAgICAgICAgICAgbGcgPSB0LmxhbmcsXG4gICAgICAgICAgICAgICAgaHRtbCA9ICcnO1xuXG4gICAgICAgICAgICAkLmVhY2goZmllbGRzLCBmdW5jdGlvbiAoZmllbGROYW1lLCBmaWVsZCkge1xuICAgICAgICAgICAgICAgIHZhciBsID0gZmllbGQubGFiZWwgfHwgZmllbGROYW1lLFxuICAgICAgICAgICAgICAgICAgICBuID0gZmllbGQubmFtZSB8fCBmaWVsZE5hbWUsXG4gICAgICAgICAgICAgICAgICAgIGEgPSBmaWVsZC5hdHRyaWJ1dGVzIHx8IHt9O1xuXG4gICAgICAgICAgICAgICAgdmFyIGF0dHIgPSBPYmplY3Qua2V5cyhhKS5tYXAoZnVuY3Rpb24gKHByb3ApIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHByb3AgKyAnPVwiJyArIGFbcHJvcF0gKyAnXCInO1xuICAgICAgICAgICAgICAgIH0pLmpvaW4oJyAnKTtcblxuICAgICAgICAgICAgICAgIGh0bWwgKz0gJzxsYWJlbD48aW5wdXQgdHlwZT1cIicgKyAoZmllbGQudHlwZSB8fCAndGV4dCcpICsgJ1wiIG5hbWU9XCInICsgbiArICdcIicgK1xuICAgICAgICAgICAgICAgICAgICAoZmllbGQudHlwZSA9PT0gJ2NoZWNrYm94JyAmJiBmaWVsZC52YWx1ZSA/ICcgY2hlY2tlZD1cImNoZWNrZWRcIicgOiAnIHZhbHVlPVwiJyArIChmaWVsZC52YWx1ZSB8fCAnJykucmVwbGFjZSgvXCIvZywgJyZxdW90OycpKSArXG4gICAgICAgICAgICAgICAgICAgICdcIicgKyBhdHRyICsgJz48c3BhbiBjbGFzcz1cIicgKyBwcmVmaXggKyAnaW5wdXQtaW5mb3NcIj48c3Bhbj4nICtcbiAgICAgICAgICAgICAgICAgICAgKGxnW2xdID8gbGdbbF0gOiBsKSArXG4gICAgICAgICAgICAgICAgICAgICc8L3NwYW4+PC9zcGFuPjwvbGFiZWw+JztcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICByZXR1cm4gdC5vcGVuTW9kYWwodGl0bGUsIGh0bWwpXG4gICAgICAgICAgICAgICAgLm9uKENPTkZJUk1fRVZFTlQsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyICRmb3JtID0gJCgnZm9ybScsICQodGhpcykpLFxuICAgICAgICAgICAgICAgICAgICAgICAgdmFsaWQgPSB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWVzID0ge307XG5cbiAgICAgICAgICAgICAgICAgICAgJC5lYWNoKGZpZWxkcywgZnVuY3Rpb24gKGZpZWxkTmFtZSwgZmllbGQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBuID0gZmllbGQubmFtZSB8fCBmaWVsZE5hbWU7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciAkZmllbGQgPSAkKCdpbnB1dFtuYW1lPVwiJyArIG4gKyAnXCJdJywgJGZvcm0pLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlucHV0VHlwZSA9ICRmaWVsZC5hdHRyKCd0eXBlJyk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoaW5wdXRUeXBlLnRvTG93ZXJDYXNlKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdjaGVja2JveCc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlc1tuXSA9ICRmaWVsZC5pcygnOmNoZWNrZWQnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAncmFkaW8nOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZXNbbl0gPSAkZmllbGQuZmlsdGVyKCc6Y2hlY2tlZCcpLnZhbCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZXNbbl0gPSAkLnRyaW0oJGZpZWxkLnZhbCgpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBWYWxpZGF0ZSB2YWx1ZVxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGZpZWxkLnJlcXVpcmVkICYmIHZhbHVlc1tuXSA9PT0gJycpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWxpZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQuYWRkRXJyb3JPbk1vZGFsRmllbGQoJGZpZWxkLCB0LmxhbmcucmVxdWlyZWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChmaWVsZC5wYXR0ZXJuICYmICFmaWVsZC5wYXR0ZXJuLnRlc3QodmFsdWVzW25dKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbGlkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdC5hZGRFcnJvck9uTW9kYWxGaWVsZCgkZmllbGQsIGZpZWxkLnBhdHRlcm5FcnJvcik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgIGlmICh2YWxpZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdC5yZXN0b3JlUmFuZ2UoKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNtZCh2YWx1ZXMsIGZpZWxkcykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0LnN5bmNDb2RlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdC4kYy50cmlnZ2VyKCd0YndjaGFuZ2UnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0LmNsb3NlTW9kYWwoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKHRoaXMpLm9mZihDT05GSVJNX0VWRU5UKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgLm9uZShDQU5DRUxfRVZFTlQsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgJCh0aGlzKS5vZmYoQ09ORklSTV9FVkVOVCk7XG4gICAgICAgICAgICAgICAgICAgIHQuY2xvc2VNb2RhbCgpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICB9LFxuICAgICAgICBhZGRFcnJvck9uTW9kYWxGaWVsZDogZnVuY3Rpb24gKCRmaWVsZCwgZXJyKSB7XG4gICAgICAgICAgICB2YXIgcHJlZml4ID0gdGhpcy5vLnByZWZpeCxcbiAgICAgICAgICAgICAgICBzcGFuRXJyb3JDbGFzcyA9IHByZWZpeCArICdtc2ctZXJyb3InLFxuICAgICAgICAgICAgICAgICRsYWJlbCA9ICRmaWVsZC5wYXJlbnQoKTtcblxuICAgICAgICAgICAgJGZpZWxkXG4gICAgICAgICAgICAgICAgLm9uKCdjaGFuZ2Uga2V5dXAnLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICRsYWJlbC5yZW1vdmVDbGFzcyhwcmVmaXggKyAnaW5wdXQtZXJyb3InKTtcbiAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAkbGFiZWwuZmluZCgnLicgKyBzcGFuRXJyb3JDbGFzcykucmVtb3ZlKCk7XG4gICAgICAgICAgICAgICAgICAgIH0sIDE1MCk7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICRsYWJlbFxuICAgICAgICAgICAgICAgIC5hZGRDbGFzcyhwcmVmaXggKyAnaW5wdXQtZXJyb3InKVxuICAgICAgICAgICAgICAgIC5maW5kKCdpbnB1dCtzcGFuJylcbiAgICAgICAgICAgICAgICAuYXBwZW5kKFxuICAgICAgICAgICAgICAgICAgICAkKCc8c3Bhbi8+Jywge1xuICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3M6IHNwYW5FcnJvckNsYXNzLFxuICAgICAgICAgICAgICAgICAgICAgICAgdGV4dDogZXJyXG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgfSxcblxuICAgICAgICBnZXREZWZhdWx0SW1nRGJsQ2xpY2tIYW5kbGVyOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgdCA9IHRoaXM7XG5cbiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgdmFyICRpbWcgPSAkKHRoaXMpLFxuICAgICAgICAgICAgICAgICAgICBzcmMgPSAkaW1nLmF0dHIoJ3NyYycpLFxuICAgICAgICAgICAgICAgICAgICBiYXNlNjQgPSAnKEJhc2U2NCknO1xuXG4gICAgICAgICAgICAgICAgaWYgKHNyYy5pbmRleE9mKCdkYXRhOmltYWdlJykgPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgc3JjID0gYmFzZTY0O1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHZhciBvcHRpb25zID0ge1xuICAgICAgICAgICAgICAgICAgICB1cmw6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxhYmVsOiAnVVJMJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBzcmMsXG4gICAgICAgICAgICAgICAgICAgICAgICByZXF1aXJlZDogdHJ1ZVxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBhbHQ6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxhYmVsOiB0LmxhbmcuZGVzY3JpcHRpb24sXG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogJGltZy5hdHRyKCdhbHQnKVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgIGlmICh0Lm8uaW1hZ2VXaWR0aE1vZGFsRWRpdCkge1xuICAgICAgICAgICAgICAgICAgICBvcHRpb25zLndpZHRoID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6ICRpbWcuYXR0cignd2lkdGgnKSA/ICRpbWcuYXR0cignd2lkdGgnKSA6ICcnXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdC5vcGVuTW9kYWxJbnNlcnQodC5sYW5nLmluc2VydEltYWdlLCBvcHRpb25zLCBmdW5jdGlvbiAodikge1xuICAgICAgICAgICAgICAgICAgICBpZiAodi51cmwgIT09IGJhc2U2NCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgJGltZy5hdHRyKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzcmM6IHYudXJsXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAkaW1nLmF0dHIoe1xuICAgICAgICAgICAgICAgICAgICAgICAgYWx0OiB2LmFsdFxuICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICBpZiAodC5vLmltYWdlV2lkdGhNb2RhbEVkaXQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwYXJzZUludCh2LndpZHRoKSA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkaW1nLmF0dHIoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aWR0aDogdi53aWR0aFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkaW1nLnJlbW92ZUF0dHIoJ3dpZHRoJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9O1xuICAgICAgICB9LFxuXG4gICAgICAgIC8vIFJhbmdlIG1hbmFnZW1lbnRcbiAgICAgICAgc2F2ZVJhbmdlOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgdCA9IHRoaXMsXG4gICAgICAgICAgICAgICAgZG9jdW1lbnRTZWxlY3Rpb24gPSB0LmRvYy5nZXRTZWxlY3Rpb24oKTtcblxuICAgICAgICAgICAgdC5yYW5nZSA9IG51bGw7XG5cbiAgICAgICAgICAgIGlmICghZG9jdW1lbnRTZWxlY3Rpb24gfHwgIWRvY3VtZW50U2VsZWN0aW9uLnJhbmdlQ291bnQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciBzYXZlZFJhbmdlID0gdC5yYW5nZSA9IGRvY3VtZW50U2VsZWN0aW9uLmdldFJhbmdlQXQoMCksXG4gICAgICAgICAgICAgICAgcmFuZ2UgPSB0LmRvYy5jcmVhdGVSYW5nZSgpLFxuICAgICAgICAgICAgICAgIHJhbmdlU3RhcnQ7XG4gICAgICAgICAgICByYW5nZS5zZWxlY3ROb2RlQ29udGVudHModC4kZWRbMF0pO1xuICAgICAgICAgICAgcmFuZ2Uuc2V0RW5kKHNhdmVkUmFuZ2Uuc3RhcnRDb250YWluZXIsIHNhdmVkUmFuZ2Uuc3RhcnRPZmZzZXQpO1xuICAgICAgICAgICAgcmFuZ2VTdGFydCA9IChyYW5nZSArICcnKS5sZW5ndGg7XG4gICAgICAgICAgICB0Lm1ldGFSYW5nZSA9IHtcbiAgICAgICAgICAgICAgICBzdGFydDogcmFuZ2VTdGFydCxcbiAgICAgICAgICAgICAgICBlbmQ6IHJhbmdlU3RhcnQgKyAoc2F2ZWRSYW5nZSArICcnKS5sZW5ndGhcbiAgICAgICAgICAgIH07XG4gICAgICAgIH0sXG4gICAgICAgIHJlc3RvcmVSYW5nZTogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIHQgPSB0aGlzLFxuICAgICAgICAgICAgICAgIG1ldGFSYW5nZSA9IHQubWV0YVJhbmdlLFxuICAgICAgICAgICAgICAgIHNhdmVkUmFuZ2UgPSB0LnJhbmdlLFxuICAgICAgICAgICAgICAgIGRvY3VtZW50U2VsZWN0aW9uID0gdC5kb2MuZ2V0U2VsZWN0aW9uKCksXG4gICAgICAgICAgICAgICAgcmFuZ2U7XG5cbiAgICAgICAgICAgIGlmICghc2F2ZWRSYW5nZSkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKG1ldGFSYW5nZSAmJiBtZXRhUmFuZ2Uuc3RhcnQgIT09IG1ldGFSYW5nZS5lbmQpIHsgLy8gQWxnb3JpdGhtIGZyb20gaHR0cDovL2pzZmlkZGxlLm5ldC9XZVd5Ny8zL1xuICAgICAgICAgICAgICAgIHZhciBjaGFySW5kZXggPSAwLFxuICAgICAgICAgICAgICAgICAgICBub2RlU3RhY2sgPSBbdC4kZWRbMF1dLFxuICAgICAgICAgICAgICAgICAgICBub2RlLFxuICAgICAgICAgICAgICAgICAgICBmb3VuZFN0YXJ0ID0gZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIHN0b3AgPSBmYWxzZTtcblxuICAgICAgICAgICAgICAgIHJhbmdlID0gdC5kb2MuY3JlYXRlUmFuZ2UoKTtcblxuICAgICAgICAgICAgICAgIHdoaWxlICghc3RvcCAmJiAobm9kZSA9IG5vZGVTdGFjay5wb3AoKSkpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKG5vZGUubm9kZVR5cGUgPT09IDMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBuZXh0Q2hhckluZGV4ID0gY2hhckluZGV4ICsgbm9kZS5sZW5ndGg7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWZvdW5kU3RhcnQgJiYgbWV0YVJhbmdlLnN0YXJ0ID49IGNoYXJJbmRleCAmJiBtZXRhUmFuZ2Uuc3RhcnQgPD0gbmV4dENoYXJJbmRleCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJhbmdlLnNldFN0YXJ0KG5vZGUsIG1ldGFSYW5nZS5zdGFydCAtIGNoYXJJbmRleCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm91bmRTdGFydCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZm91bmRTdGFydCAmJiBtZXRhUmFuZ2UuZW5kID49IGNoYXJJbmRleCAmJiBtZXRhUmFuZ2UuZW5kIDw9IG5leHRDaGFySW5kZXgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByYW5nZS5zZXRFbmQobm9kZSwgbWV0YVJhbmdlLmVuZCAtIGNoYXJJbmRleCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RvcCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBjaGFySW5kZXggPSBuZXh0Q2hhckluZGV4O1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNuID0gbm9kZS5jaGlsZE5vZGVzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGkgPSBjbi5sZW5ndGg7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHdoaWxlIChpID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGkgLT0gMTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBub2RlU3RhY2sucHVzaChjbltpXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIEZpeCBJRTExIEVycm9yICdDb3VsZCBub3QgY29tcGxldGUgdGhlIG9wZXJhdGlvbiBkdWUgdG8gZXJyb3IgODAwYTAyNWUnLlxuICAgICAgICAgICAgLy8gaHR0cHM6Ly9zdGFja292ZXJmbG93LmNvbS9xdWVzdGlvbnMvMTYxNjA5OTYvY291bGQtbm90LWNvbXBsZXRlLXRoZS1vcGVyYXRpb24tZHVlLXRvLWVycm9yLTgwMGEwMjVlXG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIGRvY3VtZW50U2VsZWN0aW9uLnJlbW92ZUFsbFJhbmdlcygpO1xuICAgICAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBkb2N1bWVudFNlbGVjdGlvbi5hZGRSYW5nZShyYW5nZSB8fCBzYXZlZFJhbmdlKTtcbiAgICAgICAgfSxcbiAgICAgICAgZ2V0UmFuZ2VUZXh0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5yYW5nZSArICcnO1xuICAgICAgICB9LFxuXG4gICAgICAgIGNsZWFyQnV0dG9uUGFuZVN0YXR1czogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIHQgPSB0aGlzLFxuICAgICAgICAgICAgICAgIHByZWZpeCA9IHQuby5wcmVmaXgsXG4gICAgICAgICAgICAgICAgYWN0aXZlQ2xhc3NlcyA9IHByZWZpeCArICdhY3RpdmUtYnV0dG9uICcgKyBwcmVmaXggKyAnYWN0aXZlJyxcbiAgICAgICAgICAgICAgICBvcmlnaW5hbEljb25DbGFzcyA9IHByZWZpeCArICdvcmlnaW5hbC1pY29uJztcblxuICAgICAgICAgICAgLy8gUmVzZXQgYWxsIGJ1dHRvbnMgYW5kIGRyb3Bkb3duIHN0YXRlXG4gICAgICAgICAgICAkKCcuJyArIHByZWZpeCArICdhY3RpdmUtYnV0dG9uJywgdC4kYnRuUGFuZSkucmVtb3ZlQ2xhc3MoYWN0aXZlQ2xhc3Nlcyk7XG4gICAgICAgICAgICAkKCcuJyArIG9yaWdpbmFsSWNvbkNsYXNzLCB0LiRidG5QYW5lKS5lYWNoKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAkKHRoaXMpLmZpbmQoJ3N2ZyB1c2UnKS5hdHRyKCd4bGluazpocmVmJywgJCh0aGlzKS5kYXRhKG9yaWdpbmFsSWNvbkNsYXNzKSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSxcbiAgICAgICAgdXBkYXRlQnV0dG9uUGFuZVN0YXR1czogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIHQgPSB0aGlzLFxuICAgICAgICAgICAgICAgIHByZWZpeCA9IHQuby5wcmVmaXgsXG4gICAgICAgICAgICAgICAgYWN0aXZlQ2xhc3NlcyA9IHByZWZpeCArICdhY3RpdmUtYnV0dG9uICcgKyBwcmVmaXggKyAnYWN0aXZlJyxcbiAgICAgICAgICAgICAgICBvcmlnaW5hbEljb25DbGFzcyA9IHByZWZpeCArICdvcmlnaW5hbC1pY29uJyxcbiAgICAgICAgICAgICAgICB0YWdzID0gdC5nZXRUYWdzUmVjdXJzaXZlKHQuZG9jLmdldFNlbGVjdGlvbigpLmZvY3VzTm9kZSk7XG5cbiAgICAgICAgICAgIHQuY2xlYXJCdXR0b25QYW5lU3RhdHVzKCk7XG5cbiAgICAgICAgICAgICQuZWFjaCh0YWdzLCBmdW5jdGlvbiAoaSwgdGFnKSB7XG4gICAgICAgICAgICAgICAgdmFyIGJ0bk5hbWUgPSB0LnRhZ1RvQnV0dG9uW3RhZy50b0xvd2VyQ2FzZSgpXSxcbiAgICAgICAgICAgICAgICAgICAgJGJ0biA9ICQoJy4nICsgcHJlZml4ICsgYnRuTmFtZSArICctYnV0dG9uJywgdC4kYnRuUGFuZSk7XG5cbiAgICAgICAgICAgICAgICBpZiAoJGJ0bi5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgICRidG4uYWRkQ2xhc3MoYWN0aXZlQ2xhc3Nlcyk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICRidG4gPSAkKCcuJyArIHByZWZpeCArICdkcm9wZG93biAuJyArIHByZWZpeCArIGJ0bk5hbWUgKyAnLWRyb3Bkb3duLWJ1dHRvbicsIHQuJGJveCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgJGJ0blN2Z1VzZSA9ICRidG4uZmluZCgnc3ZnIHVzZScpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRyb3Bkb3duQnRuTmFtZSA9ICRidG4ucGFyZW50KCkuZGF0YShwcmVmaXggKyAnZHJvcGRvd24nKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkZHJvcGRvd25CdG4gPSAkKCcuJyArIHByZWZpeCArIGRyb3Bkb3duQnRuTmFtZSArICctYnV0dG9uJywgdC4kYm94KSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkZHJvcGRvd25CdG5TdmdVc2UgPSAkZHJvcGRvd25CdG4uZmluZCgnc3ZnIHVzZScpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBIaWdobGlnaHQgdGhlIGRyb3Bkb3duIGJ1dHRvblxuICAgICAgICAgICAgICAgICAgICAgICAgJGRyb3Bkb3duQnRuLmFkZENsYXNzKGFjdGl2ZUNsYXNzZXMpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBTd2l0Y2ggZHJvcGRvd24gaWNvbiB0byB0aGUgYWN0aXZlIHN1Yi1pY29uIG9uZVxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHQuby5jaGFuZ2VBY3RpdmVEcm9wZG93bkljb24gJiYgJGJ0blN2Z1VzZS5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gU2F2ZSBvcmlnaW5hbCBpY29uXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJGRyb3Bkb3duQnRuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5hZGRDbGFzcyhvcmlnaW5hbEljb25DbGFzcylcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmRhdGEob3JpZ2luYWxJY29uQ2xhc3MsICRkcm9wZG93bkJ0blN2Z1VzZS5hdHRyKCd4bGluazpocmVmJykpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gUHV0IHRoZSBhY3RpdmUgc3ViLWJ1dHRvbidzIGljb25cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkZHJvcGRvd25CdG5TdmdVc2VcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ3hsaW5rOmhyZWYnLCAkYnRuU3ZnVXNlLmF0dHIoJ3hsaW5rOmhyZWYnKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9LFxuICAgICAgICBnZXRUYWdzUmVjdXJzaXZlOiBmdW5jdGlvbiAoZWxlbWVudCwgdGFncykge1xuICAgICAgICAgICAgdmFyIHQgPSB0aGlzO1xuICAgICAgICAgICAgdGFncyA9IHRhZ3MgfHwgKGVsZW1lbnQgJiYgZWxlbWVudC50YWdOYW1lID8gW2VsZW1lbnQudGFnTmFtZV0gOiBbXSk7XG5cbiAgICAgICAgICAgIGlmIChlbGVtZW50ICYmIGVsZW1lbnQucGFyZW50Tm9kZSkge1xuICAgICAgICAgICAgICAgIGVsZW1lbnQgPSBlbGVtZW50LnBhcmVudE5vZGU7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldHVybiB0YWdzO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgdGFnID0gZWxlbWVudC50YWdOYW1lO1xuICAgICAgICAgICAgaWYgKHRhZyA9PT0gJ0RJVicpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGFncztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0YWcgPT09ICdQJyAmJiBlbGVtZW50LnN0eWxlLnRleHRBbGlnbiAhPT0gJycpIHtcbiAgICAgICAgICAgICAgICB0YWdzLnB1c2goZWxlbWVudC5zdHlsZS50ZXh0QWxpZ24pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAkLmVhY2godC50YWdIYW5kbGVycywgZnVuY3Rpb24gKGksIHRhZ0hhbmRsZXIpIHtcbiAgICAgICAgICAgICAgICB0YWdzID0gdGFncy5jb25jYXQodGFnSGFuZGxlcihlbGVtZW50LCB0KSk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgdGFncy5wdXNoKHRhZyk7XG5cbiAgICAgICAgICAgIHJldHVybiB0LmdldFRhZ3NSZWN1cnNpdmUoZWxlbWVudCwgdGFncykuZmlsdGVyKGZ1bmN0aW9uICh0YWcpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGFnICE9IG51bGw7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSxcblxuICAgICAgICAvLyBQbHVnaW5zXG4gICAgICAgIGluaXRQbHVnaW5zOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgdCA9IHRoaXM7XG4gICAgICAgICAgICB0LmxvYWRlZFBsdWdpbnMgPSBbXTtcbiAgICAgICAgICAgICQuZWFjaCgkLnRydW1ib3d5Zy5wbHVnaW5zLCBmdW5jdGlvbiAobmFtZSwgcGx1Z2luKSB7XG4gICAgICAgICAgICAgICAgaWYgKCFwbHVnaW4uc2hvdWxkSW5pdCB8fCBwbHVnaW4uc2hvdWxkSW5pdCh0KSkge1xuICAgICAgICAgICAgICAgICAgICBwbHVnaW4uaW5pdCh0KTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHBsdWdpbi50YWdIYW5kbGVyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0LnRhZ0hhbmRsZXJzLnB1c2gocGx1Z2luLnRhZ0hhbmRsZXIpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHQubG9hZGVkUGx1Z2lucy5wdXNoKHBsdWdpbik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0sXG4gICAgICAgIGRlc3Ryb3lQbHVnaW5zOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgdCA9IHRoaXM7XG4gICAgICAgICAgICAkLmVhY2godGhpcy5sb2FkZWRQbHVnaW5zLCBmdW5jdGlvbiAoaSwgcGx1Z2luKSB7XG4gICAgICAgICAgICAgICAgaWYgKHBsdWdpbi5kZXN0cm95KSB7XG4gICAgICAgICAgICAgICAgICAgIHBsdWdpbi5kZXN0cm95KHQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfTtcbn0pKG5hdmlnYXRvciwgd2luZG93LCBkb2N1bWVudCwgalF1ZXJ5KTtcbiJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./node_modules/trumbowyg/dist/trumbowyg.js\n");

/***/ })

/******/ 	});
/************************************************************************/
/******/ 	// The module cache
/******/ 	var __webpack_module_cache__ = {};
/******/ 	
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/ 		// Check if module is in cache
/******/ 		var cachedModule = __webpack_module_cache__[moduleId];
/******/ 		if (cachedModule !== undefined) {
/******/ 			return cachedModule.exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = __webpack_module_cache__[moduleId] = {
/******/ 			// no module.id needed
/******/ 			// no module.loaded needed
/******/ 			exports: {}
/******/ 		};
/******/ 	
/******/ 		// Execute the module function
/******/ 		__webpack_modules__[moduleId](module, module.exports, __webpack_require__);
/******/ 	
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/ 	
/************************************************************************/
/******/ 	/* webpack/runtime/compat get default export */
/******/ 	(() => {
/******/ 		// getDefaultExport function for compatibility with non-harmony modules
/******/ 		__webpack_require__.n = (module) => {
/******/ 			var getter = module && module.__esModule ?
/******/ 				() => (module['default']) :
/******/ 				() => (module);
/******/ 			__webpack_require__.d(getter, { a: getter });
/******/ 			return getter;
/******/ 		};
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/define property getters */
/******/ 	(() => {
/******/ 		// define getter functions for harmony exports
/******/ 		__webpack_require__.d = (exports, definition) => {
/******/ 			for(var key in definition) {
/******/ 				if(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {
/******/ 					Object.defineProperty(exports, key, { enumerable: true, get: definition[key] });
/******/ 				}
/******/ 			}
/******/ 		};
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/hasOwnProperty shorthand */
/******/ 	(() => {
/******/ 		__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/make namespace object */
/******/ 	(() => {
/******/ 		// define __esModule on exports
/******/ 		__webpack_require__.r = (exports) => {
/******/ 			if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 				Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 			}
/******/ 			Object.defineProperty(exports, '__esModule', { value: true });
/******/ 		};
/******/ 	})();
/******/ 	
/************************************************************************/
/******/ 	
/******/ 	// startup
/******/ 	// Load entry module and return exports
/******/ 	// This entry module can't be inlined because the eval-source-map devtool is used.
/******/ 	var __webpack_exports__ = __webpack_require__("./resources/js/admin.js");
/******/ 	
/******/ })()
;